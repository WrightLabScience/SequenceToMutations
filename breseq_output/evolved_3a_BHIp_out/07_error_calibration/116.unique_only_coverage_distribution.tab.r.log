
R version 4.3.1 (2023-06-16) -- "Beagle Scouts"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ##
> ##
> ## AUTHORS
> ##
> ## Jeffrey E. Barrick <jeffrey.e.barrick@gmail.com>
> ##
> ## LICENSE AND COPYRIGHT
> ##
> ## Copyright (c) 2008-2010 Michigan State University
> ## Copyright (c) 2011-2022 The University of Texas at Austin
> ##
> ## breseq is free software; you can redistribute it and/or modify it under the
> ## terms the GNU General Public License as published by the Free Software
> ## Foundation; either version 1, or (at your option) any later version.
> ##
> ##
> 
> ## Arguments:
> ##   distribution_file=/path/to/input 
> ##   plot_file=/path/to/output 
> ##   deletion_propagation_pr_cutoff=float
> ##   plot_poisson=0 or 1
> ##   pdf_output=0 or 1
> 
> ## Returns these values printed out to output log
> ## 
> ##  1. print(nb_fit_size); # 0 if fit failed
> ##  2. print(nb_fit_mu);   # 0 if fit failed
> ##  3. print(m)q
> ##  4. print(v)
> ##  5. print(D)
> ##  6. print(deletion_propagation_coverage)
> ##     -1 if it was <1 after fitting (implying reference sequence is deleted)
> ##
> 
> plot_poisson = 0;
> pdf_output = 1;
> 
> this.print.level = 0
> #this.print.level = 2
> 
> for (e in commandArgs(TRUE)) {
+   ta = strsplit(e,"=",fixed=TRUE)[[1]]
+   if(length(ta)>1) {
+     temp = ta[2]
+     assign(ta[1],temp)
+     cat("assigned ",ta[1]," the value of |",temp,"|\n")
+   } else {
+     assign(ta[[1]][1],TRUE)
+     cat("assigned ",ta[1]," the value of TRUE\n")
+   }
+ }
assigned  distribution_file  the value of | 3a+_BHI_c50_out/07_error_calibration/116.unique_only_coverage_distribution.tab |
assigned  plot_file  the value of | 3a+_BHI_c50_out/output/calibration/116.unique_coverage.pdf |
assigned  deletion_propagation_pr_cutoff  the value of | 0.00435194 |
> 
> deletion_propagation_pr_cutoff = as.numeric(deletion_propagation_pr_cutoff);
> 
> ## initialize values to be filled in
> nb_fit_mu = 0
> nb_fit_size = 0
> m = 0
> v = 0
> D = 0
> deletion_propagation_coverage = -1
> 
> min_fraction_included_in_nb_fit = 0.01
> 
> #load data
> X<-read.table(distribution_file, header=T)
> 
> #table might be empty
> if (nrow(X) == 0)
+ {
+   #print out statistics
+   
+   print(nb_fit_size);
+   print(nb_fit_mu);
+   
+   print(m)
+   print(v)
+   print(D)
+   
+   print(deletion_propagation_coverage)
+   
+   q()
+ }
> 
> #create the distribution vector and fit
> Y<-rep(X$coverage, X$n)
> m<-mean(Y)
> v<-var(Y)
> D<-v/m
> 
> ###
> ## Smooth the distribution with a moving average window of size 5
> ## so that we can more reliably find it's maximum value
> ###
> 
> ma5 = c(1, 1, 1, 1, 1)/5;
> 
> ## filtering fails if there are too few points
> if (nrow(X) >= 5) {
+   X$ma = filter(X$n, ma5)
+ } else {
+ 	X$ma = X$n
+ }
> 
> i<-0
> max_n <- 0;
> min_i <- max( trunc(m/4), 1 ); #prevents zero for pathological distributions
> max_i <- i;
> for (i in min_i:length(X$ma))
+ {		
+   #cat(i, "\n")
+ 	if (!is.na(X$ma[i]) && (X$ma[i] > max_n))
+ 	{
+ 		max_n = X$ma[i];
+ 		max_i = i;
+ 	}
+ }
> 
> ##
> # Censor data on the right and left of the maximum
> ##
> 
> start_i = max(floor(max_i*0.5), 1);
> end_i = min(ceiling(max_i*1.5), length(X$ma));
> 
> if (start_i == end_i)
+ {
+   print(nb_fit_size);
+   print(nb_fit_mu);
+   
+   print(m)
+   print(v)
+   print(D)
+   
+   print(deletion_propagation_coverage)
+   
+   q()
+ }
> 
> cat("Fitting from coverage of ", start_i, " to ", end_i, ".\n", sep="")
Fitting from coverage of 20 to 43.
> 
> ##
> # Coarse grain so that we are only fitting a number of bins that is 1000-2000
> #
> # The later adjustment for doing the fits this way is to multiply the means
> # of the negative binomial and poisson distributions by the binning number.
> # (The size parameter of the negative binomial doesn't need to be adjusted.)
> ##
> 
> 
> num_per_bin = trunc((end_i - start_i) / 1000)
> 
> if (num_per_bin > 1) 
+ {
+   cat("Coarse-graining for fits\n")
+   start_i_for_fits = trunc(start_i/num_per_bin)
+   end_i_for_fits = ceiling(end_i/num_per_bin)
+   num_bins = end_i - start_i  + 1
+   cat("Fitting from coverage in adjusted bins ", start_i_for_fits, " to ", end_i_for_fits, ".\n", sep="")
+   cat("Number of bins ", num_bins, ". Each bin has ", num_per_bin, " coverage values.\n", sep="")
+ 
+   # Create a new vector where we've added together values in bins
+   X.for.fits = vector("double", end_i_for_fits)
+   for (i in start_i_for_fits:end_i_for_fits)
+   {
+     for (j in 1:num_per_bin)
+     {
+       if (i*num_per_bin+j <= length(X$n))
+       {
+         X.for.fits[i] = X.for.fits[i] + X$n[i*num_per_bin+j]
+       }
+     }
+   }
+ 
+ } else {
+   ## AVOID num_per_bin equalling zero!!
+   X.for.fits = X$n[1:end_i]
+   num_per_bin = 1
+   start_i_for_fits = start_i
+   end_i_for_fits = end_i
+ }
> 
> 
> ##
> # Now perform negative binomial fitting to the censored data
> ##
> 
> inner_total<-0;
> for (i in start_i_for_fits:end_i_for_fits)
+ {
+ 	inner_total = inner_total + X.for.fits[i]; 
+ }
> # Yes: it's correct to use X here because we want the overall total total
> total_total<-sum(X$n);
> 
> ## let's preconstruct these for speed
> dist = vector("double", end_i_for_fits)
> 
> f_nb <- function(par) {
+ 
+ 	mu = par[1];
+ 	size = par[2];
+ 
+   if ((mu <= 0) || (size <= 0))
+   {
+     return(0);
+   }
+   
+   cat(start_i_for_fits, " ", end_i_for_fits, "\n");
+   cat(mu, " ", size, "\n");
+   
+ 	dist<-c()
+ 	total <- 0;
+ 	for (i in start_i_for_fits:end_i_for_fits)
+ 	{	
+ 		dist[i] <- dnbinom(i, size=size, mu=mu);
+ 		total <- total + dist[i] 
+ 	}
+ 	#print (mu, size)
+ 
+  	l <- 0;
+ 	for (i in start_i_for_fits:end_i_for_fits)
+ 	{
+ 		l <- l + ((X.for.fits[i]/inner_total)-(dist[i]/total))^2;
+ 	}
+ 	return(l);
+ }
> 
> 
> 
> ## Fit negative binomial 
> ## - allow fit to fail and set all params to zero/empty if that is the case
> nb_fit = NULL
> ## as.numeric prevents overflow in sums involving integers
> mean_estimate = sum((as.numeric(1:end_i_for_fits)*as.numeric(X.for.fits)))/sum(as.numeric(X.for.fits))
> 
> nb_fit_mu = -1
> nb_fit_size = -1
> try_size = 100000
> try_means_index = 1
> #This is a list of different means to test <-  sometimes the actual mean doesn't lead to a fit
> try_means = c(mean_estimate, 
+               end_i_for_fits, 
+               start_i_for_fits, 
+               1*(end_i_for_fits + start_i_for_fits)/4,
+               2*(end_i_for_fits + start_i_for_fits)/4,
+               3*(end_i_for_fits + start_i_for_fits)/4
+               )
>               
>               
> nb_fit = c()
> 
> while ( ((nb_fit_mu < 0) || (nb_fit_size < 0) || (nb_fit$code != 1)) && (try_size > 0.001) && (try_means_index <= length(try_means)))
+ {
+   try_size = try_size / 10
+   try_mean = try_means[try_means_index]
+ 
+   ## SIZE ESTIMATE from the censored data can be negative, so try various values instead
+   cat("Try Mean: ", try_mean, " Size: ", try_size, "\n")
+ 
+   try( suppressWarnings(nb_fit<-nlm(f_nb, c(try_mean, try_size), iterlim=1000, print.level=this.print.level)) )
+ 
+   nb_fit_mu = nb_fit$estimate[1];
+   nb_fit_size = nb_fit$estimate[2];
+ 
+   cat("Fit Mean: ", nb_fit_mu, " Size: ", nb_fit_size, " Code: ", nb_fit$code, "\n")
+   
+   if (try_size <= 0.001) {
+     try_size = 100000
+     try_means_index = try_means_index + 1
+   }
+ }
Try Mean:  36.33333  Size:  10000 
20   43 
36.33333   10000 
20   43 
36.33333   10000 
20   43 
36.33337   10000 
20   43 
36.33333   10000.01 
20   43 
36.34355   10000 
20   43 
36.34359   10000 
20   43 
36.34355   10000.01 
20   43 
54.7815   10000 
20   43 
54.78156   10000 
20   43 
54.7815   10000.01 
20   43 
59.13692   10000 
20   43 
59.13697   10000 
20   43 
59.13692   10000.01 
20   43 
68.33105   10000 
20   43 
68.33111   10000 
20   43 
68.33105   10000.01 
20   43 
73.94199   10000 
20   43 
73.94206   10000 
20   43 
73.94199   10000.01 
20   43 
77.22326   10000 
20   43 
77.22333   10000 
20   43 
77.22326   10000.01 
20   43 
78.16651   10000 
20   43 
78.16659   10000 
20   43 
78.16651   10000.01 
20   43 
78.28469   10000 
20   43 
78.28477   10000 
20   43 
78.28469   10000.01 
20   43 
78.28821   10000 
20   43 
78.28829   10000 
20   43 
78.28821   10000.01 
20   43 
78.28822   10000 
20   43 
78.2883   10000 
20   43 
78.28822   10000.01 
Fit Mean:  78.28822  Size:  10000  Code:  2 
Try Mean:  36.33333  Size:  1000 
20   43 
36.33333   1000 
20   43 
36.33333   1000 
20   43 
36.33337   1000 
20   43 
36.33333   1000.001 
20   43 
36.34337   1000 
20   43 
36.34341   1000 
20   43 
36.34337   1000.001 
20   43 
54.85417   1000.007 
20   43 
54.85423   1000.007 
20   43 
54.85417   1000.008 
20   43 
59.30592   1000.011 
20   43 
59.30598   1000.011 
20   43 
59.30592   1000.012 
20   43 
68.8467   1000.022 
20   43 
68.84677   1000.022 
20   43 
68.8467   1000.023 
20   43 
75.11574   1000.03 
20   43 
75.11582   1000.03 
20   43 
75.11574   1000.031 
20   43 
79.19275   1000.036 
20   43 
79.19283   1000.036 
20   43 
79.19275   1000.037 
20   43 
80.59502   1000.037 
20   43 
80.5951   1000.037 
20   43 
80.59502   1000.038 
20   43 
80.82731   1000.037 
20   43 
80.82739   1000.037 
20   43 
80.82731   1000.038 
20   43 
80.83806   1000.037 
20   43 
80.83814   1000.037 
20   43 
80.83806   1000.038 
20   43 
80.83832   1000.036 
20   43 
80.8384   1000.036 
20   43 
80.83832   1000.037 
20   43 
80.84624   1000.015 
20   43 
80.84633   1000.015 
20   43 
80.84624   1000.016 
20   43 
80.85456   999.9708 
20   43 
80.85464   999.9708 
20   43 
80.85456   999.9718 
20   43 
80.87099   999.82 
20   43 
80.87107   999.82 
20   43 
80.87099   999.821 
20   43 
80.89634   999.4293 
20   43 
80.89643   999.4293 
20   43 
80.89634   999.4303 
20   43 
80.9399   998.3462 
20   43 
80.93998   998.3462 
20   43 
80.9399   998.3472 
20   43 
81.01372   995.4706 
20   43 
81.0138   995.4706 
20   43 
81.01372   995.4716 
20   43 
81.14583   987.7185 
20   43 
81.14591   987.7185 
20   43 
81.14583   987.7195 
20   43 
81.40088   966.3753 
20   43 
81.40096   966.3753 
20   43 
81.40088   966.3763 
20   43 
82.00637   900.1699 
20   43 
82.00645   900.1699 
20   43 
82.00637   900.1708 
20   43 
86.3047   376.4665 
20   43 
86.30479   376.4665 
20   43 
86.3047   376.4669 
Fit Mean:  136.9039  Size:  -5638.042  Code:  1 
Try Mean:  36.33333  Size:  100 
20   43 
36.33333   100 
20   43 
36.33333   100 
20   43 
36.33337   100 
20   43 
36.33333   100.0001 
20   43 
36.34185   100 
20   43 
36.34189   100 
20   43 
36.34185   100.0001 
20   43 
55.38106   100.6722 
20   43 
55.38112   100.6722 
20   43 
55.38106   100.6723 
20   43 
60.88728   101.1479 
20   43 
60.88734   101.1479 
20   43 
60.88728   101.148 
20   43 
72.4339   102.3404 
20   43 
72.43397   102.3404 
20   43 
72.4339   102.3405 
20   43 
83.24235   103.6053 
20   43 
83.24243   103.6053 
20   43 
83.24235   103.6054 
20   43 
95.11519   105.084 
20   43 
95.11529   105.084 
20   43 
95.11519   105.0841 
20   43 
104.9833   106.3474 
20   43 
104.9834   106.3474 
20   43 
104.9833   106.3475 
20   43 
111.589   107.191 
20   43 
111.5891   107.191 
20   43 
111.589   107.1911 
20   43 
114.4487   107.5393 
20   43 
114.4488   107.5393 
20   43 
114.4487   107.5394 
20   43 
115.0965   107.598 
20   43 
115.0966   107.598 
20   43 
115.0965   107.5981 
20   43 
115.2164   107.587 
20   43 
115.2165   107.587 
20   43 
115.2164   107.5871 
20   43 
115.707   107.4501 
20   43 
115.7071   107.4501 
20   43 
115.707   107.4502 
20   43 
116.4567   107.054 
20   43 
116.4569   107.054 
20   43 
116.4567   107.0541 
20   43 
118.233   105.6736 
20   43 
118.2331   105.6736 
20   43 
118.233   105.6737 
20   43 
122.9968   101.0181 
20   43 
122.9969   101.0181 
20   43 
122.9968   101.0182 
Fit Mean:  228.5676  Size:  -7.328736  Code:  1 
Try Mean:  36.33333  Size:  10 
20   43 
36.33333   10 
20   43 
36.33333   10 
20   43 
36.33337   10 
20   43 
36.33333   10.00001 
20   43 
36.33686   10.00096 
20   43 
36.3369   10.00096 
20   43 
36.33686   10.00097 
20   43 
551.4901   324.4898 
20   43 
551.4907   324.4898 
20   43 
551.4901   324.4902 
20   43 
532.8452   312.9183 
20   43 
532.8458   312.9183 
20   43 
532.8452   312.9186 
20   43 
513.5034   300.9146 
20   43 
513.5039   300.9146 
20   43 
513.5034   300.9149 
20   43 
493.4102   288.445 
20   43 
493.4107   288.445 
20   43 
493.4102   288.4453 
20   43 
472.5072   275.4733 
20   43 
472.5077   275.4733 
20   43 
472.5072   275.4736 
20   43 
450.7333   261.9616 
20   43 
450.7337   261.9616 
20   43 
450.7333   261.9619 
20   43 
428.0264   247.8717 
20   43 
428.0268   247.8717 
20   43 
428.0264   247.872 
20   43 
404.3288   233.1678 
20   43 
404.3292   233.1678 
20   43 
404.3288   233.168 
20   43 
379.5946   217.8216 
20   43 
379.5949   217.8216 
20   43 
379.5946   217.8218 
20   43 
353.8056   201.8221 
20   43 
353.8059   201.8221 
20   43 
353.8056   201.8223 
20   43 
326.9979   185.192 
20   43 
326.9982   185.192 
20   43 
326.9979   185.1922 
20   43 
299.3092   168.0171 
20   43 
299.3095   168.0171 
20   43 
299.3092   168.0173 
20   43 
271.0578   150.4952 
20   43 
271.0581   150.4952 
20   43 
271.0578   150.4953 
Fit Mean:  -12884.89  Size:  -8007.903  Code:  1 
Try Mean:  36.33333  Size:  1 
20   43 
36.33333   1 
20   43 
36.33333   1 
20   43 
36.33337   1 
20   43 
36.33333   1.000001 
20   43 
36.33387   1.003066 
20   43 
36.33391   1.003066 
20   43 
36.33387   1.003067 
20   43 
63.32969   43.18707 
20   43 
63.32975   43.18707 
20   43 
63.32969   43.18711 
20   43 
80.12319   67.22393 
20   43 
80.12327   67.22393 
20   43 
80.12319   67.22399 
20   43 
90.47097   82.01835 
20   43 
90.47106   82.01835 
20   43 
90.47097   82.01844 
20   43 
102.5112   99.22636 
20   43 
102.5113   99.22636 
20   43 
102.5112   99.22646 
20   43 
108.9334   108.3957 
20   43 
108.9335   108.3957 
20   43 
108.9334   108.3958 
20   43 
111.2149   111.6425 
20   43 
111.215   111.6425 
20   43 
111.2149   111.6427 
20   43 
111.548   112.1058 
20   43 
111.5481   112.1058 
20   43 
111.548   112.1059 
20   43 
111.5789   112.1376 
20   43 
111.579   112.1376 
20   43 
111.5789   112.1377 
20   43 
111.8005   112.2911 
20   43 
111.8007   112.2911 
20   43 
111.8005   112.2912 
20   43 
112.104   112.356 
20   43 
112.1041   112.356 
20   43 
112.104   112.3561 
20   43 
112.8136   112.1567 
20   43 
112.8137   112.1567 
20   43 
112.8136   112.1568 
20   43 
114.3181   111.0102 
20   43 
114.3183   111.0102 
20   43 
114.3181   111.0103 
20   43 
118.4899   106.3104 
20   43 
118.49   106.3104 
20   43 
118.4899   106.3105 
20   43 
154.6115   60.81312 
20   43 
154.6117   60.81312 
20   43 
154.6115   60.81318 
20   43 
129.5404   92.3753 
20   43 
146.4157   71.13086 
20   43 
146.4159   71.13086 
20   43 
146.4157   71.13093 
20   43 
150.2556   67.18236 
20   43 
150.2557   67.18236 
20   43 
150.2556   67.18243 
20   43 
155.3588   62.88355 
20   43 
155.359   62.88355 
20   43 
155.3588   62.88361 
20   43 
156.577   62.81058 
20   43 
156.5771   62.81058 
20   43 
156.577   62.81065 
20   43 
184.9238   55.70737 
20   43 
184.924   55.70737 
20   43 
184.9238   55.70743 
20   43 
207.7146   52.48161 
20   43 
207.7148   52.48161 
20   43 
207.7146   52.48166 
20   43 
248.535   46.33182 
20   43 
248.5353   46.33182 
20   43 
248.535   46.33187 
20   43 
312.7312   45.85943 
20   43 
312.7315   45.85943 
20   43 
312.7312   45.85947 
20   43 
403.3417   38.73449 
20   43 
403.3421   38.73449 
20   43 
403.3417   38.73452 
20   43 
368.6388   42.61779 
20   43 
368.6391   42.61779 
20   43 
368.6388   42.61783 
20   43 
398.2594   41.51935 
20   43 
398.2598   41.51935 
20   43 
398.2594   41.51939 
20   43 
524.8226   37.81231 
20   43 
524.8232   37.81231 
20   43 
524.8226   37.81235 
20   43 
524.6236   38.86761 
20   43 
524.6241   38.86761 
20   43 
524.6236   38.86765 
20   43 
594.3676   38.65941 
20   43 
594.3682   38.65941 
20   43 
594.3676   38.65945 
20   43 
746.787   37.30437 
20   43 
746.7877   37.30437 
20   43 
746.787   37.3044 
20   43 
939.5824   36.10532 
20   43 
939.5834   36.10532 
20   43 
939.5824   36.10535 
20   43 
1113.052   35.85405 
20   43 
1113.053   35.85405 
20   43 
1113.052   35.85409 
20   43 
1376.373   35.54265 
20   43 
1376.375   35.54265 
20   43 
1376.373   35.54269 
20   43 
1735.865   35.077 
20   43 
1735.867   35.077 
20   43 
1735.865   35.07703 
20   43 
2205.896   34.95059 
20   43 
2205.899   34.95059 
20   43 
2205.896   34.95063 
20   43 
2912.283   34.35301 
20   43 
2912.286   34.35301 
20   43 
2912.283   34.35305 
20   43 
3658.583   34.39412 
20   43 
3658.587   34.39412 
20   43 
3658.583   34.39416 
20   43 
4698.789   34.22514 
20   43 
4698.794   34.22514 
20   43 
4698.789   34.22517 
20   43 
6097.593   34.13296 
20   43 
6097.599   34.13296 
20   43 
6097.593   34.133 
20   43 
7918.77   34.04277 
20   43 
7918.778   34.04277 
20   43 
7918.77   34.04281 
20   43 
10344.69   33.98763 
20   43 
10344.7   33.98763 
20   43 
10344.69   33.98766 
20   43 
13548.27   33.93001 
20   43 
13548.29   33.93001 
20   43 
13548.27   33.93005 
20   43 
17790.07   33.90283 
20   43 
17790.08   33.90283 
20   43 
17790.07   33.90286 
20   43 
23426.89   33.8609 
20   43 
23426.91   33.8609 
20   43 
23426.89   33.86094 
20   43 
30892.58   33.85581 
20   43 
30892.61   33.85581 
20   43 
30892.58   33.85585 
20   43 
40890.65   33.81691 
20   43 
40890.69   33.81691 
20   43 
40890.65   33.81695 
20   43 
54153.92   33.8298 
20   43 
54153.97   33.8298 
20   43 
54153.92   33.82983 
20   43 
71938.76   33.79454 
20   43 
71938.83   33.79454 
20   43 
71938.76   33.79457 
20   43 
95331.29   33.80526 
20   43 
95331.38   33.80526 
20   43 
95331.29   33.80529 
20   43 
126044.5   33.79096 
20   43 
126044.6   33.79096 
20   43 
126044.5   33.79099 
20   43 
162391.6   33.79089 
20   43 
162391.8   33.79089 
20   43 
162391.6   33.79092 
20   43 
198738.7   33.78798 
20   43 
198738.9   33.78798 
20   43 
198738.7   33.78802 
20   43 
235085.8   33.78663 
20   43 
235086   33.78663 
20   43 
235085.8   33.78667 
20   43 
271432.9   33.78557 
20   43 
271433.1   33.78557 
20   43 
271432.9   33.7856 
20   43 
307780   33.78481 
20   43 
307780.3   33.78481 
20   43 
307780   33.78484 
Fit Mean:  307780  Size:  33.78481  Code:  5 
Try Mean:  36.33333  Size:  0.1 
20   43 
36.33333   0.1 
20   43 
36.33333   0.1 
20   43 
36.33337   0.1 
20   43 
36.33333   0.100001 
20   43 
36.33339   0.1035439 
20   43 
36.33343   0.1035439 
20   43 
36.33339   0.1035449 
20   43 
42.89391   12.7143 
20   43 
42.89395   12.7143 
20   43 
42.89391   12.71431 
20   43 
250.6291   360.4792 
20   43 
250.6293   360.4792 
20   43 
250.6291   360.4795 
20   43 
238.7107   340.5499 
20   43 
238.7109   340.5499 
20   43 
238.7107   340.5503 
20   43 
226.4378   320.0279 
20   43 
226.438   320.0279 
20   43 
226.4378   320.0282 
20   43 
213.8405   298.9634 
20   43 
213.8407   298.9634 
20   43 
213.8405   298.9637 
20   43 
200.9787   277.4566 
20   43 
200.9789   277.4566 
20   43 
200.9787   277.4568 
20   43 
187.957   255.6822 
20   43 
187.9571   255.6822 
20   43 
187.957   255.6825 
Fit Mean:  -18460.19  Size:  -30927.13  Code:  1 
Try Mean:  36.33333  Size:  0.01 
20   43 
36.33333   0.01 
20   43 
36.33333   0.01 
20   43 
36.33337   0.01 
20   43 
36.33333   0.010001 
20   43 
36.33334   0.01359682 
20   43 
36.33338   0.01359682 
20   43 
36.33334   0.01359782 
20   43 
42.19972   11.70502 
20   43 
42.19976   11.70502 
20   43 
42.19972   11.70503 
20   43 
207.0842   292.6618 
20   43 
207.0844   292.6618 
20   43 
207.0842   292.6621 
20   43 
196.9764   275.4678 
20   43 
196.9766   275.4678 
20   43 
196.9764   275.4681 
20   43 
186.7994   258.1561 
20   43 
186.7995   258.1561 
20   43 
186.7994   258.1563 
Fit Mean:  -4825.522  Size:  -8268.16  Code:  1 
Try Mean:  36.33333  Size:  0.001 
20   43 
36.33333   0.001 
20   43 
36.33333   0.001 
20   43 
36.33337   0.001 
20   43 
36.33333   0.001001 
20   43 
36.33333   0.004602169 
20   43 
36.33337   0.004602169 
20   43 
36.33333   0.004603169 
20   43 
42.13518   11.61097 
20   43 
42.13522   11.61097 
20   43 
42.13518   11.61098 
20   43 
202.7607   285.7487 
20   43 
202.7609   285.7487 
20   43 
202.7607   285.749 
20   43 
192.8884   268.9297 
20   43 
192.8886   268.9297 
20   43 
192.8884   268.9299 
20   43 
182.9816   252.0519 
20   43 
182.9818   252.0519 
20   43 
182.9816   252.0521 
Fit Mean:  -1448.427  Size:  -2527.336  Code:  1 
Try Mean:  43  Size:  10000 
20   43 
43   10000 
20   43 
43   10000 
20   43 
43.00004   10000 
20   43 
43   10000.01 
20   43 
43.00588   10000 
20   43 
43.00592   10000 
20   43 
43.00588   10000.01 
20   43 
53.23741   10000 
20   43 
53.23746   10000 
20   43 
53.23741   10000.01 
20   43 
59.53213   10000 
20   43 
59.53218   10000 
20   43 
59.53213   10000.01 
20   43 
67.90797   10000 
20   43 
67.90804   10000 
20   43 
67.90797   10000.01 
20   43 
73.85126   10000 
20   43 
73.85134   10000 
20   43 
73.85126   10000.01 
20   43 
77.15877   10000 
20   43 
77.15885   10000 
20   43 
77.15877   10000.01 
20   43 
78.15661   10000 
20   43 
78.15669   10000 
20   43 
78.15661   10000.01 
20   43 
78.28417   10000 
20   43 
78.28425   10000 
20   43 
78.28417   10000.01 
20   43 
78.28821   10000 
20   43 
78.28829   10000 
20   43 
78.28821   10000.01 
20   43 
78.28822   10000 
20   43 
78.2883   10000 
20   43 
78.28822   10000.01 
Fit Mean:  78.28822  Size:  10000  Code:  2 
Try Mean:  43  Size:  1000 
20   43 
43   1000 
20   43 
43   1000 
20   43 
43.00004   1000 
20   43 
43   1000.001 
20   43 
43.00581   1000 
20   43 
43.00586   1000 
20   43 
43.00581   1000.001 
20   43 
53.37102   1000.005 
20   43 
53.37108   1000.005 
20   43 
53.37102   1000.006 
20   43 
59.73926   1000.01 
20   43 
59.73932   1000.01 
20   43 
59.73926   1000.011 
20   43 
68.44157   1000.018 
20   43 
68.44164   1000.018 
20   43 
68.44157   1000.019 
20   43 
75.04025   1000.026 
20   43 
75.04032   1000.026 
20   43 
75.04025   1000.027 
20   43 
79.12011   1000.031 
20   43 
79.12018   1000.031 
20   43 
79.12011   1000.032 
20   43 
80.58124   1000.032 
20   43 
80.58133   1000.032 
20   43 
80.58124   1000.033 
20   43 
80.82622   1000.032 
20   43 
80.8263   1000.032 
20   43 
80.82622   1000.033 
20   43 
80.83806   1000.032 
20   43 
80.83814   1000.032 
20   43 
80.83806   1000.033 
20   43 
80.83831   1000.031 
20   43 
80.83839   1000.031 
20   43 
80.83831   1000.032 
20   43 
80.84634   1000.01 
20   43 
80.84642   1000.01 
20   43 
80.84634   1000.011 
20   43 
80.85467   999.9649 
20   43 
80.85475   999.9649 
20   43 
80.85467   999.9659 
20   43 
80.87132   999.8106 
20   43 
80.8714   999.8106 
20   43 
80.87132   999.8116 
20   43 
80.89693   999.4122 
20   43 
80.89701   999.4122 
20   43 
80.89693   999.4132 
20   43 
80.94101   998.306 
20   43 
80.94109   998.306 
20   43 
80.94101   998.307 
20   43 
81.01571   995.3697 
20   43 
81.01579   995.3697 
20   43 
81.01571   995.3707 
20   43 
81.14958   987.4497 
20   43 
81.14966   987.4497 
20   43 
81.14958   987.4507 
20   43 
81.40867   965.6198 
20   43 
81.40875   965.6198 
20   43 
81.40867   965.6208 
20   43 
82.02866   897.5285 
20   43 
82.02874   897.5285 
20   43 
82.02866   897.5294 
20   43 
86.79742   316.9173 
20   43 
86.79751   316.9173 
20   43 
86.79742   316.9176 
Fit Mean:  138.432  Size:  -5820.347  Code:  1 
Try Mean:  43  Size:  100 
20   43 
43   100 
20   43 
43   100 
20   43 
43.00004   100 
20   43 
43   100.0001 
20   43 
43.00525   100.0001 
20   43 
43.0053   100.0001 
20   43 
43.00525   100.0002 
20   43 
54.91395   100.5263 
20   43 
54.914   100.5263 
20   43 
54.91395   100.5264 
20   43 
62.10469   101.1011 
20   43 
62.10475   101.1011 
20   43 
62.10469   101.1012 
20   43 
73.01274   102.1696 
20   43 
73.01282   102.1696 
20   43 
73.01274   102.1697 
20   43 
84.21661   103.4146 
20   43 
84.21669   103.4146 
20   43 
84.21661   103.4147 
20   43 
95.92228   104.8028 
20   43 
95.92237   104.8028 
20   43 
95.92228   104.8029 
20   43 
105.6896   105.9932 
20   43 
105.6897   105.9932 
20   43 
105.6896   105.9933 
20   43 
112.0741   106.7679 
20   43 
112.0742   106.7679 
20   43 
112.0741   106.768 
20   43 
114.7713   107.0773 
20   43 
114.7714   107.0773 
20   43 
114.7713   107.0774 
20   43 
115.3595   107.1241 
20   43 
115.3596   107.1241 
20   43 
115.3595   107.1242 
20   43 
115.483   107.111 
20   43 
115.4832   107.111 
20   43 
115.483   107.1111 
20   43 
116.0036   106.9579 
20   43 
116.0037   106.9579 
20   43 
116.0036   106.9581 
20   43 
116.8021   106.5247 
20   43 
116.8022   106.5247 
20   43 
116.8021   106.5248 
20   43 
118.7186   105.0173 
20   43 
118.7187   105.0173 
20   43 
118.7186   105.0174 
20   43 
124.0633   99.80037 
20   43 
124.0635   99.80037 
20   43 
124.0633   99.80047 
Fit Mean:  996.9186  Size:  -769.2507  Code:  1 
Try Mean:  43  Size:  10 
20   43 
43   10 
20   43 
43   10 
20   43 
43.00004   10 
20   43 
43   10.00001 
20   43 
43.0025   10.0022 
20   43 
43.00254   10.0022 
20   43 
43.0025   10.00221 
20   43 
4876.814   2069.175 
20   43 
526.3836   215.9195 
20   43 
526.3841   215.9195 
20   43 
526.3836   215.9197 
20   43 
507.676   204.5882 
20   43 
507.6765   204.5882 
20   43 
507.676   204.5884 
20   43 
488.3654   192.8364 
20   43 
488.3659   192.8364 
20   43 
488.3654   192.8366 
20   43 
468.4452   180.648 
20   43 
468.4457   180.648 
20   43 
468.4452   180.6482 
20   43 
447.9274   168.0155 
20   43 
447.9279   168.0155 
20   43 
447.9274   168.0157 
20   43 
426.8542   154.9468 
20   43 
426.8546   154.9468 
20   43 
426.8542   154.947 
20   43 
405.3165   141.4763 
20   43 
405.3169   141.4763 
20   43 
405.3165   141.4765 
20   43 
383.4825   127.6836 
20   43 
383.4829   127.6836 
20   43 
383.4825   127.6837 
20   43 
361.6395   113.721 
20   43 
361.6398   113.721 
20   43 
361.6395   113.7212 
Fit Mean:  -1872.445  Size:  -1334.081  Code:  1 
Try Mean:  43  Size:  1 
20   43 
43   1 
20   43 
43   1 
20   43 
43.00004   1 
20   43 
43   1.000001 
20   43 
43.00038   1.005913 
20   43 
43.00043   1.005913 
20   43 
43.00038   1.005914 
20   43 
47.79148   10.68785 
20   43 
47.79153   10.68785 
20   43 
47.79148   10.68786 
20   43 
61.60743   28.67495 
20   43 
61.60749   28.67495 
20   43 
61.60743   28.67498 
20   43 
74.16439   44.09703 
20   43 
74.16446   44.09703 
20   43 
74.16439   44.09707 
20   43 
85.68116   58.13484 
20   43 
85.68125   58.13484 
20   43 
85.68116   58.1349 
20   43 
99.17977   74.56226 
20   43 
99.17987   74.56226 
20   43 
99.17977   74.56233 
20   43 
110.3833   88.18615 
20   43 
110.3834   88.18615 
20   43 
110.3833   88.18624 
20   43 
116.594   95.72895 
20   43 
116.5941   95.72895 
20   43 
116.594   95.72905 
20   43 
118.4704   97.99813 
20   43 
118.4705   97.99813 
20   43 
118.4704   97.99823 
20   43 
118.7082   98.27591 
20   43 
118.7083   98.27591 
20   43 
118.7082   98.27601 
20   43 
118.743   98.30606 
20   43 
118.7431   98.30606 
20   43 
118.743   98.30615 
20   43 
118.997   98.45547 
20   43 
118.9971   98.45547 
20   43 
118.997   98.45557 
20   43 
119.3518   98.52992 
20   43 
119.352   98.52992 
20   43 
119.3518   98.53002 
20   43 
120.1963   98.38849 
20   43 
120.1964   98.38849 
20   43 
120.1963   98.38859 
20   43 
122.0191   97.43939 
20   43 
122.0192   97.43939 
20   43 
122.0191   97.43948 
20   43 
127.1673   93.43055 
20   43 
127.1674   93.43055 
20   43 
127.1673   93.43064 
20   43 
175.5267   51.49132 
20   43 
175.5269   51.49132 
20   43 
175.5267   51.49137 
20   43 
134.7111   86.69 
20   43 
156.9645   67.499 
20   43 
156.9647   67.499 
20   43 
156.9645   67.49907 
20   43 
161.9646   63.73618 
20   43 
161.9648   63.73618 
20   43 
161.9646   63.73624 
20   43 
173.3148   56.03855 
20   43 
173.315   56.03855 
20   43 
173.3148   56.0386 
20   43 
168.5196   59.87696 
20   43 
168.5197   59.87696 
20   43 
168.5196   59.87702 
20   43 
170.1966   59.43457 
20   43 
170.1968   59.43457 
20   43 
170.1966   59.43463 
20   43 
208.6401   50.35528 
20   43 
208.6403   50.35528 
20   43 
208.6401   50.35533 
20   43 
224.4827   50.48162 
20   43 
224.4829   50.48162 
20   43 
224.4827   50.48168 
20   43 
274.0395   44.91641 
20   43 
274.0397   44.91641 
20   43 
274.0395   44.91645 
20   43 
307.224   44.22304 
20   43 
307.2243   44.22304 
20   43 
307.224   44.22308 
20   43 
376.2096   40.9013 
20   43 
376.21   40.9013 
20   43 
376.2096   40.90134 
20   43 
440.8589   40.76335 
20   43 
440.8594   40.76335 
20   43 
440.8589   40.76339 
20   43 
552.0514   38.16329 
20   43 
552.052   38.16329 
20   43 
552.0514   38.16333 
20   43 
627.2152   37.84095 
20   43 
627.2159   37.84095 
20   43 
627.2152   37.84099 
20   43 
767.0738   37.12254 
20   43 
767.0746   37.12254 
20   43 
767.0738   37.12258 
20   43 
937.5283   36.5088 
20   43 
937.5293   36.5088 
20   43 
937.5283   36.50884 
20   43 
1177.225   35.88867 
20   43 
1177.226   35.88867 
20   43 
1177.225   35.8887 
20   43 
1485.7   35.63931 
20   43 
1485.702   35.63931 
20   43 
1485.7   35.63935 
20   43 
2102.258   33.98623 
20   43 
2102.26   33.98623 
20   43 
2102.258   33.98627 
20   43 
2196.061   34.85481 
20   43 
2196.063   34.85481 
20   43 
2196.061   34.85484 
20   43 
2561.589   34.80496 
20   43 
2561.592   34.80496 
20   43 
2561.589   34.80499 
20   43 
3459.588   34.41836 
20   43 
3459.592   34.41836 
20   43 
3459.588   34.41839 
20   43 
4415.714   34.20793 
20   43 
4415.719   34.20793 
20   43 
4415.714   34.20796 
20   43 
5675.647   34.12705 
20   43 
5675.653   34.12705 
20   43 
5675.647   34.12708 
20   43 
7314.644   34.06496 
20   43 
7314.652   34.06496 
20   43 
7314.644   34.06499 
20   43 
9536.512   33.9938 
20   43 
9536.521   33.9938 
20   43 
9536.512   33.99383 
20   43 
12460.93   33.9444 
20   43 
12460.94   33.9444 
20   43 
12460.93   33.94443 
20   43 
16335.88   33.90389 
20   43 
16335.9   33.90389 
20   43 
16335.88   33.90392 
20   43 
21471.69   33.87423 
20   43 
21471.71   33.87423 
20   43 
21471.69   33.87426 
20   43 
28275.65   33.85052 
20   43 
28275.68   33.85052 
20   43 
28275.65   33.85055 
20   43 
37299.85   33.8333 
20   43 
37299.89   33.8333 
20   43 
37299.85   33.83333 
20   43 
49193.59   33.81963 
20   43 
49193.64   33.81963 
20   43 
49193.59   33.81966 
20   43 
65000.57   33.80971 
20   43 
65000.64   33.80971 
20   43 
65000.57   33.80974 
20   43 
85816.58   33.80183 
20   43 
85816.67   33.80183 
20   43 
85816.58   33.80186 
20   43 
113450.8   33.79615 
20   43 
113450.9   33.79615 
20   43 
113450.8   33.79619 
20   43 
150236.5   33.7915 
20   43 
150236.7   33.7915 
20   43 
150236.5   33.79154 
20   43 
193248.1   33.78875 
20   43 
193248.3   33.78875 
20   43 
193248.1   33.78878 
20   43 
236259.8   33.78672 
20   43 
236260   33.78672 
20   43 
236259.8   33.78676 
20   43 
279271.4   33.78552 
20   43 
279271.7   33.78552 
20   43 
279271.4   33.78555 
20   43 
322283   33.78453 
20   43 
322283.4   33.78453 
20   43 
322283   33.78456 
20   43 
365294.7   33.78376 
20   43 
365295   33.78376 
20   43 
365294.7   33.7838 
Fit Mean:  365294.7  Size:  33.78376  Code:  5 
Try Mean:  43  Size:  0.1 
20   43 
43   0.1 
20   43 
43   0.1 
20   43 
43.00004   0.1 
20   43 
43   0.100001 
20   43 
43.00004   0.1067139 
20   43 
43.00008   0.1067139 
20   43 
43.00004   0.1067149 
20   43 
45.99257   8.28955 
20   43 
45.99262   8.28955 
20   43 
45.99257   8.289559 
20   43 
54.42716   20.99135 
20   43 
54.42722   20.99135 
20   43 
54.42716   20.99137 
20   43 
70.18695   42.4236 
20   43 
70.18702   42.4236 
20   43 
70.18695   42.42365 
20   43 
79.73441   55.18673 
20   43 
79.73449   55.18673 
20   43 
79.73441   55.18679 
20   43 
93.10816   73.02275 
20   43 
93.10825   73.02275 
20   43 
93.10816   73.02282 
20   43 
104.772   88.56443 
20   43 
104.7721   88.56443 
20   43 
104.772   88.56452 
20   43 
112.4563   98.79404 
20   43 
112.4564   98.79404 
20   43 
112.4563   98.79414 
20   43 
115.2847   102.5501 
20   43 
115.2849   102.5501 
20   43 
115.2847   102.5502 
20   43 
115.7751   103.192 
20   43 
115.7752   103.192 
20   43 
115.7751   103.1921 
20   43 
115.812   103.231 
20   43 
115.8121   103.231 
20   43 
115.812   103.2311 
20   43 
115.979   103.3631 
20   43 
115.9791   103.3631 
20   43 
115.979   103.3632 
20   43 
116.2191   103.4637 
20   43 
116.2192   103.4637 
20   43 
116.2191   103.4638 
20   43 
116.75   103.4705 
20   43 
116.7501   103.4705 
20   43 
116.75   103.4706 
20   43 
117.8384   103.0309 
20   43 
117.8385   103.0309 
20   43 
117.8384   103.031 
20   43 
120.4992   101.0133 
20   43 
120.4993   101.0133 
20   43 
120.4992   101.0134 
20   43 
129.8797   91.86453 
20   43 
129.8798   91.86453 
20   43 
129.8797   91.86462 
20   43 
140.8944   80.68748 
20   43 
140.8945   80.68748 
20   43 
140.8944   80.68756 
20   43 
159.1887   63.15458 
20   43 
159.1889   63.15458 
20   43 
159.1887   63.15464 
20   43 
164.8746   58.96255 
20   43 
164.8748   58.96255 
20   43 
164.8746   58.9626 
20   43 
164.7695   60.50896 
20   43 
164.7696   60.50896 
20   43 
164.7695   60.50902 
20   43 
171.6031   60.58965 
20   43 
171.6032   60.58965 
20   43 
171.6031   60.58971 
20   43 
189.999   57.09812 
20   43 
189.9992   57.09812 
20   43 
189.999   57.09817 
20   43 
258.392   41.31693 
20   43 
214.8225   51.37027 
20   43 
214.8227   51.37027 
20   43 
214.8225   51.37033 
20   43 
255.1889   44.39381 
20   43 
255.1891   44.39381 
20   43 
255.1889   44.39385 
20   43 
248.189   47.71307 
20   43 
248.1893   47.71307 
20   43 
248.189   47.71312 
20   43 
266.6216   47.01564 
20   43 
266.6218   47.01564 
20   43 
266.6216   47.01569 
20   43 
329.6745   43.01225 
20   43 
329.6748   43.01225 
20   43 
329.6745   43.0123 
20   43 
387.0293   40.7516 
20   43 
387.0297   40.7516 
20   43 
387.0293   40.75164 
20   43 
453.2936   40.20849 
20   43 
453.2941   40.20849 
20   43 
453.2936   40.20853 
20   43 
555.3495   38.32291 
20   43 
555.3501   38.32291 
20   43 
555.3495   38.32295 
20   43 
671.9676   37.79391 
20   43 
671.9683   37.79391 
20   43 
671.9676   37.79395 
20   43 
831.9434   36.59692 
20   43 
831.9443   36.59692 
20   43 
831.9434   36.59695 
20   43 
1037.409   36.36884 
20   43 
1037.41   36.36884 
20   43 
1037.409   36.36887 
20   43 
1328.508   35.31112 
20   43 
1328.509   35.31112 
20   43 
1328.508   35.31115 
20   43 
1613.535   35.18405 
20   43 
1613.536   35.18405 
20   43 
1613.535   35.18409 
20   43 
2024.25   34.90383 
20   43 
2024.252   34.90383 
20   43 
2024.25   34.90387 
20   43 
2568.113   34.682 
20   43 
2568.115   34.682 
20   43 
2568.113   34.68203 
20   43 
3297.729   34.45366 
20   43 
3297.732   34.45366 
20   43 
3297.729   34.45369 
20   43 
4253.918   34.35886 
20   43 
4253.922   34.35886 
20   43 
4253.918   34.35889 
20   43 
5606.366   34.07376 
20   43 
5606.372   34.07376 
20   43 
5606.366   34.0738 
20   43 
7439.955   34.17276 
20   43 
7439.963   34.17276 
20   43 
7439.955   34.17279 
20   43 
9761.204   33.96911 
20   43 
9761.214   33.96911 
20   43 
9761.204   33.96915 
20   43 
12682.14   33.90571 
20   43 
12682.15   33.90571 
20   43 
12682.14   33.90575 
20   43 
16541.99   33.89431 
20   43 
16542.01   33.89431 
20   43 
16541.99   33.89434 
20   43 
21650.62   33.87143 
20   43 
21650.64   33.87143 
20   43 
21650.62   33.87146 
20   43 
28519.21   33.84732 
20   43 
28519.24   33.84732 
20   43 
28519.21   33.84736 
20   43 
37574.92   33.83031 
20   43 
37574.96   33.83031 
20   43 
37574.92   33.83034 
20   43 
49548.68   33.81771 
20   43 
49548.73   33.81771 
20   43 
49548.68   33.81775 
20   43 
65610.93   33.80778 
20   43 
65611   33.80778 
20   43 
65610.93   33.80782 
20   43 
86452.13   33.80078 
20   43 
86452.22   33.80078 
20   43 
86452.13   33.80081 
20   43 
114664.6   33.795 
20   43 
114664.8   33.795 
20   43 
114664.6   33.79504 
20   43 
150892   33.79106 
20   43 
150892.2   33.79106 
20   43 
150892   33.7911 
20   43 
193892.1   33.78815 
20   43 
193892.3   33.78815 
20   43 
193892.1   33.78818 
20   43 
236892.2   33.78638 
20   43 
236892.5   33.78638 
20   43 
236892.2   33.78641 
20   43 
279892.4   33.78523 
20   43 
279892.6   33.78523 
20   43 
279892.4   33.78526 
20   43 
322892.5   33.7843 
20   43 
322892.8   33.7843 
20   43 
322892.5   33.78434 
20   43 
365892.6   33.7836 
20   43 
365893   33.7836 
20   43 
365892.6   33.78364 
Fit Mean:  365892.6  Size:  33.7836  Code:  5 
Try Mean:  43  Size:  0.01 
20   43 
43   0.01 
20   43 
43   0.01 
20   43 
43.00004   0.01 
20   43 
43   0.010001 
20   43 
43   0.01680195 
20   43 
43.00005   0.01680195 
20   43 
43   0.01680295 
20   43 
45.85138   8.082729 
20   43 
45.85142   8.082729 
20   43 
45.85138   8.082737 
20   43 
53.87101   20.34885 
20   43 
53.87106   20.34885 
20   43 
53.87101   20.34887 
20   43 
69.85175   42.30726 
20   43 
69.85182   42.30726 
20   43 
69.85175   42.3073 
20   43 
79.27999   55.02699 
20   43 
79.28007   55.02699 
20   43 
79.27999   55.02704 
20   43 
92.61152   72.96896 
20   43 
92.61161   72.96896 
20   43 
92.61152   72.96903 
20   43 
104.2876   88.66861 
20   43 
104.2877   88.66861 
20   43 
104.2876   88.6687 
20   43 
112.0723   99.12659 
20   43 
112.0724   99.12659 
20   43 
112.0723   99.12669 
20   43 
114.9784   103.0213 
20   43 
114.9785   103.0213 
20   43 
114.9784   103.0215 
20   43 
115.4935   103.7025 
20   43 
115.4936   103.7025 
20   43 
115.4935   103.7026 
20   43 
115.532   103.744 
20   43 
115.5321   103.744 
20   43 
115.532   103.7441 
20   43 
115.6872   103.8713 
20   43 
115.6873   103.8713 
20   43 
115.6872   103.8714 
20   43 
115.9138   103.9742 
20   43 
115.9139   103.9742 
20   43 
115.9138   103.9744 
20   43 
116.4069   103.9979 
20   43 
116.407   103.9979 
20   43 
116.4069   103.998 
20   43 
117.4121   103.6219 
20   43 
117.4122   103.6219 
20   43 
117.4121   103.622 
20   43 
119.8255   101.8344 
20   43 
119.8256   101.8344 
20   43 
119.8255   101.8345 
20   43 
127.774   94.0682 
20   43 
127.7741   94.0682 
20   43 
127.774   94.06829 
20   43 
135.8574   85.61735 
20   43 
135.8575   85.61735 
20   43 
135.8574   85.61744 
20   43 
148.7252   72.89628 
20   43 
148.7254   72.89628 
20   43 
148.7252   72.89636 
20   43 
164.6772   58.17987 
20   43 
164.6773   58.17987 
20   43 
164.6772   58.17993 
20   43 
158.5671   64.64322 
20   43 
158.5673   64.64322 
20   43 
158.5671   64.64328 
20   43 
161.9072   62.46085 
20   43 
161.9074   62.46085 
20   43 
161.9072   62.46092 
20   43 
172.4314   57.06775 
20   43 
172.4315   57.06775 
20   43 
172.4314   57.06781 
20   43 
175.472   56.92744 
20   43 
175.4722   56.92744 
20   43 
175.472   56.9275 
20   43 
208.4436   51.61493 
20   43 
208.4438   51.61493 
20   43 
208.4436   51.61498 
20   43 
233.5959   49.98643 
20   43 
233.5961   49.98643 
20   43 
233.5959   49.98648 
20   43 
309.3894   39.4102 
20   43 
257.1321   46.70219 
20   43 
257.1324   46.70219 
20   43 
257.1321   46.70223 
20   43 
307.7792   43.26144 
20   43 
307.7795   43.26144 
20   43 
307.7792   43.26148 
20   43 
353.1255   42.96375 
20   43 
353.1259   42.96375 
20   43 
353.1255   42.96379 
20   43 
440.815   39.52802 
20   43 
440.8154   39.52802 
20   43 
440.815   39.52806 
20   43 
490.8577   39.32783 
20   43 
490.8582   39.32783 
20   43 
490.8577   39.32787 
20   43 
606.7763   37.9666 
20   43 
606.7769   37.9666 
20   43 
606.7763   37.96664 
20   43 
727.0463   37.77662 
20   43 
727.047   37.77662 
20   43 
727.0463   37.77666 
20   43 
977.7107   35.59249 
20   43 
977.7117   35.59249 
20   43 
977.7107   35.59252 
20   43 
1043.967   36.09123 
20   43 
1043.968   36.09123 
20   43 
1043.967   36.09126 
20   43 
1281.276   35.81084 
20   43 
1281.278   35.81084 
20   43 
1281.276   35.81088 
20   43 
1645.617   35.13364 
20   43 
1645.619   35.13364 
20   43 
1645.617   35.13367 
20   43 
2069.021   34.8137 
20   43 
2069.024   34.8137 
20   43 
2069.021   34.81374 
20   43 
2604.36   34.66489 
20   43 
2604.363   34.66489 
20   43 
2604.36   34.66492 
20   43 
3342.364   34.41621 
20   43 
3342.368   34.41621 
20   43 
3342.364   34.41624 
20   43 
4303   34.32951 
20   43 
4303.005   34.32951 
20   43 
4303   34.32955 
20   43 
5611.754   34.11951 
20   43 
5611.76   34.11951 
20   43 
5611.754   34.11955 
20   43 
7331.83   34.12541 
20   43 
7331.837   34.12541 
20   43 
7331.83   34.12545 
20   43 
9680.126   33.94991 
20   43 
9680.135   33.94991 
20   43 
9680.126   33.94994 
20   43 
12650.62   33.94881 
20   43 
12650.63   33.94881 
20   43 
12650.62   33.94884 
20   43 
16551.51   33.89631 
20   43 
16551.52   33.89631 
20   43 
16551.51   33.89635 
20   43 
21750.56   33.8737 
20   43 
21750.59   33.8737 
20   43 
21750.56   33.87373 
20   43 
28635.33   33.84747 
20   43 
28635.36   33.84747 
20   43 
28635.33   33.84751 
20   43 
37762.19   33.83251 
20   43 
37762.23   33.83251 
20   43 
37762.19   33.83254 
20   43 
49825.77   33.81806 
20   43 
49825.82   33.81806 
20   43 
49825.77   33.81809 
20   43 
65829.03   33.80912 
20   43 
65829.1   33.80912 
20   43 
65829.03   33.80915 
20   43 
86960.9   33.80096 
20   43 
86960.99   33.80096 
20   43 
86960.9   33.801 
20   43 
115211.6   33.79567 
20   43 
115211.8   33.79567 
20   43 
115211.6   33.7957 
20   43 
151798   33.79123 
20   43 
151798.1   33.79123 
20   43 
151798   33.79126 
20   43 
194798   33.78839 
20   43 
194798.1   33.78839 
20   43 
194798   33.78842 
20   43 
237798   33.78665 
20   43 
237798.2   33.78665 
20   43 
237798   33.78668 
20   43 
280798   33.78527 
20   43 
280798.2   33.78527 
20   43 
280798   33.7853 
20   43 
323798   33.78446 
20   43 
323798.3   33.78446 
20   43 
323798   33.7845 
20   43 
366798   33.78369 
20   43 
366798.3   33.78369 
20   43 
366798   33.78372 
Fit Mean:  366798  Size:  33.78369  Code:  5 
Try Mean:  43  Size:  0.001 
20   43 
43   0.001 
20   43 
43   0.001 
20   43 
43.00004   0.001 
20   43 
43   0.001001 
20   43 
43   0.007810842 
20   43 
43.00004   0.007810842 
20   43 
43   0.007811842 
20   43 
45.83759   8.06236 
20   43 
45.83764   8.06236 
20   43 
45.83759   8.062368 
20   43 
53.81692   20.28595 
20   43 
53.81697   20.28595 
20   43 
53.81692   20.28597 
20   43 
69.81796   42.29503 
20   43 
69.81803   42.29503 
20   43 
69.81796   42.29507 
20   43 
79.23512   55.01148 
20   43 
79.2352   55.01148 
20   43 
79.23512   55.01153 
20   43 
92.56203   72.96356 
20   43 
92.56212   72.96356 
20   43 
92.56203   72.96364 
20   43 
104.2393   88.67907 
20   43 
104.2394   88.67907 
20   43 
104.2393   88.67916 
20   43 
112.0339   99.1599 
20   43 
112.034   99.1599 
20   43 
112.0339   99.16 
20   43 
114.9477   103.0687 
20   43 
114.9479   103.0687 
20   43 
114.9477   103.0688 
20   43 
115.4654   103.7539 
20   43 
115.4655   103.7539 
20   43 
115.4654   103.754 
20   43 
115.504   103.7956 
20   43 
115.5041   103.7956 
20   43 
115.504   103.7957 
20   43 
115.6581   103.9225 
20   43 
115.6582   103.9225 
20   43 
115.6581   103.9226 
20   43 
115.8833   104.0255 
20   43 
115.8834   104.0255 
20   43 
115.8833   104.0256 
20   43 
116.3729   104.0508 
20   43 
116.373   104.0508 
20   43 
116.3729   104.0509 
20   43 
117.3702   103.6807 
20   43 
117.3703   103.6807 
20   43 
117.3702   103.6808 
20   43 
119.7609   101.9145 
20   43 
119.761   101.9145 
20   43 
119.7609   101.9146 
20   43 
127.5856   94.26848 
20   43 
127.5858   94.26848 
20   43 
127.5856   94.26857 
20   43 
135.436   86.0356 
20   43 
135.4361   86.0356 
20   43 
135.436   86.03568 
20   43 
147.8449   73.72606 
20   43 
147.845   73.72606 
20   43 
147.8449   73.72613 
20   43 
163.7934   58.94716 
20   43 
163.7935   58.94716 
20   43 
163.7934   58.94722 
20   43 
158.7973   64.42773 
20   43 
158.7975   64.42773 
20   43 
158.7973   64.4278 
20   43 
162.0298   62.40704 
20   43 
162.0299   62.40704 
20   43 
162.0298   62.40711 
20   43 
174.5162   56.32462 
20   43 
174.5164   56.32462 
20   43 
174.5162   56.32468 
20   43 
177.3839   56.52713 
20   43 
177.3841   56.52713 
20   43 
177.3839   56.52719 
20   43 
209.1856   51.94665 
20   43 
209.1858   51.94665 
20   43 
209.1856   51.9467 
20   43 
238.6092   48.31724 
20   43 
238.6094   48.31724 
20   43 
238.6092   48.31729 
20   43 
286.7914   46.29559 
20   43 
286.7917   46.29559 
20   43 
286.7914   46.29563 
20   43 
390.3485   36.66206 
20   43 
312.2379   43.9284 
20   43 
312.2382   43.9284 
20   43 
312.2379   43.92844 
20   43 
374.2656   40.84285 
20   43 
374.266   40.84285 
20   43 
374.2656   40.84289 
20   43 
417.891   40.57444 
20   43 
417.8914   40.57444 
20   43 
417.891   40.57448 
20   43 
507.4801   39.0784 
20   43 
507.4806   39.0784 
20   43 
507.4801   39.07844 
20   43 
607.8769   38.47304 
20   43 
607.8775   38.47304 
20   43 
607.8769   38.47308 
20   43 
788.3526   36.27349 
20   43 
788.3534   36.27349 
20   43 
788.3526   36.27353 
20   43 
894.4128   36.6699 
20   43 
894.4137   36.6699 
20   43 
894.4128   36.66993 
20   43 
1108.673   36.02359 
20   43 
1108.674   36.02359 
20   43 
1108.673   36.02362 
20   43 
1406.163   35.40467 
20   43 
1406.164   35.40467 
20   43 
1406.163   35.4047 
20   43 
1761.811   35.14684 
20   43 
1761.813   35.14684 
20   43 
1761.811   35.14688 
20   43 
2244.88   34.74715 
20   43 
2244.882   34.74715 
20   43 
2244.88   34.74718 
20   43 
2877.235   34.6676 
20   43 
2877.238   34.6676 
20   43 
2877.235   34.66763 
20   43 
3791.361   34.22618 
20   43 
3791.364   34.22618 
20   43 
3791.361   34.22622 
20   43 
4837.429   34.23907 
20   43 
4837.434   34.23907 
20   43 
4837.429   34.23911 
20   43 
6244.883   34.10585 
20   43 
6244.889   34.10585 
20   43 
6244.883   34.10589 
20   43 
8138.362   34.04271 
20   43 
8138.37   34.04271 
20   43 
8138.362   34.04274 
20   43 
10612.93   33.97135 
20   43 
10612.94   33.97135 
20   43 
10612.93   33.97138 
20   43 
13905.92   33.93321 
20   43 
13905.94   33.93321 
20   43 
13905.92   33.93325 
20   43 
18263.16   33.88836 
20   43 
18263.17   33.88836 
20   43 
18263.16   33.88839 
20   43 
24019.48   33.86985 
20   43 
24019.5   33.86985 
20   43 
24019.48   33.86988 
20   43 
31679.27   33.83854 
20   43 
31679.3   33.83854 
20   43 
31679.27   33.83857 
20   43 
41802.53   33.8339 
20   43 
41802.58   33.8339 
20   43 
41802.53   33.83394 
20   43 
55265   33.80871 
20   43 
55265.05   33.80871 
20   43 
55265   33.80874 
20   43 
73337.49   33.81329 
20   43 
73337.56   33.81329 
20   43 
73337.49   33.81332 
20   43 
96912.98   33.79226 
20   43 
96913.07   33.79226 
20   43 
96912.98   33.79229 
20   43 
128409   33.79954 
20   43 
128409.1   33.79954 
20   43 
128409   33.79958 
20   43 
169455.4   33.78592 
20   43 
169455.6   33.78592 
20   43 
169455.4   33.78595 
20   43 
212455.4   33.78847 
20   43 
212455.6   33.78847 
20   43 
212455.4   33.78851 
20   43 
255455.4   33.78569 
20   43 
255455.7   33.78569 
20   43 
255455.4   33.78572 
20   43 
298455.4   33.78488 
20   43 
298455.7   33.78488 
20   43 
298455.4   33.78492 
20   43 
341455.4   33.78403 
20   43 
341455.8   33.78403 
20   43 
341455.4   33.78406 
20   43 
384455.4   33.78343 
20   43 
384455.8   33.78343 
20   43 
384455.4   33.78347 
Fit Mean:  384455.4  Size:  33.78343  Code:  5 
Try Mean:  20  Size:  10000 
20   43 
20   10000 
20   43 
20   10000 
20   43 
20.00002   10000 
20   43 
20   10000.01 
20   43 
20.01424   10000 
20   43 
20.01426   10000 
20   43 
20.01424   10000.01 
20   43 
27.84093   10000 
20   43 
27.84095   10000 
20   43 
27.84093   10000.01 
20   43 
41.79035   10000 
20   43 
41.79039   10000 
20   43 
41.79035   10000.01 
20   43 
78.71306   10000 
20   43 
78.71314   10000 
20   43 
78.71306   10000.01 
20   43 
78.6248   10000 
20   43 
78.62488   10000 
20   43 
78.6248   10000.01 
20   43 
78.28426   10000 
20   43 
78.28434   10000 
20   43 
78.28426   10000.01 
20   43 
78.28826   10000 
20   43 
78.28834   10000 
20   43 
78.28826   10000.01 
20   43 
78.28822   10000 
20   43 
78.29609   10000 
20   43 
78.28043   10000 
20   43 
78.28826   10001 
20   43 
78.28826   9999 
20   43 
78.28826   10000 
20   43 
78.29609   10000 
20   43 
78.28043   10000 
20   43 
78.28826   10001 
20   43 
78.28826   9999 
Fit Mean:  78.28826  Size:  10000  Code:  2 
Try Mean:  20  Size:  1000 
20   43 
20   1000 
20   43 
20   1000 
20   43 
20.00002   1000 
20   43 
20   1000.001 
20   43 
20.01407   1000 
20   43 
20.01409   1000 
20   43 
20.01407   1000.001 
20   43 
27.95125   999.9995 
20   43 
27.95128   999.9995 
20   43 
27.95125   1000 
20   43 
42.93935   999.998 
20   43 
42.93939   999.998 
20   43 
42.93935   999.999 
20   43 
69.24162   999.9978 
20   43 
69.24169   999.9978 
20   43 
69.24162   999.9988 
20   43 
71.71204   999.9982 
20   43 
71.71211   999.9982 
20   43 
71.71204   999.9992 
20   43 
78.34439   999.9993 
20   43 
78.34447   999.9993 
20   43 
78.34439   1000 
20   43 
80.26965   999.9995 
20   43 
80.26973   999.9995 
20   43 
80.26965   1000.001 
20   43 
80.8003   999.9995 
20   43 
80.80038   999.9995 
20   43 
80.8003   1000 
20   43 
80.83765   999.9994 
20   43 
80.83773   999.9994 
20   43 
80.83765   1000 
20   43 
80.83825   999.9993 
20   43 
80.83833   999.9993 
20   43 
80.83825   1000 
20   43 
80.83928   999.9988 
20   43 
80.83936   999.9988 
20   43 
80.83928   999.9998 
20   43 
80.84091   999.9974 
20   43 
80.84099   999.9974 
20   43 
80.84091   999.9984 
20   43 
80.84358   999.9931 
20   43 
80.84366   999.9931 
20   43 
80.84358   999.9941 
20   43 
80.84789   999.9812 
20   43 
80.84797   999.9812 
20   43 
80.84789   999.9822 
20   43 
80.85492   999.949 
20   43 
80.855   999.949 
20   43 
80.85492   999.95 
20   43 
80.86641   999.8627 
20   43 
80.86649   999.8627 
20   43 
80.86641   999.8637 
20   43 
80.88525   999.6338 
20   43 
80.88533   999.6338 
20   43 
80.88525   999.6348 
20   43 
80.91651   999.0289 
20   43 
80.9166   999.0289 
20   43 
80.91651   999.0299 
20   43 
80.96918   997.4336 
20   43 
80.96926   997.4336 
20   43 
80.96918   997.4346 
20   43 
81.06044   993.2137 
20   43 
81.06053   993.2137 
20   43 
81.06044   993.2147 
20   43 
81.227   981.9 
20   43 
81.22708   981.9 
20   43 
81.227   981.9009 
20   43 
81.56628   950.0643 
20   43 
81.56636   950.0643 
20   43 
81.56628   950.0652 
20   43 
82.52728   837.9342 
20   43 
82.52737   837.9342 
20   43 
82.52728   837.9351 
20   43 
83.4022   726.1683 
20   43 
83.40229   726.1683 
20   43 
83.4022   726.169 
20   43 
85.40069   490.8817 
20   43 
85.40077   490.8817 
20   43 
85.40069   490.8822 
Fit Mean:  94.44082  Size:  -487.7354  Code:  1 
Try Mean:  20  Size:  100 
20   43 
20   100 
20   43 
20   100 
20   43 
20.00002   100 
20   43 
20   100.0001 
20   43 
20.01271   99.9999 
20   43 
20.01273   99.9999 
20   43 
20.01271   100 
20   43 
29.23511   99.93757 
20   43 
29.23514   99.93757 
20   43 
29.23511   99.93767 
20   43 
55.9009   99.76002 
20   43 
55.90096   99.76002 
20   43 
55.9009   99.76012 
20   43 
62.33845   99.82264 
20   43 
62.33851   99.82264 
20   43 
62.33845   99.82274 
20   43 
73.68681   99.99779 
20   43 
73.68688   99.99779 
20   43 
73.68681   99.99789 
20   43 
84.78558   100.2191 
20   43 
84.78566   100.2191 
20   43 
84.78558   100.2192 
20   43 
96.73738   100.4885 
20   43 
96.73747   100.4885 
20   43 
96.73738   100.4886 
20   43 
107.0088   100.7331 
20   43 
107.0089   100.7331 
20   43 
107.0088   100.7332 
20   43 
114.3341   100.9077 
20   43 
114.3343   100.9077 
20   43 
114.3341   100.9079 
20   43 
117.9537   100.9882 
20   43 
117.9538   100.9882 
20   43 
117.9537   100.9883 
20   43 
118.9586   101.0031 
20   43 
118.9587   101.0031 
20   43 
118.9586   101.0032 
20   43 
119.0918   100.9974 
20   43 
119.0919   100.9974 
20   43 
119.0918   100.9975 
20   43 
119.2875   100.9715 
20   43 
119.2876   100.9715 
20   43 
119.2875   100.9716 
20   43 
119.6447   100.881 
20   43 
119.6448   100.881 
20   43 
119.6447   100.8811 
20   43 
120.3055   100.6102 
20   43 
120.3056   100.6102 
20   43 
120.3055   100.6103 
20   43 
121.6498   99.8221 
20   43 
121.6499   99.8221 
20   43 
121.6498   99.8222 
20   43 
124.8584   97.41647 
20   43 
124.8585   97.41647 
20   43 
124.8584   97.41656 
20   43 
139.3344   85.26089 
20   43 
139.3346   85.26089 
20   43 
139.3344   85.26097 
20   43 
170.7344   59.26617 
20   43 
170.7346   59.26617 
20   43 
170.7344   59.26623 
20   43 
171.5814   58.98829 
20   43 
171.5816   58.98829 
20   43 
171.5814   58.98835 
20   43 
246.9303   52.5689 
20   43 
246.9306   52.5689 
20   43 
246.9303   52.56895 
20   43 
492.0545   6.651051 
20   43 
271.4427   47.97712 
20   43 
271.443   47.97712 
20   43 
271.4427   47.97716 
20   43 
343.0115   37.91994 
20   43 
289.8333   45.39279 
20   43 
289.8336   45.39279 
20   43 
289.8333   45.39284 
20   43 
311.3798   43.32001 
20   43 
311.3801   43.32001 
20   43 
311.3798   43.32006 
20   43 
325.3615   42.80428 
20   43 
325.3618   42.80428 
20   43 
325.3615   42.80433 
20   43 
395.6111   41.40043 
20   43 
395.6115   41.40043 
20   43 
395.6111   41.40047 
20   43 
473.1274   39.37103 
20   43 
473.1279   39.37103 
20   43 
473.1274   39.37107 
20   43 
581.3302   38.62341 
20   43 
581.3308   38.62341 
20   43 
581.3302   38.62345 
20   43 
719.3353   36.98126 
20   43 
719.336   36.98126 
20   43 
719.3353   36.9813 
20   43 
877.6274   36.75003 
20   43 
877.6283   36.75003 
20   43 
877.6274   36.75006 
20   43 
1094.098   35.85133 
20   43 
1094.1   35.85133 
20   43 
1094.098   35.85137 
20   43 
1369.329   35.6077 
20   43 
1369.331   35.6077 
20   43 
1369.329   35.60773 
20   43 
1733.752   35.01315 
20   43 
1733.753   35.01315 
20   43 
1733.752   35.01319 
20   43 
2209.5   34.90397 
20   43 
2209.503   34.90397 
20   43 
2209.5   34.90401 
20   43 
2847.428   34.47194 
20   43 
2847.431   34.47194 
20   43 
2847.428   34.47197 
20   43 
3655.985   34.41032 
20   43 
3655.988   34.41032 
20   43 
3655.985   34.41035 
20   43 
4707.319   34.21012 
20   43 
4707.324   34.21012 
20   43 
4707.319   34.21016 
20   43 
6115.181   34.15285 
20   43 
6115.187   34.15285 
20   43 
6115.181   34.15289 
20   43 
7965.775   34.02423 
20   43 
7965.783   34.02423 
20   43 
7965.775   34.02427 
20   43 
10425.72   34.00308 
20   43 
10425.73   34.00308 
20   43 
10425.72   34.00311 
20   43 
13697.36   33.91044 
20   43 
13697.38   33.91044 
20   43 
13697.36   33.91047 
20   43 
18022.97   33.91107 
20   43 
18022.99   33.91107 
20   43 
18022.97   33.9111 
20   43 
23788.43   33.85051 
20   43 
23788.46   33.85051 
20   43 
23788.43   33.85055 
20   43 
31366.07   33.8519 
20   43 
31366.1   33.8519 
20   43 
31366.07   33.85194 
20   43 
41381.42   33.82123 
20   43 
41381.46   33.82123 
20   43 
41381.42   33.82126 
20   43 
54789.18   33.81818 
20   43 
54789.24   33.81818 
20   43 
54789.18   33.81821 
20   43 
72415.21   33.80355 
20   43 
72415.29   33.80355 
20   43 
72415.21   33.80358 
20   43 
95567.8   33.80048 
20   43 
95567.89   33.80048 
20   43 
95567.8   33.80051 
20   43 
126192   33.79299 
20   43 
126192.1   33.79299 
20   43 
126192   33.79302 
20   43 
167301.7   33.79054 
20   43 
167301.8   33.79054 
20   43 
167301.7   33.79057 
20   43 
222211.7   33.78649 
20   43 
222211.9   33.78649 
20   43 
222211.7   33.78652 
20   43 
290443.5   33.78529 
20   43 
290443.7   33.78529 
20   43 
290443.5   33.78532 
20   43 
392423.8   33.78251 
20   43 
392424.2   33.78251 
20   43 
392423.8   33.78255 
20   43 
494404.2   33.78253 
20   43 
494404.7   33.78253 
20   43 
494404.2   33.78257 
Fit Mean:  494404.2  Size:  33.78253  Code:  1 
> 
> cat("Final Fit Mean: ", nb_fit_mu, " Size: ", nb_fit_size, " Code: ", nb_fit$code, " Try Size: ", try_size, "\n")
Final Fit Mean:  494404.2  Size:  33.78253  Code:  1  Try Size:  100 
> 
> ## Fit failed = reset parameters so graphing and output code can recognize this
> if ((nb_fit_mu < 0) || (nb_fit_size < 0) || (nb_fit$code != 1))
+ {
+   nb_fit_mu = 0
+   nb_fit_size = 0
+ }
> 
> 
> ## things can go wrong with fitting and we can still end up with invalid values
> 
> fit_nb = c()
> included_fract = 0
> if (nb_fit_mu > 0)
+ {
+   end_fract = pnbinom(end_i_for_fits, mu = nb_fit_mu, size=nb_fit_size)
+   start_fract = pnbinom(start_i_for_fits, mu = nb_fit_mu, size=nb_fit_size)
+   included_fract = end_fract-start_fract;
+ 
+   if (included_fract >= 0.01) {
+ 
+     ## Adjust so that we are back in full coords before making fit!!
+     if (num_per_bin > 1) 
+     {
+       nb_fit_mu = nb_fit_mu * num_per_bin
+     }
+     fit_nb = dnbinom(0:max(X$coverage), mu = nb_fit_mu, size=nb_fit_size)*inner_total/included_fract;
+   }
+ }
> 
> ## If an insufficient amount of fit was included, then invalidate it
> if (included_fract < 0.01)
+ {
+   nb_fit_mu = 0
+   nb_fit_size = 0
+ }
> 
> f_p <- function(par) {
+ 
+   lambda = par[1];
+ 
+   if (lambda <= 0)
+   {
+     return(0);
+   }
+   
+ 	total <- 0;
+ 	for (i in start_i_for_fits:end_i_for_fits)
+ 	{	
+     #cat(i, " ", lambda, "\n");
+ 		dist[i] <- dpois(i, lambda=lambda);
+ 		total <- total + dist[i] 
+ 	}
+ 	#print (total)
+ 
+  	l <- 0;
+ 	for (i in start_i_for_fits:end_i_for_fits)
+ 	{
+ 		l <- l + ((X.for.fits[i]/inner_total)-(dist[i]/total))^2;
+ 	}
+ 	return(l);
+ }
> 
> 
> ## Fit Poisson 
> ## - allow fit to fail and set all params to zero/empty if that is the case
> 
> p_fit = NULL
> try(suppressWarnings(p_fit<-nlm(f_p, c(m), print.level=this.print.level)))
> 
> fit_p = c()
> if (!is.null(p_fit) && (p_fit$estimate[1] > 0))
+ {
+   #print (nb_fit$estimate[1])
+   p_fit_lambda = p_fit$estimate[1];
+   #print(0:max(X$coverage))
+ 
+   end_fract = ppois(end_i_for_fits, lambda = p_fit_lambda)
+   start_fract = ppois(start_i_for_fits, lambda = p_fit_lambda)
+   included_fract = end_fract-start_fract;
+ 
+   ## Adjust so that we are back in full coords before making fit!!
+   if (num_per_bin > 1) 
+   {
+     p_fit_lambda = p_fit_lambda * num_per_bin
+   }
+   fit_p<-dpois(0:max(X$coverage), lambda = p_fit_lambda)*inner_total/included_fract;
+ }
> 
> 
> ## Graphing
> ##
> ## don't graph very high values with very little coverage
> i<-max_i
> while (i <= length(X$n) && X$n[i]>0.01*max_n)
+ {		
+ 	i <- i+1;
+ }
> graph_end_i <-i
> 
> ## Ths leaves enough room to the right of the peak for the legend
> graph_end_i = max(floor(2.2 * max_i), graph_end_i);
> 
> ## graphics settings
> my_pch = 21
> my_col = "black";
> my_col_censored = "red";
> 
> if (pdf_output == 0) {
+   
+   ## bitmap() requires ghostscript to be installed.
+   ## taa=4, gaa=2 options NOT compatible with earlier R versions!
+   ## units = "px" NOT compatible with even earlier R versions!
+   
+   if(!capabilities(what = "png"))
+   {
+     ## fallback to ghostscript
+     bitmap(plot_file, height=6, width=7, type = "png16m", res = 72, pointsize=18)
+   } else {
+     ## use X11 function, which gives better resolution
+     png(plot_file, height=6, width=7, units ="in", res = 72, pointsize=18)
+     par(family="sans")
+   }
+ } else {
+   pdf(plot_file, height=6, width=7)
+   par(family="sans")
+ }
> 
> par(mar=c(5.5,7.5,3,1.5));
> 
> max_y = 0
> if (plot_poisson) {
+ 	max_y = max(X$n, fit_p, fit_nb)
+ } else {
+ 	max_y = max(X$n, fit_nb)
+ }
> 
> plot(0:10, 0:10, type="n", lty="solid", ylim=c(0, max_y)*1.05, xlim=c(0, graph_end_i), lwd=1, xaxs="i", yaxs="i", axes=F, las=1, main="Coverage Distribution at Unique-Only Positions", xlab="Coverage depth (reads)", ylab="", cex.lab=1.2, cex.axis=1.2)
> 
> mtext(side = 2, text = "Number of reference positions", line = 5.5, cex=1.2)
> 
> sciNotation <- function(x, digits = 1) {
+     if (length(x) > 1) {
+         return(append(sciNotation(x[1]), sciNotation(x[-1])))     
+ 	} 
+     if (!x) return(0) 
+ 
+ 	exponent <- floor(log10(x)) 
+     base <- round(x / 10^exponent, digits)     
+ 	as.expression(substitute(base %*% 10^exponent, list(base = base, exponent = exponent))) 
+ }
> 
> #axis(2, cex.lab=1.2, las=1, cex.axis=1.2, labels=T, at=(0:6)*50000)
> axis(2, cex.lab=1.2, las=1, cex.axis=1.2, at = axTicks(2), labels = sciNotation(axTicks(2), 1))
> axis(1, cex.lab=1.2, cex.axis=1.2, labels=T)
> box()
> 
> #graph the coverage as points
> fit_data <- subset(X, (coverage>=start_i) & (coverage<=end_i) );
> points(fit_data$coverage, fit_data$n, pch=my_pch, col=my_col, bg="white", cex=1.2)
> 
> #graph the censored coverage as red points
> cat(start_i, " ", end_i, "\n", sep="")
20 43
> 
> censored_data <- subset(X, (coverage<start_i) | (coverage>end_i) );
> points(censored_data$coverage, censored_data$n, pch=my_pch, col=my_col_censored, bg="white", cex=1.2)
> 
> #graph the poisson fit IF REQUESTED
> if (plot_poisson) {
+ 	lines(0:max(X$coverage), fit_p, lwd=3, lty="22", col="black");
+ }
> 
> #graph the negative binomial fit
> if (nb_fit_mu > 0) {
+   lines(0:max(X$coverage), fit_nb, lwd=3, col="black");
+ }
> 
> if (plot_poisson) {
+ 	legend("topright", c("Coverage distribution", "Censored data", "Negative binomial", "Poisson"), lty=c("blank","blank","solid","22"), lwd=c(1,1,2,2), pch=c(my_pch, my_pch, -1, -1), col=c("black", "red", "black", "black"), bty="n")
+ } else {
+ 	legend("topright", c("Coverage distribution", "Censored data", "Negative binomial"), lty=c("blank","blank","solid"), lwd=c(1,1,2), pch=c(my_pch, my_pch, -1), col=c("black", "red", "black"), bty="n")
+ }
> 
> dev.off()
null device 
          1 
> 
> ## Fit the marginal value that we use for propagating deletions
> 
> if (nb_fit_mu > 0) {
+   cat(nb_fit_size, " ", nb_fit_mu, "\n")
+   deletion_propagation_coverage = suppressWarnings(qnbinom(deletion_propagation_pr_cutoff, size = nb_fit_size, mu = nb_fit_mu))
+ } else {
+   cat("Fallback to calculating off an estimate of just variance = mu + mu^2/size\n")
+   size_estimate = (1/(v-m))*(m*m)
+   cat("Mu estimate=", m," Size estimate =", size_estimate, "\n")
+   deletion_propagation_coverage = suppressWarnings(qnbinom(deletion_propagation_pr_cutoff, size = size_estimate, mu = m))
+   if (is.na(deletion_propagation_coverage) || is.nan(deletion_propagation_coverage) || (deletion_propagation_coverage < 1)) {
+     cat("Double fallback to calculating as just 10% of the mean\n")
+     deletion_propagation_coverage = m * 0.1
+   }
+ }
Fallback to calculating off an estimate of just variance = mu + mu^2/size
Mu estimate= 36.33333  Size estimate = 12.2573 
> 
> #Don't allow one read to indicate non-deleted regions
> if (deletion_propagation_coverage < 1) {
+     deletion_propagation_coverage = 1
+ }
> 
> #This works fine with the negative values
> #If we have both low fit coverage and low straight average coverage then we're deleted...
> if ( (nb_fit_mu <= 3) && (m <= 3) ) {
+   deletion_propagation_coverage = -1
+ }
> 
> #print out statistics
> 
> print(nb_fit_size);
[1] 0
> print(nb_fit_mu);
[1] 0
> 
> print(m)
[1] 36.33333
> print(v)
[1] 144.0333
> print(D)
[1] 3.96422
> 
> print(deletion_propagation_coverage)
[1] 12
> 
> warnings()
> 
