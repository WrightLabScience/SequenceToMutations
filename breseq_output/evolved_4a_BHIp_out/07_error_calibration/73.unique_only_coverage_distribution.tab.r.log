
R version 4.3.1 (2023-06-16) -- "Beagle Scouts"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ##
> ##
> ## AUTHORS
> ##
> ## Jeffrey E. Barrick <jeffrey.e.barrick@gmail.com>
> ##
> ## LICENSE AND COPYRIGHT
> ##
> ## Copyright (c) 2008-2010 Michigan State University
> ## Copyright (c) 2011-2022 The University of Texas at Austin
> ##
> ## breseq is free software; you can redistribute it and/or modify it under the
> ## terms the GNU General Public License as published by the Free Software
> ## Foundation; either version 1, or (at your option) any later version.
> ##
> ##
> 
> ## Arguments:
> ##   distribution_file=/path/to/input 
> ##   plot_file=/path/to/output 
> ##   deletion_propagation_pr_cutoff=float
> ##   plot_poisson=0 or 1
> ##   pdf_output=0 or 1
> 
> ## Returns these values printed out to output log
> ## 
> ##  1. print(nb_fit_size); # 0 if fit failed
> ##  2. print(nb_fit_mu);   # 0 if fit failed
> ##  3. print(m)q
> ##  4. print(v)
> ##  5. print(D)
> ##  6. print(deletion_propagation_coverage)
> ##     -1 if it was <1 after fitting (implying reference sequence is deleted)
> ##
> 
> plot_poisson = 0;
> pdf_output = 1;
> 
> this.print.level = 0
> #this.print.level = 2
> 
> for (e in commandArgs(TRUE)) {
+   ta = strsplit(e,"=",fixed=TRUE)[[1]]
+   if(length(ta)>1) {
+     temp = ta[2]
+     assign(ta[1],temp)
+     cat("assigned ",ta[1]," the value of |",temp,"|\n")
+   } else {
+     assign(ta[[1]][1],TRUE)
+     cat("assigned ",ta[1]," the value of TRUE\n")
+   }
+ }
assigned  distribution_file  the value of | 4a+_BHI_c50_out/07_error_calibration/73.unique_only_coverage_distribution.tab |
assigned  plot_file  the value of | 4a+_BHI_c50_out/output/calibration/73.unique_coverage.pdf |
assigned  deletion_propagation_pr_cutoff  the value of | 0.00276079 |
> 
> deletion_propagation_pr_cutoff = as.numeric(deletion_propagation_pr_cutoff);
> 
> ## initialize values to be filled in
> nb_fit_mu = 0
> nb_fit_size = 0
> m = 0
> v = 0
> D = 0
> deletion_propagation_coverage = -1
> 
> min_fraction_included_in_nb_fit = 0.01
> 
> #load data
> X<-read.table(distribution_file, header=T)
> 
> #table might be empty
> if (nrow(X) == 0)
+ {
+   #print out statistics
+   
+   print(nb_fit_size);
+   print(nb_fit_mu);
+   
+   print(m)
+   print(v)
+   print(D)
+   
+   print(deletion_propagation_coverage)
+   
+   q()
+ }
> 
> #create the distribution vector and fit
> Y<-rep(X$coverage, X$n)
> m<-mean(Y)
> v<-var(Y)
> D<-v/m
> 
> ###
> ## Smooth the distribution with a moving average window of size 5
> ## so that we can more reliably find it's maximum value
> ###
> 
> ma5 = c(1, 1, 1, 1, 1)/5;
> 
> ## filtering fails if there are too few points
> if (nrow(X) >= 5) {
+   X$ma = filter(X$n, ma5)
+ } else {
+ 	X$ma = X$n
+ }
> 
> i<-0
> max_n <- 0;
> min_i <- max( trunc(m/4), 1 ); #prevents zero for pathological distributions
> max_i <- i;
> for (i in min_i:length(X$ma))
+ {		
+   #cat(i, "\n")
+ 	if (!is.na(X$ma[i]) && (X$ma[i] > max_n))
+ 	{
+ 		max_n = X$ma[i];
+ 		max_i = i;
+ 	}
+ }
> 
> ##
> # Censor data on the right and left of the maximum
> ##
> 
> start_i = max(floor(max_i*0.5), 1);
> end_i = min(ceiling(max_i*1.5), length(X$ma));
> 
> if (start_i == end_i)
+ {
+   print(nb_fit_size);
+   print(nb_fit_mu);
+   
+   print(m)
+   print(v)
+   print(D)
+   
+   print(deletion_propagation_coverage)
+   
+   q()
+ }
> 
> cat("Fitting from coverage of ", start_i, " to ", end_i, ".\n", sep="")
Fitting from coverage of 13 to 39.
> 
> ##
> # Coarse grain so that we are only fitting a number of bins that is 1000-2000
> #
> # The later adjustment for doing the fits this way is to multiply the means
> # of the negative binomial and poisson distributions by the binning number.
> # (The size parameter of the negative binomial doesn't need to be adjusted.)
> ##
> 
> 
> num_per_bin = trunc((end_i - start_i) / 1000)
> 
> if (num_per_bin > 1) 
+ {
+   cat("Coarse-graining for fits\n")
+   start_i_for_fits = trunc(start_i/num_per_bin)
+   end_i_for_fits = ceiling(end_i/num_per_bin)
+   num_bins = end_i - start_i  + 1
+   cat("Fitting from coverage in adjusted bins ", start_i_for_fits, " to ", end_i_for_fits, ".\n", sep="")
+   cat("Number of bins ", num_bins, ". Each bin has ", num_per_bin, " coverage values.\n", sep="")
+ 
+   # Create a new vector where we've added together values in bins
+   X.for.fits = vector("double", end_i_for_fits)
+   for (i in start_i_for_fits:end_i_for_fits)
+   {
+     for (j in 1:num_per_bin)
+     {
+       if (i*num_per_bin+j <= length(X$n))
+       {
+         X.for.fits[i] = X.for.fits[i] + X$n[i*num_per_bin+j]
+       }
+     }
+   }
+ 
+ } else {
+   ## AVOID num_per_bin equalling zero!!
+   X.for.fits = X$n[1:end_i]
+   num_per_bin = 1
+   start_i_for_fits = start_i
+   end_i_for_fits = end_i
+ }
> 
> 
> ##
> # Now perform negative binomial fitting to the censored data
> ##
> 
> inner_total<-0;
> for (i in start_i_for_fits:end_i_for_fits)
+ {
+ 	inner_total = inner_total + X.for.fits[i]; 
+ }
> # Yes: it's correct to use X here because we want the overall total total
> total_total<-sum(X$n);
> 
> ## let's preconstruct these for speed
> dist = vector("double", end_i_for_fits)
> 
> f_nb <- function(par) {
+ 
+ 	mu = par[1];
+ 	size = par[2];
+ 
+   if ((mu <= 0) || (size <= 0))
+   {
+     return(0);
+   }
+   
+   cat(start_i_for_fits, " ", end_i_for_fits, "\n");
+   cat(mu, " ", size, "\n");
+   
+ 	dist<-c()
+ 	total <- 0;
+ 	for (i in start_i_for_fits:end_i_for_fits)
+ 	{	
+ 		dist[i] <- dnbinom(i, size=size, mu=mu);
+ 		total <- total + dist[i] 
+ 	}
+ 	#print (mu, size)
+ 
+  	l <- 0;
+ 	for (i in start_i_for_fits:end_i_for_fits)
+ 	{
+ 		l <- l + ((X.for.fits[i]/inner_total)-(dist[i]/total))^2;
+ 	}
+ 	return(l);
+ }
> 
> 
> 
> ## Fit negative binomial 
> ## - allow fit to fail and set all params to zero/empty if that is the case
> nb_fit = NULL
> ## as.numeric prevents overflow in sums involving integers
> mean_estimate = sum((as.numeric(1:end_i_for_fits)*as.numeric(X.for.fits)))/sum(as.numeric(X.for.fits))
> 
> nb_fit_mu = -1
> nb_fit_size = -1
> try_size = 100000
> try_means_index = 1
> #This is a list of different means to test <-  sometimes the actual mean doesn't lead to a fit
> try_means = c(mean_estimate, 
+               end_i_for_fits, 
+               start_i_for_fits, 
+               1*(end_i_for_fits + start_i_for_fits)/4,
+               2*(end_i_for_fits + start_i_for_fits)/4,
+               3*(end_i_for_fits + start_i_for_fits)/4
+               )
>               
>               
> nb_fit = c()
> 
> while ( ((nb_fit_mu < 0) || (nb_fit_size < 0) || (nb_fit$code != 1)) && (try_size > 0.001) && (try_means_index <= length(try_means)))
+ {
+   try_size = try_size / 10
+   try_mean = try_means[try_means_index]
+ 
+   ## SIZE ESTIMATE from the censored data can be negative, so try various values instead
+   cat("Try Mean: ", try_mean, " Size: ", try_size, "\n")
+ 
+   try( suppressWarnings(nb_fit<-nlm(f_nb, c(try_mean, try_size), iterlim=1000, print.level=this.print.level)) )
+ 
+   nb_fit_mu = nb_fit$estimate[1];
+   nb_fit_size = nb_fit$estimate[2];
+ 
+   cat("Fit Mean: ", nb_fit_mu, " Size: ", nb_fit_size, " Code: ", nb_fit$code, "\n")
+   
+   if (try_size <= 0.001) {
+     try_size = 100000
+     try_means_index = try_means_index + 1
+   }
+ }
Try Mean:  26.45977  Size:  10000 
13   39 
26.45977   10000 
13   39 
26.45977   10000 
13   39 
26.4598   10000 
13   39 
26.45977   10000.01 
13   39 
26.46815   10000 
13   39 
26.46818   10000 
13   39 
26.46815   10000.01 
13   39 
30.00633   10000 
13   39 
30.00636   10000 
13   39 
30.00633   10000.01 
13   39 
29.92406   10000 
13   39 
29.92409   10000 
13   39 
29.92406   10000.01 
13   39 
29.91566   10000 
13   39 
29.91569   10000 
13   39 
29.91566   10000.01 
13   39 
29.9157   10000 
13   39 
29.91573   10000 
13   39 
29.9157   10000.01 
13   39 
29.9157   10000 
13   39 
29.91573   10000 
13   39 
29.9157   10000.01 
Fit Mean:  29.9157  Size:  10000  Code:  2 
Try Mean:  26.45977  Size:  1000 
13   39 
26.45977   1000 
13   39 
26.45977   1000 
13   39 
26.4598   1000 
13   39 
26.45977   1000.001 
13   39 
26.46803   1000 
13   39 
26.46806   1000 
13   39 
26.46803   1000.001 
13   39 
30.02801   1000 
13   39 
30.02804   1000 
13   39 
30.02801   1000.001 
13   39 
29.96307   1000 
13   39 
29.9631   1000 
13   39 
29.96307   1000.001 
13   39 
29.95609   1000 
13   39 
29.95612   1000 
13   39 
29.95609   1000.001 
13   39 
29.95612   1000.001 
13   39 
29.95615   1000.001 
13   39 
29.95612   1000.002 
Fit Mean:  29.95612  Size:  1000.001  Code:  2 
Try Mean:  26.45977  Size:  100 
13   39 
26.45977   100 
13   39 
26.45977   100 
13   39 
26.4598   100 
13   39 
26.45977   100.0001 
13   39 
26.46698   100 
13   39 
26.46701   100 
13   39 
26.46698   100.0001 
13   39 
30.24618   100.0359 
13   39 
30.24621   100.0359 
13   39 
30.24618   100.036 
13   39 
30.36377   100.0481 
13   39 
30.3638   100.0481 
13   39 
30.36377   100.0482 
13   39 
30.38396   100.0606 
13   39 
30.38399   100.0606 
13   39 
30.38396   100.0607 
13   39 
30.39054   100.0786 
13   39 
30.39057   100.0786 
13   39 
30.39054   100.0787 
13   39 
30.41578   100.2157 
13   39 
30.41582   100.2157 
13   39 
30.41578   100.2158 
13   39 
30.44645   100.538 
13   39 
30.44648   100.538 
13   39 
30.44645   100.5381 
13   39 
30.49795   101.5232 
13   39 
30.49798   101.5232 
13   39 
30.49795   101.5233 
13   39 
30.56723   104.0229 
13   39 
30.56726   104.0229 
13   39 
30.56723   104.023 
13   39 
30.64928   110.321 
13   39 
30.64931   110.321 
13   39 
30.64928   110.3211 
13   39 
30.7042   125.0264 
13   39 
30.70423   125.0264 
13   39 
30.7042   125.0265 
13   39 
30.63846   158.8867 
13   39 
30.63849   158.8867 
13   39 
30.63846   158.8868 
13   39 
30.30823   230.1562 
13   39 
30.30826   230.1562 
13   39 
30.30823   230.1564 
13   39 
29.94837   310.8048 
13   39 
29.9484   310.8048 
13   39 
29.94837   310.8051 
13   39 
29.86917   351.094 
13   39 
29.8692   351.094 
13   39 
29.86917   351.0944 
13   39 
29.82379   437.2099 
13   39 
29.82382   437.2099 
13   39 
29.82379   437.2103 
13   39 
29.86573   569.8616 
13   39 
29.86576   569.8616 
13   39 
29.86573   569.8621 
13   39 
29.94561   747.2524 
13   39 
29.94564   747.2524 
13   39 
29.94561   747.2532 
13   39 
29.98735   953.2508 
13   39 
29.98738   953.2508 
13   39 
29.98735   953.2517 
13   39 
29.98914   1238.041 
13   39 
29.98917   1238.041 
13   39 
29.98914   1238.043 
13   39 
29.95893   1650.232 
13   39 
29.95896   1650.232 
13   39 
29.95893   1650.234 
13   39 
29.92329   2185.407 
13   39 
29.92332   2185.407 
13   39 
29.92329   2185.409 
13   39 
29.90277   2851.292 
13   39 
29.9028   2851.292 
13   39 
29.90277   2851.295 
13   39 
29.89926   3741.63 
13   39 
29.89929   3741.63 
13   39 
29.89926   3741.634 
13   39 
29.90748   4951.848 
13   39 
29.90751   4951.848 
13   39 
29.90748   4951.853 
13   39 
29.91726   6536.27 
13   39 
29.91729   6536.27 
13   39 
29.91726   6536.276 
13   39 
29.92186   8606.444 
13   39 
29.92189   8606.444 
13   39 
29.92186   8606.453 
13   39 
29.9205   11383.3 
13   39 
29.92053   11383.3 
13   39 
29.9205   11383.32 
13   39 
29.91581   15097.93 
13   39 
29.91584   15097.93 
13   39 
29.91581   15097.95 
13   39 
29.91144   19978.37 
13   39 
29.91147   19978.37 
13   39 
29.91144   19978.39 
13   39 
29.90942   26402.25 
13   39 
29.90945   26402.25 
13   39 
29.90942   26402.28 
13   39 
29.90971   34945.67 
13   39 
29.90974   34945.67 
13   39 
29.90971   34945.7 
13   39 
29.91113   46288.74 
13   39 
29.91116   46288.74 
13   39 
29.91113   46288.78 
13   39 
29.91233   61283.19 
13   39 
29.91236   61283.19 
13   39 
29.91233   61283.25 
13   39 
29.91268   81092.09 
13   39 
29.91271   81092.09 
13   39 
29.91268   81092.17 
13   39 
29.91227   107432.6 
13   39 
29.9123   107432.6 
13   39 
29.91227   107432.7 
13   39 
29.91159   142319.3 
13   39 
29.91162   142319.3 
13   39 
29.91159   142319.4 
13   39 
29.91108   188756 
13   39 
29.91111   188756 
13   39 
29.91108   188756.2 
13   39 
29.91094   249854.3 
13   39 
29.91097   249854.3 
13   39 
29.91094   249854.5 
13   39 
29.91107   330196.6 
13   39 
29.9111   330196.6 
13   39 
29.91107   330196.9 
13   39 
29.91128   433637.9 
13   39 
29.91131   433637.9 
13   39 
29.91128   433638.4 
13   39 
29.91138   537079.3 
13   39 
29.91141   537079.3 
13   39 
29.91138   537079.9 
13   39 
29.91139   640520.7 
13   39 
29.91142   640520.7 
13   39 
29.91139   640521.3 
13   39 
29.91137   743962.1 
13   39 
29.9114   743962.1 
13   39 
29.91137   743962.8 
13   39 
29.91134   847403.5 
13   39 
29.91137   847403.5 
13   39 
29.91134   847404.3 
Fit Mean:  29.91134  Size:  847403.5  Code:  5 
Try Mean:  26.45977  Size:  10 
13   39 
26.45977   10 
13   39 
26.45977   10 
13   39 
26.4598   10 
13   39 
26.45977   10.00001 
13   39 
26.46334   10.00086 
13   39 
26.46336   10.00086 
13   39 
26.46334   10.00087 
13   39 
35.08717   16.36082 
13   39 
35.0872   16.36082 
13   39 
35.08717   16.36084 
13   39 
34.35513   16.31442 
13   39 
34.35517   16.31442 
13   39 
34.35513   16.31443 
13   39 
33.28737   17.18885 
13   39 
33.2874   17.18885 
13   39 
33.28737   17.18887 
13   39 
31.80087   19.86621 
13   39 
31.8009   19.86621 
13   39 
31.80087   19.86623 
13   39 
31.40527   22.79157 
13   39 
31.4053   22.79157 
13   39 
31.40527   22.79159 
13   39 
31.51717   33.1323 
13   39 
31.5172   33.1323 
13   39 
31.51717   33.13233 
13   39 
30.48249   45.64362 
13   39 
30.48252   45.64362 
13   39 
30.48249   45.64367 
13   39 
30.57438   61.25468 
13   39 
30.57441   61.25468 
13   39 
30.57438   61.25474 
13   39 
30.30105   82.35643 
13   39 
30.30108   82.35643 
13   39 
30.30105   82.35651 
13   39 
30.37026   109.7296 
13   39 
30.37029   109.7296 
13   39 
30.37026   109.7297 
13   39 
30.01734   149.077 
13   39 
30.01737   149.077 
13   39 
30.01734   149.0772 
13   39 
30.1354   196.0785 
13   39 
30.13543   196.0785 
13   39 
30.1354   196.0787 
13   39 
30.04791   258.1746 
13   39 
30.04794   258.1746 
13   39 
30.04791   258.1748 
13   39 
30.01663   341.2311 
13   39 
30.01666   341.2311 
13   39 
30.01663   341.2315 
13   39 
29.99044   449.2003 
13   39 
29.99047   449.2003 
13   39 
29.99044   449.2007 
13   39 
29.97181   592.6059 
13   39 
29.97184   592.6059 
13   39 
29.97181   592.6065 
13   39 
29.95681   781.7669 
13   39 
29.95684   781.7669 
13   39 
29.95681   781.7677 
13   39 
29.946   1032.246 
13   39 
29.94603   1032.246 
13   39 
29.946   1032.247 
13   39 
29.93732   1363.675 
13   39 
29.93735   1363.675 
13   39 
29.93732   1363.677 
13   39 
29.93115   1802.558 
13   39 
29.93118   1802.558 
13   39 
29.93115   1802.56 
13   39 
29.92612   2383.753 
13   39 
29.92615   2383.753 
13   39 
29.92612   2383.756 
13   39 
29.92263   3153.536 
13   39 
29.92266   3153.536 
13   39 
29.92263   3153.539 
13   39 
29.9197   4173.178 
13   39 
29.91973   4173.178 
13   39 
29.9197   4173.182 
13   39 
29.91776   5523.818 
13   39 
29.91779   5523.818 
13   39 
29.91776   5523.824 
13   39 
29.91603   7312.991 
13   39 
29.91606   7312.991 
13   39 
29.91603   7312.998 
13   39 
29.91499   9683.018 
13   39 
29.91502   9683.018 
13   39 
29.91499   9683.028 
13   39 
29.91394   12822.68 
13   39 
29.91397   12822.68 
13   39 
29.91394   12822.69 
13   39 
29.9134   16981.93 
13   39 
29.91343   16981.93 
13   39 
29.9134   16981.94 
13   39 
29.91275   22491.65 
13   39 
29.91278   22491.65 
13   39 
29.91275   22491.67 
13   39 
29.9125   29790.8 
13   39 
29.91253   29790.8 
13   39 
29.9125   29790.83 
13   39 
29.91207   39458.41 
13   39 
29.9121   39458.41 
13   39 
29.91207   39458.45 
13   39 
29.91198   52266 
13   39 
29.91201   52266 
13   39 
29.91198   52266.06 
13   39 
29.91168   69228 
13   39 
29.91171   69228 
13   39 
29.91168   69228.07 
13   39 
29.91169   91688.65 
13   39 
29.91172   91688.65 
13   39 
29.91169   91688.74 
13   39 
29.91147   119975 
13   39 
29.9115   119975 
13   39 
29.91147   119975.1 
13   39 
29.91151   148261.4 
13   39 
29.91154   148261.4 
13   39 
29.91151   148261.6 
13   39 
29.91143   176547.8 
13   39 
29.91146   176547.8 
13   39 
29.91143   176548 
13   39 
29.91142   204834.2 
13   39 
29.91145   204834.2 
13   39 
29.91142   204834.4 
13   39 
29.91139   233120.6 
13   39 
29.91142   233120.6 
13   39 
29.91139   233120.8 
Fit Mean:  29.91139  Size:  233120.6  Code:  5 
Try Mean:  26.45977  Size:  1 
13   39 
26.45977   1 
13   39 
26.45977   1 
13   39 
26.4598   1 
13   39 
26.45977   1.000001 
13   39 
26.46047   1.00368 
13   39 
26.4605   1.00368 
13   39 
26.46047   1.003681 
13   39 
38.01629   16.49113 
13   39 
38.01633   16.49113 
13   39 
38.01629   16.49115 
13   39 
35.0954   13.4681 
13   39 
35.09544   13.4681 
13   39 
35.0954   13.46811 
13   39 
35.47784   14.20669 
13   39 
35.47787   14.20669 
13   39 
35.47784   14.20671 
13   39 
35.48396   14.96434 
13   39 
35.48399   14.96434 
13   39 
35.48396   14.96435 
13   39 
34.60042   19.3971 
13   39 
34.60046   19.3971 
13   39 
34.60042   19.39712 
13   39 
24.2101   59.65501 
13   39 
32.99547   25.61558 
13   39 
32.9955   25.61558 
13   39 
32.99547   25.61561 
13   39 
3.653204   143.86 
13   39 
30.06124   37.44002 
13   39 
30.06127   37.44002 
13   39 
30.06124   37.44006 
13   39 
31.12847   34.68631 
13   39 
31.1285   34.68631 
13   39 
31.12847   34.68634 
13   39 
30.99575   37.09048 
13   39 
30.99578   37.09048 
13   39 
30.99575   37.09051 
13   39 
30.43497   55.69147 
13   39 
30.43501   55.69147 
13   39 
30.43497   55.69153 
13   39 
30.44977   71.31166 
13   39 
30.4498   71.31166 
13   39 
30.44977   71.31173 
13   39 
30.27843   96.5592 
13   39 
30.27846   96.5592 
13   39 
30.27843   96.5593 
13   39 
30.23864   127.3171 
13   39 
30.23867   127.3171 
13   39 
30.23864   127.3172 
13   39 
30.08863   169.4863 
13   39 
30.08866   169.4863 
13   39 
30.08863   169.4864 
13   39 
30.15839   224.6011 
13   39 
30.15842   224.6011 
13   39 
30.15839   224.6014 
13   39 
29.94319   303.1415 
13   39 
29.94322   303.1415 
13   39 
29.94319   303.1418 
13   39 
30.00844   396.2237 
13   39 
30.00847   396.2237 
13   39 
30.00844   396.2241 
13   39 
29.98102   521.5193 
13   39 
29.98105   521.5193 
13   39 
29.98102   521.5198 
13   39 
29.96158   688.7325 
13   39 
29.96161   688.7325 
13   39 
29.96158   688.7332 
13   39 
29.94967   908.6334 
13   39 
29.9497   908.6334 
13   39 
29.94967   908.6343 
13   39 
29.94019   1200.111 
13   39 
29.94022   1200.111 
13   39 
29.94019   1200.112 
13   39 
29.93317   1585.761 
13   39 
29.9332   1585.761 
13   39 
29.93317   1585.763 
13   39 
29.9278   2096.543 
13   39 
29.92783   2096.543 
13   39 
29.9278   2096.545 
13   39 
29.92376   2772.977 
13   39 
29.92379   2772.977 
13   39 
29.92376   2772.98 
13   39 
29.92069   3668.956 
13   39 
29.92072   3668.956 
13   39 
29.92069   3668.96 
13   39 
29.91838   4855.767 
13   39 
29.91841   4855.767 
13   39 
29.91838   4855.772 
13   39 
29.91663   6427.88 
13   39 
29.91666   6427.88 
13   39 
29.91663   6427.887 
13   39 
29.91531   8510.433 
13   39 
29.91534   8510.433 
13   39 
29.91531   8510.442 
13   39 
29.91431   11269.22 
13   39 
29.91434   11269.22 
13   39 
29.91431   11269.23 
13   39 
29.91356   14923.7 
13   39 
29.91359   14923.7 
13   39 
29.91356   14923.72 
13   39 
29.91299   19764.93 
13   39 
29.91302   19764.93 
13   39 
29.91299   19764.95 
13   39 
29.91256   26177.99 
13   39 
29.91259   26177.99 
13   39 
29.91256   26178.01 
13   39 
29.91223   34671.94 
13   39 
29.91226   34671.94 
13   39 
29.91223   34671.98 
13   39 
29.91199   45928.55 
13   39 
29.91202   45928.55 
13   39 
29.91199   45928.6 
13   39 
29.91181   60822.74 
13   39 
29.91184   60822.74 
13   39 
29.91181   60822.8 
13   39 
29.91167   80579.8 
13   39 
29.9117   80579.8 
13   39 
29.91167   80579.89 
13   39 
29.91156   106782.8 
13   39 
29.91159   106782.8 
13   39 
29.91156   106782.9 
13   39 
29.9115   133261.5 
13   39 
29.91153   133261.5 
13   39 
29.9115   133261.6 
13   39 
29.91146   159740.1 
13   39 
29.91149   159740.1 
13   39 
29.91146   159740.3 
13   39 
29.91143   186218.8 
13   39 
29.91146   186218.8 
13   39 
29.91143   186219 
13   39 
29.91141   212697.4 
13   39 
29.91144   212697.4 
13   39 
29.91141   212697.7 
13   39 
29.91139   239176.1 
13   39 
29.91142   239176.1 
13   39 
29.91139   239176.3 
Fit Mean:  29.91139  Size:  239176.1  Code:  5 
Try Mean:  26.45977  Size:  0.1 
13   39 
26.45977   0.1 
13   39 
26.45977   0.1 
13   39 
26.4598   0.1 
13   39 
26.45977   0.100001 
13   39 
26.45985   0.1045358 
13   39 
26.45987   0.1045358 
13   39 
26.45985   0.1045368 
13   39 
29.71584   6.617558 
13   39 
29.71587   6.617558 
13   39 
29.71584   6.617565 
13   39 
38.47946   18.85314 
13   39 
38.4795   18.85314 
13   39 
38.47946   18.85316 
13   39 
35.44924   15.00971 
13   39 
35.44928   15.00971 
13   39 
35.44924   15.00973 
13   39 
35.17613   14.92854 
13   39 
35.17616   14.92854 
13   39 
35.17613   14.92856 
13   39 
34.16885   15.35005 
13   39 
34.16889   15.35005 
13   39 
34.16885   15.35007 
13   39 
32.56588   17.12227 
13   39 
32.56591   17.12227 
13   39 
32.56588   17.12229 
13   39 
31.90666   19.32992 
13   39 
31.90669   19.32992 
13   39 
31.90666   19.32994 
13   39 
31.24373   27.73032 
13   39 
31.24376   27.73032 
13   39 
31.24373   27.73035 
13   39 
31.32147   36.79431 
13   39 
31.3215   36.79431 
13   39 
31.32147   36.79435 
13   39 
30.11763   53.59023 
13   39 
30.11766   53.59023 
13   39 
30.11763   53.59029 
13   39 
30.58275   68.64953 
13   39 
30.58278   68.64953 
13   39 
30.58275   68.6496 
13   39 
30.37747   91.37566 
13   39 
30.3775   91.37566 
13   39 
30.37747   91.37575 
13   39 
30.18769   122.8346 
13   39 
30.18772   122.8346 
13   39 
30.18769   122.8348 
13   39 
30.16046   162.1859 
13   39 
30.16049   162.1859 
13   39 
30.16046   162.1861 
13   39 
30.06327   214.5641 
13   39 
30.0633   214.5641 
13   39 
30.06327   214.5643 
13   39 
30.0689   283.1266 
13   39 
30.06893   283.1266 
13   39 
30.0689   283.1269 
13   39 
29.97775   375.0127 
13   39 
29.97778   375.0127 
13   39 
29.97775   375.0131 
13   39 
30.01823   496.6338 
13   39 
30.01826   496.6338 
13   39 
30.01823   496.6343 
13   39 
29.9406   659.6365 
13   39 
29.94063   659.6365 
13   39 
29.9406   659.6371 
13   39 
29.96122   871.7414 
13   39 
29.96125   871.7414 
13   39 
29.96122   871.7423 
13   39 
29.93765   1151.131 
13   39 
29.93768   1151.131 
13   39 
29.93765   1151.133 
13   39 
29.93572   1521.922 
13   39 
29.93575   1521.922 
13   39 
29.93572   1521.924 
13   39 
29.92778   2011.4 
13   39 
29.92781   2011.4 
13   39 
29.92778   2011.402 
13   39 
29.92465   2660.685 
13   39 
29.92468   2660.685 
13   39 
29.92465   2660.688 
13   39 
29.92092   3519.934 
13   39 
29.92095   3519.934 
13   39 
29.92092   3519.938 
13   39 
29.91878   4658.563 
13   39 
29.91881   4658.563 
13   39 
29.91878   4658.568 
13   39 
29.91681   6166.554 
13   39 
29.91684   6166.554 
13   39 
29.91681   6166.561 
13   39 
29.91551   8164.319 
13   39 
29.91554   8164.319 
13   39 
29.91551   8164.328 
13   39 
29.91443   10810.28 
13   39 
29.91446   10810.28 
13   39 
29.91443   10810.29 
13   39 
29.91367   14316.51 
13   39 
29.9137   14316.51 
13   39 
29.91367   14316.53 
13   39 
29.91306   18959.94 
13   39 
29.91309   18959.94 
13   39 
29.91306   18959.96 
13   39 
29.91262   25113.51 
13   39 
29.91265   25113.51 
13   39 
29.91262   25113.54 
13   39 
29.91228   33260.73 
13   39 
29.91231   33260.73 
13   39 
29.91228   33260.76 
13   39 
29.91202   44060.93 
13   39 
29.91205   44060.93 
13   39 
29.91202   44060.97 
13   39 
29.91183   58364.67 
13   39 
29.91186   58364.67 
13   39 
29.91183   58364.72 
13   39 
29.91168   77286.6 
13   39 
29.91171   77286.6 
13   39 
29.91168   77286.68 
13   39 
29.91157   102406.3 
13   39 
29.9116   102406.3 
13   39 
29.91157   102406.4 
13   39 
29.91151   128866.3 
13   39 
29.91154   128866.3 
13   39 
29.91151   128866.4 
13   39 
29.91146   155326.3 
13   39 
29.91149   155326.3 
13   39 
29.91146   155326.4 
13   39 
29.91143   181786.2 
13   39 
29.91146   181786.2 
13   39 
29.91143   181786.4 
13   39 
29.91141   208246.2 
13   39 
29.91144   208246.2 
13   39 
29.91141   208246.4 
13   39 
29.91139   234706.1 
13   39 
29.91142   234706.1 
13   39 
29.91139   234706.4 
Fit Mean:  29.91139  Size:  234706.1  Code:  5 
Try Mean:  26.45977  Size:  0.01 
13   39 
26.45977   0.01 
13   39 
26.45977   0.01 
13   39 
26.4598   0.01 
13   39 
26.45977   0.010001 
13   39 
26.45978   0.01463595 
13   39 
26.4598   0.01463595 
13   39 
26.45978   0.01463695 
13   39 
29.36765   6.161431 
13   39 
29.36768   6.161431 
13   39 
29.36765   6.161437 
13   39 
37.94233   18.46422 
13   39 
37.94237   18.46422 
13   39 
37.94233   18.46424 
13   39 
35.32092   15.08994 
13   39 
35.32096   15.08994 
13   39 
35.32092   15.08996 
13   39 
35.11953   15.09118 
13   39 
35.11957   15.09118 
13   39 
35.11953   15.09119 
13   39 
33.31361   16.30601 
13   39 
33.31365   16.30601 
13   39 
33.31361   16.30603 
13   39 
32.14535   18.40454 
13   39 
32.14538   18.40454 
13   39 
32.14535   18.40456 
13   39 
31.29675   22.80271 
13   39 
31.29678   22.80271 
13   39 
31.29675   22.80273 
13   39 
31.31546   31.53395 
13   39 
31.31549   31.53395 
13   39 
31.31546   31.53398 
13   39 
30.77911   42.94663 
13   39 
30.77914   42.94663 
13   39 
30.77911   42.94667 
13   39 
30.79899   58.69004 
13   39 
30.79902   58.69004 
13   39 
30.79899   58.6901 
13   39 
29.95072   82.64082 
13   39 
29.95075   82.64082 
13   39 
29.95072   82.6409 
13   39 
30.31573   105.7456 
13   39 
30.31576   105.7456 
13   39 
30.31573   105.7457 
13   39 
30.23937   138.0003 
13   39 
30.2394   138.0003 
13   39 
30.23937   138.0004 
13   39 
30.09398   184.8347 
13   39 
30.09401   184.8347 
13   39 
30.09398   184.8349 
13   39 
30.05947   243.1628 
13   39 
30.0595   243.1628 
13   39 
30.05947   243.1631 
13   39 
30.02264   320.5509 
13   39 
30.02267   320.5509 
13   39 
30.02264   320.5512 
13   39 
29.99741   422.4076 
13   39 
29.99744   422.4076 
13   39 
29.99741   422.408 
13   39 
29.97565   557.0043 
13   39 
29.97568   557.0043 
13   39 
29.97565   557.0048 
13   39 
29.96102   734.8643 
13   39 
29.96105   734.8643 
13   39 
29.96102   734.865 
13   39 
29.94803   970.1868 
13   39 
29.94806   970.1868 
13   39 
29.94803   970.1878 
13   39 
29.94003   1281.599 
13   39 
29.94006   1281.599 
13   39 
29.94003   1281.6 
13   39 
29.93198   1693.972 
13   39 
29.93201   1693.972 
13   39 
29.93198   1693.973 
13   39 
29.92806   2239.98 
13   39 
29.92809   2239.98 
13   39 
29.92806   2239.983 
13   39 
29.92264   2963.325 
13   39 
29.92267   2963.325 
13   39 
29.92264   2963.328 
13   39 
29.92136   3921.275 
13   39 
29.92139   3921.275 
13   39 
29.92136   3921.279 
13   39 
29.91711   5190.789 
13   39 
29.91714   5190.789 
13   39 
29.91711   5190.794 
13   39 
29.91775   6872.345 
13   39 
29.91778   6872.345 
13   39 
29.91775   6872.352 
13   39 
29.9137   9102.011 
13   39 
29.91373   9102.011 
13   39 
29.9137   9102.021 
13   39 
29.91595   12057.13 
13   39 
29.91598   12057.13 
13   39 
29.91595   12057.14 
13   39 
29.91152   15980.27 
13   39 
29.91155   15980.27 
13   39 
29.91152   15980.28 
13   39 
29.91503   21186.63 
13   39 
29.91506   21186.63 
13   39 
29.91503   21186.65 
13   39 
29.91042   28108.85 
13   39 
29.91045   28108.85 
13   39 
29.91042   28108.88 
13   39 
29.91399   37297.36 
13   39 
29.91402   37297.36 
13   39 
29.91399   37297.4 
13   39 
29.91059   49474.9 
13   39 
29.91062   49474.9 
13   39 
29.91059   49474.95 
13   39 
29.91265   65607.79 
13   39 
29.91268   65607.79 
13   39 
29.91265   65607.85 
13   39 
29.9111   86959.3 
13   39 
29.91113   86959.3 
13   39 
29.9111   86959.39 
13   39 
29.9118   113419.1 
13   39 
29.91183   113419.1 
13   39 
29.9118   113419.2 
13   39 
29.91145   139878.8 
13   39 
29.91148   139878.8 
13   39 
29.91145   139879 
13   39 
29.91147   166338.6 
13   39 
29.9115   166338.6 
13   39 
29.91147   166338.8 
13   39 
29.91143   192798.4 
13   39 
29.91146   192798.4 
13   39 
29.91143   192798.6 
13   39 
29.91141   219258.2 
13   39 
29.91144   219258.2 
13   39 
29.91141   219258.4 
Fit Mean:  29.91141  Size:  219258.2  Code:  5 
Try Mean:  26.45977  Size:  0.001 
13   39 
26.45977   0.001 
13   39 
26.45977   0.001 
13   39 
26.4598   0.001 
13   39 
26.45977   0.001001 
13   39 
26.45977   0.00564613 
13   39 
26.4598   0.00564613 
13   39 
26.45977   0.00564713 
13   39 
29.33509   6.118303 
13   39 
29.33512   6.118303 
13   39 
29.33509   6.118309 
13   39 
37.87881   18.41079 
13   39 
37.87885   18.41079 
13   39 
37.87881   18.41081 
13   39 
35.3077   15.09788 
13   39 
35.30773   15.09788 
13   39 
35.3077   15.0979 
13   39 
35.11339   15.10761 
13   39 
35.11342   15.10761 
13   39 
35.11339   15.10762 
13   39 
33.1562   16.49869 
13   39 
33.15623   16.49869 
13   39 
33.1562   16.4987 
13   39 
32.13522   18.56037 
13   39 
32.13525   18.56037 
13   39 
32.13522   18.56039 
13   39 
31.16849   24.03125 
13   39 
31.16852   24.03125 
13   39 
31.16849   24.03127 
13   39 
31.32556   32.70267 
13   39 
31.32559   32.70267 
13   39 
31.32556   32.7027 
13   39 
30.68416   45.04064 
13   39 
30.68419   45.04064 
13   39 
30.68416   45.04068 
13   39 
30.74149   61.48341 
13   39 
30.74153   61.48341 
13   39 
30.74149   61.48347 
13   39 
30.06448   85.27726 
13   39 
30.06451   85.27726 
13   39 
30.06448   85.27734 
13   39 
30.29876   111.4542 
13   39 
30.29879   111.4542 
13   39 
30.29876   111.4544 
13   39 
30.17156   147.1674 
13   39 
30.17159   147.1674 
13   39 
30.17156   147.1676 
13   39 
30.09444   195.345 
13   39 
30.09447   195.345 
13   39 
30.09444   195.3452 
13   39 
30.05658   257.203 
13   39 
30.05661   257.203 
13   39 
30.05658   257.2033 
13   39 
30.01666   339.2474 
13   39 
30.01669   339.2474 
13   39 
30.01666   339.2478 
13   39 
29.99624   447.1234 
13   39 
29.99627   447.1234 
13   39 
29.99624   447.1239 
13   39 
29.97023   589.8507 
13   39 
29.97026   589.8507 
13   39 
29.97023   589.8513 
13   39 
29.96255   778.3604 
13   39 
29.96258   778.3604 
13   39 
29.96255   778.3611 
13   39 
29.94163   1028.297 
13   39 
29.94166   1028.297 
13   39 
29.94163   1028.298 
13   39 
29.94517   1359.076 
13   39 
29.9452   1359.076 
13   39 
29.94517   1359.077 
13   39 
29.92248   1799.775 
13   39 
29.92251   1799.775 
13   39 
29.92248   1799.777 
13   39 
29.9371   2385.83 
13   39 
29.93713   2385.83 
13   39 
29.9371   2385.832 
13   39 
29.91207   3171.417 
13   39 
29.9121   3171.417 
13   39 
29.91207   3171.42 
13   39 
29.92653   4210.053 
13   39 
29.92656   4210.053 
13   39 
29.92653   4210.057 
13   39 
29.91411   5580.22 
13   39 
29.91414   5580.22 
13   39 
29.91411   5580.226 
13   39 
29.91725   7391.555 
13   39 
29.91728   7391.555 
13   39 
29.91725   7391.563 
13   39 
29.91419   9785.971 
13   39 
29.91422   9785.971 
13   39 
29.91419   9785.981 
13   39 
29.91412   12960.56 
13   39 
29.91415   12960.56 
13   39 
29.91412   12960.57 
13   39 
29.91314   17163.27 
13   39 
29.91317   17163.27 
13   39 
29.91314   17163.29 
13   39 
29.91279   22732.34 
13   39 
29.91282   22732.34 
13   39 
29.91279   22732.36 
13   39 
29.91236   30109.89 
13   39 
29.91239   30109.89 
13   39 
29.91236   30109.92 
13   39 
29.9121   39879.16 
13   39 
29.91213   39879.16 
13   39 
29.9121   39879.2 
13   39 
29.91188   52825.5 
13   39 
29.91191   52825.5 
13   39 
29.91188   52825.55 
13   39 
29.91173   69962.33 
13   39 
29.91176   69962.33 
13   39 
29.91173   69962.4 
13   39 
29.91161   92699.88 
13   39 
29.91164   92699.88 
13   39 
29.91161   92699.97 
13   39 
29.91153   119159.7 
13   39 
29.91156   119159.7 
13   39 
29.91153   119159.8 
13   39 
29.91148   145619.4 
13   39 
29.91151   145619.4 
13   39 
29.91148   145619.6 
13   39 
29.91144   172079.2 
13   39 
29.91147   172079.2 
13   39 
29.91144   172079.4 
13   39 
29.91142   198539 
13   39 
29.91145   198539 
13   39 
29.91142   198539.2 
13   39 
29.9114   224998.7 
13   39 
29.91143   224998.7 
13   39 
29.9114   224999 
Fit Mean:  29.9114  Size:  224998.7  Code:  5 
Try Mean:  39  Size:  10000 
13   39 
39   10000 
13   39 
39   10000 
13   39 
39.00004   10000 
13   39 
39   10000.01 
13   39 
38.99086   10000 
13   39 
38.9909   10000 
13   39 
38.99086   10000.01 
Fit Mean:  -23.33142  Size:  10000  Code:  1 
Try Mean:  39  Size:  1000 
13   39 
39   1000 
13   39 
39   1000 
13   39 
39.00004   1000 
13   39 
39   1000.001 
13   39 
38.99117   1000 
13   39 
38.99121   1000 
13   39 
38.99117   1000.001 
Fit Mean:  -22.24253  Size:  1000.111  Code:  1 
Try Mean:  39  Size:  100 
13   39 
39   100 
13   39 
39   100 
13   39 
39.00004   100 
13   39 
39   100.0001 
13   39 
38.99358   99.99987 
13   39 
38.99362   99.99987 
13   39 
38.99358   99.99997 
Fit Mean:  -5.58014  Size:  104.572  Code:  1 
Try Mean:  39  Size:  10 
13   39 
39   10 
13   39 
39   10 
13   39 
39.00004   10 
13   39 
39   10.00001 
13   39 
38.99975   10.00029 
13   39 
38.99978   10.00029 
13   39 
38.99975   10.0003 
Fit Mean:  -27341.76  Size:  29527.69  Code:  1 
Try Mean:  39  Size:  1 
13   39 
39   1 
13   39 
39   1 
13   39 
39.00004   1 
13   39 
39   1.000001 
13   39 
39.00029   1.008388 
13   39 
39.00033   1.008388 
13   39 
39.00029   1.008389 
13   39 
39.51189   4.329201 
13   39 
39.51193   4.329201 
13   39 
39.51189   4.329205 
13   39 
40.02014   6.229885 
13   39 
40.02018   6.229885 
13   39 
40.02014   6.229891 
13   39 
40.53522   8.137571 
13   39 
40.53526   8.137571 
13   39 
40.53522   8.137579 
13   39 
40.70278   9.125039 
13   39 
40.70282   9.125039 
13   39 
40.70278   9.125048 
13   39 
40.65303   9.63097 
13   39 
40.65307   9.63097 
13   39 
40.65303   9.630979 
13   39 
40.3672   10.34282 
13   39 
40.36725   10.34282 
13   39 
40.3672   10.34283 
13   39 
38.83543   12.919 
13   39 
38.83547   12.919 
13   39 
38.83543   12.91901 
13   39 
36.96607   15.84074 
13   39 
36.9661   15.84074 
13   39 
36.96607   15.84076 
13   39 
34.07168   20.67206 
13   39 
34.07172   20.67206 
13   39 
34.07168   20.67208 
13   39 
30.91006   26.35697 
13   39 
30.91009   26.35697 
13   39 
30.91006   26.35699 
13   39 
31.75636   25.31333 
13   39 
31.75639   25.31333 
13   39 
31.75636   25.31336 
13   39 
31.63845   26.19978 
13   39 
31.63848   26.19978 
13   39 
31.63845   26.19981 
13   39 
30.48946   40.59954 
13   39 
30.48949   40.59954 
13   39 
30.48946   40.59958 
13   39 
30.6545   50.83795 
13   39 
30.65453   50.83795 
13   39 
30.6545   50.838 
13   39 
30.44038   70.05433 
13   39 
30.44041   70.05433 
13   39 
30.44038   70.0544 
13   39 
30.35187   92.51963 
13   39 
30.3519   92.51963 
13   39 
30.35187   92.51973 
13   39 
30.18056   123.745 
13   39 
30.18059   123.745 
13   39 
30.18056   123.7451 
13   39 
30.2479   164.0231 
13   39 
30.24793   164.0231 
13   39 
30.2479   164.0233 
13   39 
29.90663   224.8959 
13   39 
29.90666   224.8959 
13   39 
29.90663   224.8961 
13   39 
30.04135   290.0959 
13   39 
30.04138   290.0959 
13   39 
30.04135   290.0962 
13   39 
30.02377   379.5012 
13   39 
30.0238   379.5012 
13   39 
30.02377   379.5016 
13   39 
29.98064   502.6248 
13   39 
29.98067   502.6248 
13   39 
29.98064   502.6253 
13   39 
29.96221   662.3612 
13   39 
29.96224   662.3612 
13   39 
29.96221   662.3619 
13   39 
29.95076   874.1925 
13   39 
29.95079   874.1925 
13   39 
29.95076   874.1934 
13   39 
29.94113   1154.163 
13   39 
29.94116   1154.163 
13   39 
29.94113   1154.164 
13   39 
29.93386   1525.047 
13   39 
29.93389   1525.047 
13   39 
29.93386   1525.048 
13   39 
29.92833   2016.023 
13   39 
29.92836   2016.023 
13   39 
29.92833   2016.025 
13   39 
29.92416   2666.332 
13   39 
29.92419   2666.332 
13   39 
29.92416   2666.335 
13   39 
29.921   3527.642 
13   39 
29.92103   3527.642 
13   39 
29.921   3527.645 
13   39 
29.91861   4668.547 
13   39 
29.91864   4668.547 
13   39 
29.91861   4668.552 
13   39 
29.9168   6179.852 
13   39 
29.91683   6179.852 
13   39 
29.9168   6179.858 
13   39 
29.91544   8181.812 
13   39 
29.91547   8181.812 
13   39 
29.91544   8181.821 
13   39 
29.91441   10833.75 
13   39 
29.91444   10833.75 
13   39 
29.91441   10833.77 
13   39 
29.91363   14346.96 
13   39 
29.91366   14346.96 
13   39 
29.91363   14346.97 
13   39 
29.91304   19000.82 
13   39 
29.91307   19000.82 
13   39 
29.91304   19000.84 
13   39 
29.9126   25166.53 
13   39 
29.91263   25166.53 
13   39 
29.9126   25166.56 
13   39 
29.91227   33333.24 
13   39 
29.9123   33333.24 
13   39 
29.91227   33333.27 
13   39 
29.91201   44149.53 
13   39 
29.91204   44149.53 
13   39 
29.91201   44149.57 
13   39 
29.91182   58474.84 
13   39 
29.91185   58474.84 
13   39 
29.91182   58474.9 
13   39 
29.91168   77482.16 
13   39 
29.91171   77482.16 
13   39 
29.91168   77482.24 
13   39 
29.91157   102601.9 
13   39 
29.9116   102601.9 
13   39 
29.91157   102602 
13   39 
29.91149   135967.8 
13   39 
29.91152   135967.8 
13   39 
29.91149   135967.9 
13   39 
29.91143   174980.6 
13   39 
29.91146   174980.6 
13   39 
29.91143   174980.7 
13   39 
29.9114   213993.4 
13   39 
29.91143   213993.4 
13   39 
29.9114   213993.6 
13   39 
29.91138   253006.2 
13   39 
29.91141   253006.2 
13   39 
29.91138   253006.5 
13   39 
29.91136   292019 
13   39 
29.91139   292019 
13   39 
29.91136   292019.3 
13   39 
29.91135   331031.8 
13   39 
29.91138   331031.8 
13   39 
29.91135   331032.2 
Fit Mean:  29.91135  Size:  331031.8  Code:  5 
Try Mean:  39  Size:  0.1 
13   39 
39   0.1 
13   39 
39   0.1 
13   39 
39.00004   0.1 
13   39 
39   0.100001 
13   39 
39.00004   0.1110487 
13   39 
39.00007   0.1110487 
13   39 
39.00004   0.1110497 
13   39 
39.3589   3.409918 
13   39 
39.35894   3.409918 
13   39 
39.3589   3.409922 
13   39 
39.79496   5.351983 
13   39 
39.795   5.351983 
13   39 
39.79496   5.351988 
13   39 
40.33802   7.51846 
13   39 
40.33806   7.51846 
13   39 
40.33802   7.518467 
13   39 
40.61643   8.830856 
13   39 
40.61647   8.830856 
13   39 
40.61643   8.830865 
13   39 
40.66155   9.488616 
13   39 
40.66159   9.488616 
13   39 
40.66155   9.488626 
13   39 
40.5706   9.895013 
13   39 
40.57064   9.895013 
13   39 
40.5706   9.895023 
13   39 
40.07919   10.94353 
13   39 
40.07923   10.94353 
13   39 
40.07919   10.94354 
13   39 
37.00645   16.10805 
13   39 
37.00649   16.10805 
13   39 
37.00645   16.10806 
13   39 
30.75516   26.7613 
13   39 
30.75519   26.7613 
13   39 
30.75516   26.76133 
13   39 
33.0236   23.12329 
13   39 
31.61446   25.3832 
13   39 
31.61449   25.3832 
13   39 
31.61446   25.38323 
13   39 
31.51743   25.97659 
13   39 
31.51746   25.97659 
13   39 
31.51743   25.97662 
13   39 
30.40317   37.59714 
13   39 
30.4032   37.59714 
13   39 
30.40317   37.59718 
13   39 
30.48156   45.78949 
13   39 
30.48159   45.78949 
13   39 
30.48156   45.78953 
13   39 
30.64787   62.60021 
13   39 
30.6479   62.60021 
13   39 
30.64787   62.60027 
13   39 
30.31526   83.65393 
13   39 
30.31529   83.65393 
13   39 
30.31526   83.65402 
13   39 
30.27943   112.1804 
13   39 
30.27946   112.1804 
13   39 
30.27943   112.1805 
13   39 
30.12717   148.4978 
13   39 
30.1272   148.4978 
13   39 
30.12717   148.498 
13   39 
30.15449   196.8593 
13   39 
30.15452   196.8593 
13   39 
30.15449   196.8595 
13   39 
29.98843   262.3791 
13   39 
29.98846   262.3791 
13   39 
29.98843   262.3794 
13   39 
30.05936   348.1143 
13   39 
30.05939   348.1143 
13   39 
30.05936   348.1147 
13   39 
29.9726   460.0788 
13   39 
29.97263   460.0788 
13   39 
29.9726   460.0793 
13   39 
29.9715   607.4906 
13   39 
29.97153   607.4906 
13   39 
29.9715   607.4912 
13   39 
29.95369   800.6244 
13   39 
29.95372   800.6244 
13   39 
29.95369   800.6252 
13   39 
29.94486   1057.557 
13   39 
29.94489   1057.557 
13   39 
29.94486   1057.559 
13   39 
29.93602   1396.806 
13   39 
29.93605   1396.806 
13   39 
29.93602   1396.807 
13   39 
29.93032   1846.497 
13   39 
29.93035   1846.497 
13   39 
29.93032   1846.499 
13   39 
29.92547   2441.744 
13   39 
29.9255   2441.744 
13   39 
29.92547   2441.747 
13   39 
29.9221   3230.305 
13   39 
29.92213   3230.305 
13   39 
29.9221   3230.308 
13   39 
29.91937   4274.718 
13   39 
29.9194   4274.718 
13   39 
29.91937   4274.722 
13   39 
29.91742   5658.249 
13   39 
29.91745   5658.249 
13   39 
29.91742   5658.255 
13   39 
29.91588   7490.914 
13   39 
29.91591   7490.914 
13   39 
29.91588   7490.922 
13   39 
29.91476   9918.643 
13   39 
29.91479   9918.643 
13   39 
29.91476   9918.653 
13   39 
29.91389   13134.72 
13   39 
29.91392   13134.72 
13   39 
29.91389   13134.74 
13   39 
29.91324   17395.07 
13   39 
29.91327   17395.07 
13   39 
29.91324   17395.09 
13   39 
29.91275   23038.74 
13   39 
29.91278   23038.74 
13   39 
29.91275   23038.76 
13   39 
29.91238   30514.29 
13   39 
29.91241   30514.29 
13   39 
29.91238   30514.32 
13   39 
29.9121   40418.07 
13   39 
29.91213   40418.07 
13   39 
29.9121   40418.11 
13   39 
29.91189   53541.38 
13   39 
29.91192   53541.38 
13   39 
29.91189   53541.44 
13   39 
29.91173   70912.7 
13   39 
29.91176   70912.7 
13   39 
29.91173   70912.77 
13   39 
29.91161   93982.11 
13   39 
29.91164   93982.11 
13   39 
29.91161   93982.21 
13   39 
29.91152   124413 
13   39 
29.91155   124413 
13   39 
29.91152   124413.1 
13   39 
29.91145   163413.1 
13   39 
29.91148   163413.1 
13   39 
29.91145   163413.2 
13   39 
29.91141   202413.2 
13   39 
29.91144   202413.2 
13   39 
29.91141   202413.4 
13   39 
29.91138   241413.3 
13   39 
29.91141   241413.3 
13   39 
29.91138   241413.6 
13   39 
29.91137   280413.5 
13   39 
29.9114   280413.5 
13   39 
29.91137   280413.7 
13   39 
29.91135   319413.6 
13   39 
29.91138   319413.6 
13   39 
29.91135   319413.9 
Fit Mean:  29.91135  Size:  319413.6  Code:  5 
Try Mean:  39  Size:  0.01 
13   39 
39   0.01 
13   39 
39   0.01 
13   39 
39.00004   0.01 
13   39 
39   0.010001 
13   39 
39   0.02135734 
13   39 
39.00004   0.02135734 
13   39 
39   0.02135834 
13   39 
39.34389   3.318687 
13   39 
39.34393   3.318687 
13   39 
39.34389   3.318691 
13   39 
39.77112   5.262374 
13   39 
39.77116   5.262374 
13   39 
39.77112   5.262379 
13   39 
40.3127   7.450204 
13   39 
40.31274   7.450204 
13   39 
40.3127   7.450211 
13   39 
40.59979   8.796509 
13   39 
40.59984   8.796509 
13   39 
40.59979   8.796517 
13   39 
40.65421   9.478584 
13   39 
40.65425   9.478584 
13   39 
40.65421   9.478594 
13   39 
40.57236   9.875642 
13   39 
40.5724   9.875642 
13   39 
40.57236   9.875652 
13   39 
40.13125   10.84948 
13   39 
40.13129   10.84948 
13   39 
40.13125   10.84949 
13   39 
37.60336   15.13805 
13   39 
37.6034   15.13805 
13   39 
37.60336   15.13806 
13   39 
33.05391   22.89163 
13   39 
33.05394   22.89163 
13   39 
33.05391   22.89165 
Fit Mean:  -145.653  Size:  337.9951  Code:  1 
Try Mean:  39  Size:  0.001 
13   39 
39   0.001 
13   39 
39   0.001 
13   39 
39.00004   0.001 
13   39 
39   0.001001 
13   39 
39   0.01238867 
13   39 
39.00004   0.01238867 
13   39 
39   0.01238967 
13   39 
39.3424   3.309568 
13   39 
39.34244   3.309568 
13   39 
39.3424   3.309572 
13   39 
39.76872   5.253398 
13   39 
39.76876   5.253398 
13   39 
39.76872   5.253404 
13   39 
40.31012   7.443315 
13   39 
40.31016   7.443315 
13   39 
40.31012   7.443322 
13   39 
40.59806   8.793011 
13   39 
40.5981   8.793011 
13   39 
40.59806   8.79302 
13   39 
40.6534   9.477596 
13   39 
40.65344   9.477596 
13   39 
40.6534   9.477606 
13   39 
40.57241   9.873877 
13   39 
40.57245   9.873877 
13   39 
40.57241   9.873887 
13   39 
40.1361   10.84054 
13   39 
40.13614   10.84054 
13   39 
40.1361   10.84055 
13   39 
37.65457   15.05488 
13   39 
37.65461   15.05488 
13   39 
37.65457   15.05489 
13   39 
33.24296   22.57287 
13   39 
33.243   22.57287 
13   39 
33.24296   22.57289 
13   39 
28.58877   31.01093 
13   39 
31.87225   25.05798 
13   39 
31.87228   25.05798 
13   39 
31.87225   25.058 
13   39 
31.17309   26.77978 
13   39 
31.17313   26.77978 
13   39 
31.17309   26.7798 
13   39 
31.16023   27.44109 
13   39 
31.16026   27.44109 
13   39 
31.16023   27.44111 
13   39 
31.01252   41.63464 
13   39 
31.01255   41.63464 
13   39 
31.01252   41.63468 
13   39 
30.49025   54.86445 
13   39 
30.49028   54.86445 
13   39 
30.49025   54.86451 
13   39 
30.67797   76.47208 
13   39 
30.678   76.47208 
13   39 
30.67797   76.47215 
13   39 
30.03705   105.1561 
13   39 
30.03708   105.1561 
13   39 
30.03705   105.1562 
13   39 
30.12303   132.6215 
13   39 
30.12306   132.6215 
13   39 
30.12303   132.6217 
13   39 
30.12578   176.4992 
13   39 
30.12581   176.4992 
13   39 
30.12578   176.4994 
13   39 
30.05987   231.8192 
13   39 
30.0599   231.8192 
13   39 
30.05987   231.8194 
13   39 
30.03693   306.0839 
13   39 
30.03696   306.0839 
13   39 
30.03693   306.0842 
13   39 
29.99579   403.311 
13   39 
29.99582   403.311 
13   39 
29.99579   403.3114 
13   39 
29.98682   531.9853 
13   39 
29.98685   531.9853 
13   39 
29.98682   531.9858 
13   39 
29.95567   702.2796 
13   39 
29.9557   702.2796 
13   39 
29.95567   702.2803 
13   39 
29.95974   927.573 
13   39 
29.95977   927.573 
13   39 
29.95974   927.5739 
13   39 
29.93024   1227.536 
13   39 
29.93027   1227.536 
13   39 
29.93024   1227.537 
13   39 
29.94489   1625.56 
13   39 
29.94492   1625.56 
13   39 
29.94489   1625.562 
13   39 
29.91722   2157.189 
13   39 
29.91725   2157.189 
13   39 
29.91722   2157.191 
13   39 
29.93104   2860.252 
13   39 
29.93107   2860.252 
13   39 
29.93104   2860.255 
13   39 
29.91614   3790.126 
13   39 
29.91617   3790.126 
13   39 
29.91614   3790.13 
13   39 
29.92031   5019.651 
13   39 
29.92034   5019.651 
13   39 
29.92031   5019.656 
13   39 
29.91537   6645.175 
13   39 
29.9154   6645.175 
13   39 
29.91537   6645.181 
13   39 
29.9157   8799.827 
13   39 
29.91573   8799.827 
13   39 
29.9157   8799.836 
13   39 
29.91394   11651.8 
13   39 
29.91397   11651.8 
13   39 
29.91394   11651.82 
13   39 
29.91361   15431.41 
13   39 
29.91364   15431.41 
13   39 
29.91361   15431.42 
13   39 
29.91286   20437.08 
13   39 
29.91289   20437.08 
13   39 
29.91286   20437.1 
13   39 
29.91255   27067.89 
13   39 
29.91258   27067.89 
13   39 
29.91255   27067.92 
13   39 
29.91218   35854.01 
13   39 
29.91221   35854.01 
13   39 
29.91218   35854.04 
13   39 
29.91197   47494.65 
13   39 
29.912   47494.65 
13   39 
29.91197   47494.7 
13   39 
29.91178   62911.39 
13   39 
29.91181   62911.39 
13   39 
29.91178   62911.45 
13   39 
29.91165   83308.37 
13   39 
29.91168   83308.37 
13   39 
29.91165   83308.45 
13   39 
29.91155   110415.7 
13   39 
29.91158   110415.7 
13   39 
29.91155   110415.9 
13   39 
29.91147   146251.5 
13   39 
29.9115   146251.5 
13   39 
29.91147   146251.6 
13   39 
29.91142   185251.5 
13   39 
29.91145   185251.5 
13   39 
29.91142   185251.7 
13   39 
29.91139   224251.5 
13   39 
29.91142   224251.5 
13   39 
29.91139   224251.7 
13   39 
29.91137   263251.5 
13   39 
29.9114   263251.5 
13   39 
29.91137   263251.7 
13   39 
29.91136   302251.5 
13   39 
29.91139   302251.5 
13   39 
29.91136   302251.8 
13   39 
29.91134   341251.5 
13   39 
29.91137   341251.5 
13   39 
29.91134   341251.8 
Fit Mean:  29.91134  Size:  341251.5  Code:  5 
Try Mean:  13  Size:  10000 
13   39 
13   10000 
13   39 
13   10000 
13   39 
13.00001   10000 
13   39 
13   10000.01 
13   39 
13.0224   10000 
13   39 
13.02242   10000 
13   39 
13.0224   10000.01 
13   39 
19.12854   10000 
13   39 
19.12856   10000 
13   39 
19.12854   10000.01 
13   39 
28.73147   10000 
13   39 
28.7315   10000 
13   39 
28.73147   10000.01 
13   39 
31.17351   10000 
13   39 
29.944   10000 
13   39 
29.94403   10000 
13   39 
29.944   10000.01 
13   39 
29.91726   10000 
13   39 
29.91729   10000 
13   39 
29.91726   10000.01 
13   39 
29.9157   10000 
13   39 
29.91573   10000 
13   39 
29.9157   10000.01 
13   39 
29.9157   10000 
13   39 
29.91573   10000 
13   39 
29.9157   10000.01 
Fit Mean:  29.9157  Size:  10000  Code:  2 
Try Mean:  13  Size:  1000 
13   39 
13   1000 
13   39 
13   1000 
13   39 
13.00001   1000 
13   39 
13   1000.001 
13   39 
13.02225   1000 
13   39 
13.02226   1000 
13   39 
13.02225   1000.001 
13   39 
19.18106   999.9997 
13   39 
19.18108   999.9997 
13   39 
19.18106   1000.001 
13   39 
29.10471   999.9992 
13   39 
29.10474   999.9992 
13   39 
29.10471   1000 
13   39 
30.70755   999.9992 
13   39 
30.70758   999.9992 
13   39 
30.70755   1000 
13   39 
29.992   999.9992 
13   39 
29.99203   999.9992 
13   39 
29.992   1000 
13   39 
29.9544   999.9993 
13   39 
29.95443   999.9993 
13   39 
29.9544   1000 
13   39 
29.95612   999.9993 
13   39 
29.95615   999.9993 
13   39 
29.95612   1000 
13   39 
29.95612   999.9994 
13   39 
29.95615   999.9994 
13   39 
29.95612   1000 
Fit Mean:  29.95612  Size:  999.9994  Code:  2 
Try Mean:  13  Size:  100 
13   39 
13   100 
13   39 
13   100 
13   39 
13.00001   100 
13   39 
13   100.0001 
13   39 
13.02089   99.99991 
13   39 
13.0209   99.99991 
13   39 
13.02089   100 
13   39 
19.74914   99.97301 
13   39 
19.74916   99.97301 
13   39 
19.74914   99.97311 
13   39 
32.50985   99.91301 
13   39 
32.50989   99.91301 
13   39 
32.50985   99.91311 
13   39 
30.29879   99.91831 
13   39 
30.29882   99.91831 
13   39 
30.29879   99.91841 
13   39 
30.39773   99.92432 
13   39 
30.39776   99.92432 
13   39 
30.39773   99.92442 
13   39 
30.38433   99.92998 
13   39 
30.38436   99.92998 
13   39 
30.38433   99.93008 
13   39 
30.37809   99.94199 
13   39 
30.37812   99.94199 
13   39 
30.37809   99.94209 
13   39 
30.35857   100.0179 
13   39 
30.3586   100.0179 
13   39 
30.35857   100.018 
13   39 
30.33251   100.207 
13   39 
30.33254   100.207 
13   39 
30.33251   100.2071 
13   39 
30.28639   100.7802 
13   39 
30.28643   100.7802 
13   39 
30.28639   100.7803 
13   39 
30.21476   102.2667 
13   39 
30.21479   102.2667 
13   39 
30.21476   102.2668 
13   39 
30.10513   106.0508 
13   39 
30.10516   106.0508 
13   39 
30.10513   106.0509 
13   39 
29.9634   114.6787 
13   39 
29.96343   114.6787 
13   39 
29.9634   114.6788 
13   39 
29.83073   132.3084 
13   39 
29.83076   132.3084 
13   39 
29.83073   132.3086 
13   39 
29.79418   165.2777 
13   39 
29.79421   165.2777 
13   39 
29.79418   165.2779 
13   39 
29.92622   217.5291 
13   39 
29.92625   217.5291 
13   39 
29.92622   217.5293 
13   39 
30.06732   279.5886 
13   39 
30.06735   279.5886 
13   39 
30.06732   279.5888 
13   39 
30.11344   351.5058 
13   39 
30.11347   351.5058 
13   39 
30.11344   351.5061 
13   39 
30.08014   461.0816 
13   39 
30.08017   461.0816 
13   39 
30.08014   461.0821 
13   39 
29.99285   618.5359 
13   39 
29.99288   618.5359 
13   39 
29.99285   618.5366 
13   39 
29.92359   808.6543 
13   39 
29.92362   808.6543 
13   39 
29.92359   808.6552 
13   39 
29.89519   1044.723 
13   39 
29.89522   1044.723 
13   39 
29.89519   1044.725 
13   39 
29.90072   1373.177 
13   39 
29.90075   1373.177 
13   39 
29.90072   1373.178 
13   39 
29.92139   1811.313 
13   39 
29.92142   1811.313 
13   39 
29.92139   1811.315 
13   39 
29.93501   2377.238 
13   39 
29.93504   2377.238 
13   39 
29.93501   2377.24 
13   39 
29.93525   3132.704 
13   39 
29.93528   3132.704 
13   39 
29.93525   3132.707 
13   39 
29.92615   4154.388 
13   39 
29.92618   4154.388 
13   39 
29.92615   4154.393 
13   39 
29.916   5500.728 
13   39 
29.91603   5500.728 
13   39 
29.916   5500.734 
13   39 
29.91035   7264.738 
13   39 
29.91038   7264.738 
13   39 
29.91035   7264.746 
13   39 
29.90976   9607.113 
13   39 
29.90979   9607.113 
13   39 
29.90976   9607.122 
13   39 
29.91185   12719.59 
13   39 
29.91188   12719.59 
13   39 
29.91185   12719.6 
13   39 
29.91381   16832.36 
13   39 
29.91384   16832.36 
13   39 
29.91381   16832.37 
13   39 
29.91428   22279.35 
13   39 
29.91431   22279.35 
13   39 
29.91428   22279.37 
13   39 
29.91342   29513.87 
13   39 
29.91345   29513.87 
13   39 
29.91342   29513.9 
13   39 
29.91218   39097.19 
13   39 
29.91221   39097.19 
13   39 
29.91218   39097.23 
13   39 
29.91132   51775.19 
13   39 
29.91135   51775.19 
13   39 
29.91132   51775.24 
13   39 
29.91109   68571 
13   39 
29.91112   68571 
13   39 
29.91109   68571.07 
13   39 
29.91126   90866.85 
13   39 
29.91129   90866.85 
13   39 
29.91126   90866.94 
13   39 
29.91151   120290.4 
13   39 
29.91154   120290.4 
13   39 
29.91151   120290.6 
13   39 
29.91161   159109.7 
13   39 
29.91164   159109.7 
13   39 
29.91161   159109.9 
13   39 
29.91154   211132.7 
13   39 
29.91157   211132.7 
13   39 
29.91154   211133 
13   39 
29.91139   280039.5 
13   39 
29.91142   280039.5 
13   39 
29.91139   280039.8 
Fit Mean:  29.91139  Size:  280039.5  Code:  1 
> 
> cat("Final Fit Mean: ", nb_fit_mu, " Size: ", nb_fit_size, " Code: ", nb_fit$code, " Try Size: ", try_size, "\n")
Final Fit Mean:  29.91139  Size:  280039.5  Code:  1  Try Size:  100 
> 
> ## Fit failed = reset parameters so graphing and output code can recognize this
> if ((nb_fit_mu < 0) || (nb_fit_size < 0) || (nb_fit$code != 1))
+ {
+   nb_fit_mu = 0
+   nb_fit_size = 0
+ }
> 
> 
> ## things can go wrong with fitting and we can still end up with invalid values
> 
> fit_nb = c()
> included_fract = 0
> if (nb_fit_mu > 0)
+ {
+   end_fract = pnbinom(end_i_for_fits, mu = nb_fit_mu, size=nb_fit_size)
+   start_fract = pnbinom(start_i_for_fits, mu = nb_fit_mu, size=nb_fit_size)
+   included_fract = end_fract-start_fract;
+ 
+   if (included_fract >= 0.01) {
+ 
+     ## Adjust so that we are back in full coords before making fit!!
+     if (num_per_bin > 1) 
+     {
+       nb_fit_mu = nb_fit_mu * num_per_bin
+     }
+     fit_nb = dnbinom(0:max(X$coverage), mu = nb_fit_mu, size=nb_fit_size)*inner_total/included_fract;
+   }
+ }
> 
> ## If an insufficient amount of fit was included, then invalidate it
> if (included_fract < 0.01)
+ {
+   nb_fit_mu = 0
+   nb_fit_size = 0
+ }
> 
> f_p <- function(par) {
+ 
+   lambda = par[1];
+ 
+   if (lambda <= 0)
+   {
+     return(0);
+   }
+   
+ 	total <- 0;
+ 	for (i in start_i_for_fits:end_i_for_fits)
+ 	{	
+     #cat(i, " ", lambda, "\n");
+ 		dist[i] <- dpois(i, lambda=lambda);
+ 		total <- total + dist[i] 
+ 	}
+ 	#print (total)
+ 
+  	l <- 0;
+ 	for (i in start_i_for_fits:end_i_for_fits)
+ 	{
+ 		l <- l + ((X.for.fits[i]/inner_total)-(dist[i]/total))^2;
+ 	}
+ 	return(l);
+ }
> 
> 
> ## Fit Poisson 
> ## - allow fit to fail and set all params to zero/empty if that is the case
> 
> p_fit = NULL
> try(suppressWarnings(p_fit<-nlm(f_p, c(m), print.level=this.print.level)))
> 
> fit_p = c()
> if (!is.null(p_fit) && (p_fit$estimate[1] > 0))
+ {
+   #print (nb_fit$estimate[1])
+   p_fit_lambda = p_fit$estimate[1];
+   #print(0:max(X$coverage))
+ 
+   end_fract = ppois(end_i_for_fits, lambda = p_fit_lambda)
+   start_fract = ppois(start_i_for_fits, lambda = p_fit_lambda)
+   included_fract = end_fract-start_fract;
+ 
+   ## Adjust so that we are back in full coords before making fit!!
+   if (num_per_bin > 1) 
+   {
+     p_fit_lambda = p_fit_lambda * num_per_bin
+   }
+   fit_p<-dpois(0:max(X$coverage), lambda = p_fit_lambda)*inner_total/included_fract;
+ }
> 
> 
> ## Graphing
> ##
> ## don't graph very high values with very little coverage
> i<-max_i
> while (i <= length(X$n) && X$n[i]>0.01*max_n)
+ {		
+ 	i <- i+1;
+ }
> graph_end_i <-i
> 
> ## Ths leaves enough room to the right of the peak for the legend
> graph_end_i = max(floor(2.2 * max_i), graph_end_i);
> 
> ## graphics settings
> my_pch = 21
> my_col = "black";
> my_col_censored = "red";
> 
> if (pdf_output == 0) {
+   
+   ## bitmap() requires ghostscript to be installed.
+   ## taa=4, gaa=2 options NOT compatible with earlier R versions!
+   ## units = "px" NOT compatible with even earlier R versions!
+   
+   if(!capabilities(what = "png"))
+   {
+     ## fallback to ghostscript
+     bitmap(plot_file, height=6, width=7, type = "png16m", res = 72, pointsize=18)
+   } else {
+     ## use X11 function, which gives better resolution
+     png(plot_file, height=6, width=7, units ="in", res = 72, pointsize=18)
+     par(family="sans")
+   }
+ } else {
+   pdf(plot_file, height=6, width=7)
+   par(family="sans")
+ }
> 
> par(mar=c(5.5,7.5,3,1.5));
> 
> max_y = 0
> if (plot_poisson) {
+ 	max_y = max(X$n, fit_p, fit_nb)
+ } else {
+ 	max_y = max(X$n, fit_nb)
+ }
> 
> plot(0:10, 0:10, type="n", lty="solid", ylim=c(0, max_y)*1.05, xlim=c(0, graph_end_i), lwd=1, xaxs="i", yaxs="i", axes=F, las=1, main="Coverage Distribution at Unique-Only Positions", xlab="Coverage depth (reads)", ylab="", cex.lab=1.2, cex.axis=1.2)
> 
> mtext(side = 2, text = "Number of reference positions", line = 5.5, cex=1.2)
> 
> sciNotation <- function(x, digits = 1) {
+     if (length(x) > 1) {
+         return(append(sciNotation(x[1]), sciNotation(x[-1])))     
+ 	} 
+     if (!x) return(0) 
+ 
+ 	exponent <- floor(log10(x)) 
+     base <- round(x / 10^exponent, digits)     
+ 	as.expression(substitute(base %*% 10^exponent, list(base = base, exponent = exponent))) 
+ }
> 
> #axis(2, cex.lab=1.2, las=1, cex.axis=1.2, labels=T, at=(0:6)*50000)
> axis(2, cex.lab=1.2, las=1, cex.axis=1.2, at = axTicks(2), labels = sciNotation(axTicks(2), 1))
> axis(1, cex.lab=1.2, cex.axis=1.2, labels=T)
> box()
> 
> #graph the coverage as points
> fit_data <- subset(X, (coverage>=start_i) & (coverage<=end_i) );
> points(fit_data$coverage, fit_data$n, pch=my_pch, col=my_col, bg="white", cex=1.2)
> 
> #graph the censored coverage as red points
> cat(start_i, " ", end_i, "\n", sep="")
13 39
> 
> censored_data <- subset(X, (coverage<start_i) | (coverage>end_i) );
> points(censored_data$coverage, censored_data$n, pch=my_pch, col=my_col_censored, bg="white", cex=1.2)
> 
> #graph the poisson fit IF REQUESTED
> if (plot_poisson) {
+ 	lines(0:max(X$coverage), fit_p, lwd=3, lty="22", col="black");
+ }
> 
> #graph the negative binomial fit
> if (nb_fit_mu > 0) {
+   lines(0:max(X$coverage), fit_nb, lwd=3, col="black");
+ }
> 
> if (plot_poisson) {
+ 	legend("topright", c("Coverage distribution", "Censored data", "Negative binomial", "Poisson"), lty=c("blank","blank","solid","22"), lwd=c(1,1,2,2), pch=c(my_pch, my_pch, -1, -1), col=c("black", "red", "black", "black"), bty="n")
+ } else {
+ 	legend("topright", c("Coverage distribution", "Censored data", "Negative binomial"), lty=c("blank","blank","solid"), lwd=c(1,1,2), pch=c(my_pch, my_pch, -1), col=c("black", "red", "black"), bty="n")
+ }
> 
> dev.off()
null device 
          1 
> 
> ## Fit the marginal value that we use for propagating deletions
> 
> if (nb_fit_mu > 0) {
+   cat(nb_fit_size, " ", nb_fit_mu, "\n")
+   deletion_propagation_coverage = suppressWarnings(qnbinom(deletion_propagation_pr_cutoff, size = nb_fit_size, mu = nb_fit_mu))
+ } else {
+   cat("Fallback to calculating off an estimate of just variance = mu + mu^2/size\n")
+   size_estimate = (1/(v-m))*(m*m)
+   cat("Mu estimate=", m," Size estimate =", size_estimate, "\n")
+   deletion_propagation_coverage = suppressWarnings(qnbinom(deletion_propagation_pr_cutoff, size = size_estimate, mu = m))
+   if (is.na(deletion_propagation_coverage) || is.nan(deletion_propagation_coverage) || (deletion_propagation_coverage < 1)) {
+     cat("Double fallback to calculating as just 10% of the mean\n")
+     deletion_propagation_coverage = m * 0.1
+   }
+ }
280039.5   29.91139 
> 
> #Don't allow one read to indicate non-deleted regions
> if (deletion_propagation_coverage < 1) {
+     deletion_propagation_coverage = 1
+ }
> 
> #This works fine with the negative values
> #If we have both low fit coverage and low straight average coverage then we're deleted...
> if ( (nb_fit_mu <= 3) && (m <= 3) ) {
+   deletion_propagation_coverage = -1
+ }
> 
> #print out statistics
> 
> print(nb_fit_size);
[1] 280039.5
> print(nb_fit_mu);
[1] 29.91139
> 
> print(m)
[1] 29.66972
> print(v)
[1] 121.5402
> print(D)
[1] 4.096438
> 
> print(deletion_propagation_coverage)
[1] 16
> 
> warnings()
> 
