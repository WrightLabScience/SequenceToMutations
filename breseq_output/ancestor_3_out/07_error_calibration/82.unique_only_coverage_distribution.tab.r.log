
R version 4.3.1 (2023-06-16) -- "Beagle Scouts"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ##
> ##
> ## AUTHORS
> ##
> ## Jeffrey E. Barrick <jeffrey.e.barrick@gmail.com>
> ##
> ## LICENSE AND COPYRIGHT
> ##
> ## Copyright (c) 2008-2010 Michigan State University
> ## Copyright (c) 2011-2022 The University of Texas at Austin
> ##
> ## breseq is free software; you can redistribute it and/or modify it under the
> ## terms the GNU General Public License as published by the Free Software
> ## Foundation; either version 1, or (at your option) any later version.
> ##
> ##
> 
> ## Arguments:
> ##   distribution_file=/path/to/input 
> ##   plot_file=/path/to/output 
> ##   deletion_propagation_pr_cutoff=float
> ##   plot_poisson=0 or 1
> ##   pdf_output=0 or 1
> 
> ## Returns these values printed out to output log
> ## 
> ##  1. print(nb_fit_size); # 0 if fit failed
> ##  2. print(nb_fit_mu);   # 0 if fit failed
> ##  3. print(m)q
> ##  4. print(v)
> ##  5. print(D)
> ##  6. print(deletion_propagation_coverage)
> ##     -1 if it was <1 after fitting (implying reference sequence is deleted)
> ##
> 
> plot_poisson = 0;
> pdf_output = 1;
> 
> this.print.level = 0
> #this.print.level = 2
> 
> for (e in commandArgs(TRUE)) {
+   ta = strsplit(e,"=",fixed=TRUE)[[1]]
+   if(length(ta)>1) {
+     temp = ta[2]
+     assign(ta[1],temp)
+     cat("assigned ",ta[1]," the value of |",temp,"|\n")
+   } else {
+     assign(ta[[1]][1],TRUE)
+     cat("assigned ",ta[1]," the value of TRUE\n")
+   }
+ }
assigned  distribution_file  the value of | p3_out/07_error_calibration/82.unique_only_coverage_distribution.tab |
assigned  plot_file  the value of | p3_out/output/calibration/82.unique_coverage.pdf |
assigned  deletion_propagation_pr_cutoff  the value of | 0.0024544 |
> 
> deletion_propagation_pr_cutoff = as.numeric(deletion_propagation_pr_cutoff);
> 
> ## initialize values to be filled in
> nb_fit_mu = 0
> nb_fit_size = 0
> m = 0
> v = 0
> D = 0
> deletion_propagation_coverage = -1
> 
> min_fraction_included_in_nb_fit = 0.01
> 
> #load data
> X<-read.table(distribution_file, header=T)
> 
> #table might be empty
> if (nrow(X) == 0)
+ {
+   #print out statistics
+   
+   print(nb_fit_size);
+   print(nb_fit_mu);
+   
+   print(m)
+   print(v)
+   print(D)
+   
+   print(deletion_propagation_coverage)
+   
+   q()
+ }
> 
> #create the distribution vector and fit
> Y<-rep(X$coverage, X$n)
> m<-mean(Y)
> v<-var(Y)
> D<-v/m
> 
> ###
> ## Smooth the distribution with a moving average window of size 5
> ## so that we can more reliably find it's maximum value
> ###
> 
> ma5 = c(1, 1, 1, 1, 1)/5;
> 
> ## filtering fails if there are too few points
> if (nrow(X) >= 5) {
+   X$ma = filter(X$n, ma5)
+ } else {
+ 	X$ma = X$n
+ }
> 
> i<-0
> max_n <- 0;
> min_i <- max( trunc(m/4), 1 ); #prevents zero for pathological distributions
> max_i <- i;
> for (i in min_i:length(X$ma))
+ {		
+   #cat(i, "\n")
+ 	if (!is.na(X$ma[i]) && (X$ma[i] > max_n))
+ 	{
+ 		max_n = X$ma[i];
+ 		max_i = i;
+ 	}
+ }
> 
> ##
> # Censor data on the right and left of the maximum
> ##
> 
> start_i = max(floor(max_i*0.5), 1);
> end_i = min(ceiling(max_i*1.5), length(X$ma));
> 
> if (start_i == end_i)
+ {
+   print(nb_fit_size);
+   print(nb_fit_mu);
+   
+   print(m)
+   print(v)
+   print(D)
+   
+   print(deletion_propagation_coverage)
+   
+   q()
+ }
> 
> cat("Fitting from coverage of ", start_i, " to ", end_i, ".\n", sep="")
Fitting from coverage of 9 to 22.
> 
> ##
> # Coarse grain so that we are only fitting a number of bins that is 1000-2000
> #
> # The later adjustment for doing the fits this way is to multiply the means
> # of the negative binomial and poisson distributions by the binning number.
> # (The size parameter of the negative binomial doesn't need to be adjusted.)
> ##
> 
> 
> num_per_bin = trunc((end_i - start_i) / 1000)
> 
> if (num_per_bin > 1) 
+ {
+   cat("Coarse-graining for fits\n")
+   start_i_for_fits = trunc(start_i/num_per_bin)
+   end_i_for_fits = ceiling(end_i/num_per_bin)
+   num_bins = end_i - start_i  + 1
+   cat("Fitting from coverage in adjusted bins ", start_i_for_fits, " to ", end_i_for_fits, ".\n", sep="")
+   cat("Number of bins ", num_bins, ". Each bin has ", num_per_bin, " coverage values.\n", sep="")
+ 
+   # Create a new vector where we've added together values in bins
+   X.for.fits = vector("double", end_i_for_fits)
+   for (i in start_i_for_fits:end_i_for_fits)
+   {
+     for (j in 1:num_per_bin)
+     {
+       if (i*num_per_bin+j <= length(X$n))
+       {
+         X.for.fits[i] = X.for.fits[i] + X$n[i*num_per_bin+j]
+       }
+     }
+   }
+ 
+ } else {
+   ## AVOID num_per_bin equalling zero!!
+   X.for.fits = X$n[1:end_i]
+   num_per_bin = 1
+   start_i_for_fits = start_i
+   end_i_for_fits = end_i
+ }
> 
> 
> ##
> # Now perform negative binomial fitting to the censored data
> ##
> 
> inner_total<-0;
> for (i in start_i_for_fits:end_i_for_fits)
+ {
+ 	inner_total = inner_total + X.for.fits[i]; 
+ }
> # Yes: it's correct to use X here because we want the overall total total
> total_total<-sum(X$n);
> 
> ## let's preconstruct these for speed
> dist = vector("double", end_i_for_fits)
> 
> f_nb <- function(par) {
+ 
+ 	mu = par[1];
+ 	size = par[2];
+ 
+   if ((mu <= 0) || (size <= 0))
+   {
+     return(0);
+   }
+   
+   cat(start_i_for_fits, " ", end_i_for_fits, "\n");
+   cat(mu, " ", size, "\n");
+   
+ 	dist<-c()
+ 	total <- 0;
+ 	for (i in start_i_for_fits:end_i_for_fits)
+ 	{	
+ 		dist[i] <- dnbinom(i, size=size, mu=mu);
+ 		total <- total + dist[i] 
+ 	}
+ 	#print (mu, size)
+ 
+  	l <- 0;
+ 	for (i in start_i_for_fits:end_i_for_fits)
+ 	{
+ 		l <- l + ((X.for.fits[i]/inner_total)-(dist[i]/total))^2;
+ 	}
+ 	return(l);
+ }
> 
> 
> 
> ## Fit negative binomial 
> ## - allow fit to fail and set all params to zero/empty if that is the case
> nb_fit = NULL
> ## as.numeric prevents overflow in sums involving integers
> mean_estimate = sum((as.numeric(1:end_i_for_fits)*as.numeric(X.for.fits)))/sum(as.numeric(X.for.fits))
> 
> nb_fit_mu = -1
> nb_fit_size = -1
> try_size = 100000
> try_means_index = 1
> #This is a list of different means to test <-  sometimes the actual mean doesn't lead to a fit
> try_means = c(mean_estimate, 
+               end_i_for_fits, 
+               start_i_for_fits, 
+               1*(end_i_for_fits + start_i_for_fits)/4,
+               2*(end_i_for_fits + start_i_for_fits)/4,
+               3*(end_i_for_fits + start_i_for_fits)/4
+               )
>               
>               
> nb_fit = c()
> 
> while ( ((nb_fit_mu < 0) || (nb_fit_size < 0) || (nb_fit$code != 1)) && (try_size > 0.001) && (try_means_index <= length(try_means)))
+ {
+   try_size = try_size / 10
+   try_mean = try_means[try_means_index]
+ 
+   ## SIZE ESTIMATE from the censored data can be negative, so try various values instead
+   cat("Try Mean: ", try_mean, " Size: ", try_size, "\n")
+ 
+   try( suppressWarnings(nb_fit<-nlm(f_nb, c(try_mean, try_size), iterlim=1000, print.level=this.print.level)) )
+ 
+   nb_fit_mu = nb_fit$estimate[1];
+   nb_fit_size = nb_fit$estimate[2];
+ 
+   cat("Fit Mean: ", nb_fit_mu, " Size: ", nb_fit_size, " Code: ", nb_fit$code, "\n")
+   
+   if (try_size <= 0.001) {
+     try_size = 100000
+     try_means_index = try_means_index + 1
+   }
+ }
Try Mean:  16.80309  Size:  10000 
9   22 
16.80309   10000 
9   22 
16.80309   10000 
9   22 
16.80311   10000 
9   22 
16.80309   10000.01 
9   22 
16.82132   10000 
9   22 
16.82133   10000 
9   22 
16.82132   10000.01 
9   22 
21.20111   10000 
9   22 
21.20113   10000 
9   22 
21.20111   10000.01 
9   22 
20.7447   10000 
9   22 
20.74472   10000 
9   22 
20.7447   10000.01 
9   22 
20.68487   10000 
9   22 
20.68489   10000 
9   22 
20.68487   10000.01 
9   22 
20.68702   10000 
9   22 
20.68704   10000 
9   22 
20.68702   10000.01 
9   22 
20.68701   10000 
9   22 
20.68909   10000 
9   22 
20.68495   10000 
9   22 
20.68702   10001 
9   22 
20.68702   9999 
9   22 
20.68702   10000 
9   22 
20.68909   10000 
9   22 
20.68496   10000 
9   22 
20.68702   10001 
9   22 
20.68702   9999 
Fit Mean:  20.68702  Size:  10000  Code:  2 
Try Mean:  16.80309  Size:  1000 
9   22 
16.80309   1000 
9   22 
16.80309   1000 
9   22 
16.80311   1000 
9   22 
16.80309   1000.001 
9   22 
16.82108   1000 
9   22 
16.82109   1000 
9   22 
16.82108   1000.001 
9   22 
21.20814   1000 
9   22 
21.20816   1000 
9   22 
21.20814   1000.001 
9   22 
20.79471   1000 
9   22 
20.79473   1000 
9   22 
20.79471   1000.001 
9   22 
20.73693   1000 
9   22 
20.73695   1000 
9   22 
20.73693   1000.001 
9   22 
20.73886   1000.001 
9   22 
20.73888   1000.001 
9   22 
20.73886   1000.002 
9   22 
20.73885   1000.001 
9   22 
20.73887   1000.001 
9   22 
20.73885   1000.002 
Fit Mean:  20.73885  Size:  1000.001  Code:  2 
Try Mean:  16.80309  Size:  100 
9   22 
16.80309   100 
9   22 
16.80309   100 
9   22 
16.80311   100 
9   22 
16.80309   100.0001 
9   22 
16.81903   100 
9   22 
16.81905   100 
9   22 
16.81903   100.0001 
9   22 
21.29829   100.0342 
9   22 
21.29831   100.0342 
9   22 
21.29829   100.0343 
9   22 
21.28539   100.0406 
9   22 
21.28541   100.0406 
9   22 
21.28539   100.0407 
9   22 
21.27829   100.0523 
9   22 
21.27831   100.0523 
9   22 
21.27829   100.0524 
9   22 
21.26866   100.0874 
9   22 
21.26868   100.0874 
9   22 
21.26866   100.0875 
9   22 
21.25156   100.2017 
9   22 
21.25158   100.2017 
9   22 
21.25156   100.2018 
9   22 
21.22411   100.5163 
9   22 
21.22413   100.5163 
9   22 
21.22411   100.5164 
9   22 
21.17825   101.3772 
9   22 
21.17827   101.3772 
9   22 
21.17825   101.3773 
9   22 
21.1043   103.599 
9   22 
21.10432   103.599 
9   22 
21.1043   103.5991 
9   22 
20.9931   108.9709 
9   22 
20.99312   108.9709 
9   22 
20.9931   108.971 
9   22 
20.85501   120.4923 
9   22 
20.85503   120.4923 
9   22 
20.85501   120.4924 
9   22 
20.73594   142.5522 
9   22 
20.73596   142.5522 
9   22 
20.73594   142.5524 
9   22 
20.71529   181.7467 
9   22 
20.71531   181.7467 
9   22 
20.71529   181.7469 
9   22 
20.81609   238.4331 
9   22 
20.81611   238.4331 
9   22 
20.81609   238.4333 
9   22 
20.87442   306.0578 
9   22 
20.87444   306.0578 
9   22 
20.87442   306.0581 
9   22 
20.85596   400.2049 
9   22 
20.85598   400.2049 
9   22 
20.85596   400.2053 
9   22 
20.78317   541.0403 
9   22 
20.78319   541.0403 
9   22 
20.78317   541.0409 
9   22 
20.72278   717.8226 
9   22 
20.7228   717.8226 
9   22 
20.72278   717.8233 
9   22 
20.69869   942.2868 
9   22 
20.69871   942.2868 
9   22 
20.69869   942.2877 
9   22 
20.70025   1245.612 
9   22 
20.70027   1245.612 
9   22 
20.70025   1245.613 
9   22 
20.70648   1645.644 
9   22 
20.7065   1645.644 
9   22 
20.70648   1645.646 
9   22 
20.70541   2176.91 
9   22 
20.70543   2176.91 
9   22 
20.70541   2176.912 
9   22 
20.69855   2887.491 
9   22 
20.69857   2887.491 
9   22 
20.69855   2887.494 
9   22 
20.69167   3828.396 
9   22 
20.69169   3828.396 
9   22 
20.69167   3828.399 
9   22 
20.68774   5071.525 
9   22 
20.68776   5071.525 
9   22 
20.68774   5071.53 
9   22 
20.68626   6717.665 
9   22 
20.68628   6717.665 
9   22 
20.68626   6717.672 
9   22 
20.68564   8898.284 
9   22 
20.68566   8898.284 
9   22 
20.68564   8898.293 
9   22 
20.68492   11787.48 
9   22 
20.68494   11787.48 
9   22 
20.68492   11787.5 
9   22 
20.68403   15616.16 
9   22 
20.68405   15616.16 
9   22 
20.68403   15616.18 
9   22 
20.68323   20690.04 
9   22 
20.68325   20690.04 
9   22 
20.68323   20690.06 
9   22 
20.68267   27409.09 
9   22 
20.68269   27409.09 
9   22 
20.68267   27409.12 
9   22 
20.68233   36312.15 
9   22 
20.68235   36312.15 
9   22 
20.68233   36312.19 
9   22 
20.6821   48094.48 
9   22 
20.68212   48094.48 
9   22 
20.6821   48094.53 
9   22 
20.68192   63707.12 
9   22 
20.68194   63707.12 
9   22 
20.68192   63707.18 
9   22 
20.68176   84416.73 
9   22 
20.68178   84416.73 
9   22 
20.68176   84416.81 
9   22 
20.68164   111805.2 
9   22 
20.68166   111805.2 
9   22 
20.68164   111805.3 
9   22 
20.68155   148135.6 
9   22 
20.68157   148135.6 
9   22 
20.68155   148135.8 
9   22 
20.68148   196398.1 
9   22 
20.6815   196398.1 
9   22 
20.68148   196398.3 
9   22 
20.68144   259138.5 
9   22 
20.68146   259138.5 
9   22 
20.68144   259138.8 
9   22 
20.6814   340882.4 
9   22 
20.68142   340882.4 
9   22 
20.6814   340882.7 
9   22 
20.68137   442284.3 
9   22 
20.68139   442284.3 
9   22 
20.68137   442284.7 
9   22 
20.68136   543686.2 
9   22 
20.68138   543686.2 
9   22 
20.68136   543686.7 
9   22 
20.68134   645088.1 
9   22 
20.68137   645088.1 
9   22 
20.68134   645088.7 
9   22 
20.68134   746489.9 
9   22 
20.68136   746489.9 
9   22 
20.68134   746490.7 
9   22 
20.68133   847891.8 
9   22 
20.68135   847891.8 
9   22 
20.68133   847892.7 
Fit Mean:  20.68133  Size:  847891.8  Code:  5 
Try Mean:  16.80309  Size:  10 
9   22 
16.80309   10 
9   22 
16.80309   10 
9   22 
16.80311   10 
9   22 
16.80309   10.00001 
9   22 
16.81129   10.00088 
9   22 
16.8113   10.00088 
9   22 
16.81129   10.00089 
9   22 
23.51322   13.1219 
9   22 
23.51325   13.1219 
9   22 
23.51322   13.12192 
9   22 
25.72089   14.89469 
9   22 
25.72092   14.89469 
9   22 
25.72089   14.8947 
9   22 
26.10571   15.41601 
9   22 
26.10573   15.41601 
9   22 
26.10571   15.41603 
9   22 
26.14058   15.75706 
9   22 
26.1406   15.75706 
9   22 
26.14058   15.75708 
9   22 
25.88733   17.63498 
9   22 
25.88735   17.63498 
9   22 
25.88733   17.635 
9   22 
24.16791   24.74544 
9   22 
24.16794   24.74544 
9   22 
24.16791   24.74546 
9   22 
22.24605   32.58475 
9   22 
22.24607   32.58475 
9   22 
22.24605   32.58479 
9   22 
22.02351   35.09753 
9   22 
22.02353   35.09753 
9   22 
22.02351   35.09757 
9   22 
21.76222   50.24697 
9   22 
21.76224   50.24697 
9   22 
21.76222   50.24702 
9   22 
21.41109   65.58338 
9   22 
21.41112   65.58338 
9   22 
21.41109   65.58345 
9   22 
21.3794   90.18048 
9   22 
21.37943   90.18048 
9   22 
21.3794   90.18057 
9   22 
20.78183   127.4137 
9   22 
20.78185   127.4137 
9   22 
20.78183   127.4139 
9   22 
20.96954   158.0103 
9   22 
20.96956   158.0103 
9   22 
20.96954   158.0104 
9   22 
20.9315   209.6789 
9   22 
20.93152   209.6789 
9   22 
20.9315   209.6791 
9   22 
20.83621   280.9597 
9   22 
20.83623   280.9597 
9   22 
20.83621   280.96 
9   22 
20.80266   373.9045 
9   22 
20.80268   373.9045 
9   22 
20.80266   373.9049 
9   22 
20.77149   496.4521 
9   22 
20.77151   496.4521 
9   22 
20.77149   496.4526 
9   22 
20.75078   659.4463 
9   22 
20.7508   659.4463 
9   22 
20.75078   659.447 
9   22 
20.7328   875.2309 
9   22 
20.73282   875.2309 
9   22 
20.7328   875.2317 
9   22 
20.7212   1161.286 
9   22 
20.72122   1161.286 
9   22 
20.7212   1161.287 
9   22 
20.71048   1540.303 
9   22 
20.7105   1540.303 
9   22 
20.71048   1540.304 
9   22 
20.70436   2042.378 
9   22 
20.70438   2042.378 
9   22 
20.70436   2042.38 
9   22 
20.6976   2707.728 
9   22 
20.69762   2707.728 
9   22 
20.6976   2707.731 
9   22 
20.69486   3588.92 
9   22 
20.69488   3588.92 
9   22 
20.69486   3588.924 
9   22 
20.6901   4756.889 
9   22 
20.69012   4756.889 
9   22 
20.6901   4756.894 
9   22 
20.68959   6303.703 
9   22 
20.68961   6303.703 
9   22 
20.68959   6303.71 
9   22 
20.68564   8354.639 
9   22 
20.68566   8354.639 
9   22 
20.68564   8354.647 
9   22 
20.68679   11071.54 
9   22 
20.68681   11071.54 
9   22 
20.68679   11071.55 
9   22 
20.68289   14677.63 
9   22 
20.68291   14677.63 
9   22 
20.68289   14677.64 
9   22 
20.68533   19459.28 
9   22 
20.68535   19459.28 
9   22 
20.68533   19459.3 
9   22 
20.68129   25812.16 
9   22 
20.68132   25812.16 
9   22 
20.68129   25812.19 
9   22 
20.68428   34249.01 
9   22 
20.6843   34249.01 
9   22 
20.68428   34249.05 
9   22 
20.68088   45437.21 
9   22 
20.6809   45437.21 
9   22 
20.68088   45437.26 
9   22 
20.68305   60305.82 
9   22 
20.68307   60305.82 
9   22 
20.68305   60305.88 
9   22 
20.68118   79859.44 
9   22 
20.6812   79859.44 
9   22 
20.68118   79859.52 
9   22 
20.68187   99413.05 
9   22 
20.68189   99413.05 
9   22 
20.68187   99413.15 
9   22 
20.68161   118966.7 
9   22 
20.68163   118966.7 
9   22 
20.68161   118966.8 
9   22 
20.68162   138520.3 
9   22 
20.68164   138520.3 
9   22 
20.68162   138520.4 
9   22 
20.68157   158073.9 
9   22 
20.68159   158073.9 
9   22 
20.68157   158074 
Fit Mean:  20.68157  Size:  158073.9  Code:  5 
Try Mean:  16.80309  Size:  1 
9   22 
16.80309   1 
9   22 
16.80309   1 
9   22 
16.80311   1 
9   22 
16.80309   1.000001 
9   22 
16.8047   1.004735 
9   22 
16.80472   1.004735 
9   22 
16.8047   1.004736 
9   22 
220.5431   353.1165 
9   22 
91.14481   129.4833 
9   22 
35.60979   33.5047 
9   22 
35.60982   33.5047 
9   22 
35.60979   33.50473 
9   22 
26.35145   18.1775 
9   22 
26.35148   18.1775 
9   22 
26.35145   18.17752 
9   22 
25.18925   16.34617 
9   22 
25.18927   16.34617 
9   22 
25.18925   16.34619 
9   22 
25.62196   17.12279 
9   22 
25.62199   17.12279 
9   22 
25.62196   17.12281 
9   22 
25.61693   17.21976 
9   22 
25.61696   17.21976 
9   22 
25.61693   17.21978 
9   22 
24.62014   22.56835 
9   22 
24.62016   22.56835 
9   22 
24.62014   22.56837 
9   22 
11.20477   84.1587 
9   22 
23.2786   28.72739 
9   22 
23.27863   28.72739 
9   22 
23.2786   28.72741 
9   22 
15.88503   65.67766 
9   22 
22.53925   32.42241 
9   22 
22.53927   32.42241 
9   22 
22.53925   32.42245 
9   22 
21.61581   38.5022 
9   22 
21.61583   38.5022 
9   22 
21.61581   38.50224 
9   22 
21.84355   38.73665 
9   22 
21.84357   38.73665 
9   22 
21.84355   38.73669 
9   22 
22.10783   45.8208 
9   22 
22.10785   45.8208 
9   22 
22.10783   45.82085 
9   22 
21.88678   57.81039 
9   22 
21.8868   57.81039 
9   22 
21.88678   57.81045 
9   22 
21.01817   88.40303 
9   22 
21.01819   88.40303 
9   22 
21.01817   88.40312 
9   22 
21.02156   104.0556 
9   22 
21.02159   104.0556 
9   22 
21.02156   104.0557 
9   22 
21.04558   141.8303 
9   22 
21.0456   141.8303 
9   22 
21.04558   141.8304 
9   22 
20.87819   188.8817 
9   22 
20.87821   188.8817 
9   22 
20.87819   188.8819 
9   22 
20.91869   253.613 
9   22 
20.91871   253.613 
9   22 
20.91869   253.6132 
9   22 
20.77222   341.8995 
9   22 
20.77224   341.8995 
9   22 
20.77222   341.8998 
9   22 
20.78859   454.0517 
9   22 
20.78861   454.0517 
9   22 
20.78859   454.0521 
9   22 
20.75069   602.272 
9   22 
20.75071   602.272 
9   22 
20.75069   602.2726 
9   22 
20.73956   800.2067 
9   22 
20.73958   800.2067 
9   22 
20.73956   800.2075 
9   22 
20.72203   1061.203 
9   22 
20.72205   1061.203 
9   22 
20.72203   1061.204 
9   22 
20.7143   1407.855 
9   22 
20.71432   1407.855 
9   22 
20.7143   1407.856 
9   22 
20.70462   1866.631 
9   22 
20.70464   1866.631 
9   22 
20.70462   1866.633 
9   22 
20.70015   2474.695 
9   22 
20.70018   2474.695 
9   22 
20.70015   2474.697 
9   22 
20.69454   3280.133 
9   22 
20.69456   3280.133 
9   22 
20.69454   3280.136 
9   22 
20.69212   4347.17 
9   22 
20.69214   4347.17 
9   22 
20.69212   4347.174 
9   22 
20.68877   5760.766 
9   22 
20.68879   5760.766 
9   22 
20.68877   5760.772 
9   22 
20.68753   7633.26 
9   22 
20.68755   7633.26 
9   22 
20.68753   7633.267 
9   22 
20.68549   10114.23 
9   22 
20.68551   10114.23 
9   22 
20.68549   10114.24 
9   22 
20.6849   13400.5 
9   22 
20.68493   13400.5 
9   22 
20.6849   13400.51 
9   22 
20.68362   17753.82 
9   22 
20.68364   17753.82 
9   22 
20.68362   17753.84 
9   22 
20.6834   23520.99 
9   22 
20.68342   23520.99 
9   22 
20.6834   23521.01 
9   22 
20.68257   31164.93 
9   22 
20.68259   31164.93 
9   22 
20.68257   31164.96 
9   22 
20.68253   41280.68 
9   22 
20.68255   41280.68 
9   22 
20.68253   41280.72 
9   22 
20.68198   54700.87 
9   22 
20.682   54700.87 
9   22 
20.68198   54700.92 
9   22 
20.68202   71533.69 
9   22 
20.68204   71533.69 
9   22 
20.68202   71533.76 
9   22 
20.68176   88366.51 
9   22 
20.68178   88366.51 
9   22 
20.68176   88366.59 
9   22 
20.68174   105199.3 
9   22 
20.68176   105199.3 
9   22 
20.68174   105199.4 
9   22 
20.68166   122032.1 
9   22 
20.68168   122032.1 
9   22 
20.68166   122032.3 
9   22 
20.68163   138865 
9   22 
20.68165   138865 
9   22 
20.68163   138865.1 
Fit Mean:  20.68163  Size:  138865  Code:  5 
Try Mean:  16.80309  Size:  0.1 
9   22 
16.80309   0.1 
9   22 
16.80309   0.1 
9   22 
16.80311   0.1 
9   22 
16.80309   0.100001 
9   22 
16.80327   0.1061189 
9   22 
16.80329   0.1061189 
9   22 
16.80327   0.1061199 
9   22 
20.77917   7.511616 
9   22 
20.77919   7.511616 
9   22 
20.77917   7.511624 
9   22 
36.94409   31.48248 
9   22 
26.95883   16.6754 
9   22 
26.95886   16.6754 
9   22 
26.95883   16.67542 
9   22 
26.21879   15.69386 
9   22 
26.21881   15.69386 
9   22 
26.21879   15.69387 
9   22 
26.15666   15.7119 
9   22 
26.15669   15.7119 
9   22 
26.15666   15.71191 
9   22 
24.63408   17.07488 
9   22 
24.63411   17.07488 
9   22 
24.63408   17.0749 
9   22 
23.98138   18.53717 
9   22 
23.9814   18.53717 
9   22 
23.98138   18.53719 
9   22 
22.6283   24.49023 
9   22 
22.62832   24.49023 
9   22 
22.6283   24.49025 
9   22 
22.59724   30.63206 
9   22 
22.59727   30.63206 
9   22 
22.59724   30.63209 
9   22 
21.73838   42.5225 
9   22 
21.7384   42.5225 
9   22 
21.73838   42.52254 
9   22 
21.85831   57.44458 
9   22 
21.85833   57.44458 
9   22 
21.85831   57.44464 
9   22 
20.95839   82.83516 
9   22 
20.95841   82.83516 
9   22 
20.95839   82.83524 
9   22 
21.11899   97.64987 
9   22 
21.11901   97.64987 
9   22 
21.11899   97.64997 
9   22 
21.04279   134.3162 
9   22 
21.04281   134.3162 
9   22 
21.04279   134.3163 
9   22 
20.93754   176.925 
9   22 
20.93756   176.925 
9   22 
20.93754   176.9251 
9   22 
20.89322   237.2261 
9   22 
20.89324   237.2261 
9   22 
20.89322   237.2263 
9   22 
20.81344   316.052 
9   22 
20.81346   316.052 
9   22 
20.81344   316.0523 
9   22 
20.82268   421.5492 
9   22 
20.82271   421.5492 
9   22 
20.82268   421.5496 
9   22 
20.72175   567.3657 
9   22 
20.72177   567.3657 
9   22 
20.72175   567.3662 
9   22 
20.76961   759.4186 
9   22 
20.76963   759.4186 
9   22 
20.76961   759.4194 
9   22 
20.71823   1008.894 
9   22 
20.71825   1008.894 
9   22 
20.71823   1008.895 
9   22 
20.71319   1340.305 
9   22 
20.71321   1340.305 
9   22 
20.71319   1340.306 
9   22 
20.70586   1774.411 
9   22 
20.70588   1774.411 
9   22 
20.70586   1774.413 
9   22 
20.69985   2353.216 
9   22 
20.69987   2353.216 
9   22 
20.69985   2353.218 
9   22 
20.69533   3118.273 
9   22 
20.69535   3118.273 
9   22 
20.69533   3118.276 
9   22 
20.69189   4132.677 
9   22 
20.69191   4132.677 
9   22 
20.69189   4132.681 
9   22 
20.6893   5476.067 
9   22 
20.68932   5476.067 
9   22 
20.6893   5476.072 
9   22 
20.68733   7255.886 
9   22 
20.68735   7255.886 
9   22 
20.68733   7255.893 
9   22 
20.68585   9613.578 
9   22 
20.68587   9613.578 
9   22 
20.68585   9613.588 
9   22 
20.68473   12737.07 
9   22 
20.68475   12737.07 
9   22 
20.68473   12737.08 
9   22 
20.68389   16874.05 
9   22 
20.68391   16874.05 
9   22 
20.68389   16874.07 
9   22 
20.68325   22356.07 
9   22 
20.68327   22356.07 
9   22 
20.68325   22356.1 
9   22 
20.68277   29615.47 
9   22 
20.68279   29615.47 
9   22 
20.68277   29615.5 
9   22 
20.6824   39239.8 
9   22 
20.68242   39239.8 
9   22 
20.6824   39239.84 
9   22 
20.68213   51980.64 
9   22 
20.68215   51980.64 
9   22 
20.68213   51980.69 
9   22 
20.68192   68784.02 
9   22 
20.68194   68784.02 
9   22 
20.68192   68784.09 
9   22 
20.6818   85587.41 
9   22 
20.68182   85587.41 
9   22 
20.6818   85587.49 
9   22 
20.68173   102390.8 
9   22 
20.68175   102390.8 
9   22 
20.68173   102390.9 
9   22 
20.68167   119194.2 
9   22 
20.68169   119194.2 
9   22 
20.68167   119194.3 
9   22 
20.68162   135997.6 
9   22 
20.68164   135997.6 
9   22 
20.68162   135997.7 
Fit Mean:  20.68162  Size:  135997.6  Code:  5 
Try Mean:  16.80309  Size:  0.01 
9   22 
16.80309   0.01 
9   22 
16.80309   0.01 
9   22 
16.80311   0.01 
9   22 
16.80309   0.010001 
9   22 
16.80311   0.01628687 
9   22 
16.80312   0.01628687 
9   22 
16.80311   0.01628787 
9   22 
20.03243   6.426441 
9   22 
20.03245   6.426441 
9   22 
20.03243   6.426447 
9   22 
38.95286   35.68915 
9   22 
27.134   17.40986 
9   22 
27.13402   17.40986 
9   22 
27.134   17.40988 
9   22 
26.09967   15.93048 
9   22 
26.0997   15.93048 
9   22 
26.09967   15.9305 
9   22 
26.06319   15.97041 
9   22 
26.06322   15.97041 
9   22 
26.06319   15.97042 
9   22 
18.399   27.80354 
9   22 
25.15128   17.37835 
9   22 
25.15131   17.37835 
9   22 
25.15128   17.37837 
9   22 
18.88896   29.14861 
9   22 
24.35648   18.87222 
9   22 
24.3565   18.87222 
9   22 
24.35648   18.87224 
9   22 
21.99501   24.64265 
9   22 
21.99503   24.64265 
9   22 
21.99501   24.64267 
9   22 
23.33612   22.65418 
9   22 
23.33615   22.65418 
9   22 
23.33612   22.65421 
9   22 
23.23722   24.40569 
9   22 
23.23725   24.40569 
9   22 
23.23722   24.40572 
9   22 
22.1237   36.14763 
9   22 
22.12372   36.14763 
9   22 
22.1237   36.14767 
9   22 
21.7235   46.92523 
9   22 
21.72352   46.92523 
9   22 
21.7235   46.92528 
9   22 
21.70589   63.24987 
9   22 
21.70591   63.24987 
9   22 
21.70589   63.24993 
9   22 
20.72739   93.47711 
9   22 
20.72741   93.47711 
9   22 
20.72739   93.47721 
9   22 
21.1331   105.9487 
9   22 
21.13312   105.9487 
9   22 
21.1331   105.9488 
9   22 
21.14055   135.6203 
9   22 
21.14057   135.6203 
9   22 
21.14055   135.6204 
9   22 
20.94309   185.6823 
9   22 
20.94311   185.6823 
9   22 
20.94309   185.6825 
9   22 
20.83177   247.9249 
9   22 
20.8318   247.9249 
9   22 
20.83177   247.9251 
9   22 
20.81104   328.2859 
9   22 
20.81106   328.2859 
9   22 
20.81104   328.2862 
9   22 
20.78452   435.2796 
9   22 
20.78454   435.2796 
9   22 
20.78452   435.28 
9   22 
20.75806   578.2795 
9   22 
20.75808   578.2795 
9   22 
20.75806   578.2801 
9   22 
20.74013   767.5092 
9   22 
20.74015   767.5092 
9   22 
20.74013   767.5099 
9   22 
20.7253   1018.422 
9   22 
20.72532   1018.422 
9   22 
20.7253   1018.423 
9   22 
20.71492   1350.837 
9   22 
20.71494   1350.837 
9   22 
20.71492   1350.838 
9   22 
20.70641   1791.284 
9   22 
20.70643   1791.284 
9   22 
20.70641   1791.286 
9   22 
20.70052   2374.779 
9   22 
20.70054   2374.779 
9   22 
20.70052   2374.781 
9   22 
20.69559   3147.808 
9   22 
20.69561   3147.808 
9   22 
20.69559   3147.812 
9   22 
20.69229   4171.852 
9   22 
20.69231   4171.852 
9   22 
20.69229   4171.857 
9   22 
20.68941   5528.487 
9   22 
20.68943   5528.487 
9   22 
20.68941   5528.493 
9   22 
20.68759   7325.626 
9   22 
20.68762   7325.626 
9   22 
20.68759   7325.633 
9   22 
20.68588   9706.378 
9   22 
20.6859   9706.378 
9   22 
20.68588   9706.388 
9   22 
20.68492   12860.15 
9   22 
20.68494   12860.15 
9   22 
20.68492   12860.17 
9   22 
20.68387   17038.14 
9   22 
20.68389   17038.14 
9   22 
20.68387   17038.16 
9   22 
20.68339   22571.36 
9   22 
20.68341   22571.36 
9   22 
20.68339   22571.38 
9   22 
20.68272   29904.58 
9   22 
20.68274   29904.58 
9   22 
20.68272   29904.61 
9   22 
20.68252   39618.21 
9   22 
20.68254   39618.21 
9   22 
20.68252   39618.25 
9   22 
20.68207   52491.83 
9   22 
20.68209   52491.83 
9   22 
20.68207   52491.88 
9   22 
20.68202   69294.92 
9   22 
20.68204   69294.92 
9   22 
20.68202   69294.99 
9   22 
20.68178   86098.01 
9   22 
20.6818   86098.01 
9   22 
20.68178   86098.1 
9   22 
20.68176   102901.1 
9   22 
20.68178   102901.1 
9   22 
20.68176   102901.2 
9   22 
20.68167   119704.2 
9   22 
20.68169   119704.2 
9   22 
20.68167   119704.3 
9   22 
20.68163   136507.3 
9   22 
20.68166   136507.3 
9   22 
20.68163   136507.4 
Fit Mean:  20.68163  Size:  136507.3  Code:  5 
Try Mean:  16.80309  Size:  0.001 
9   22 
16.80309   0.001 
9   22 
16.80309   0.001 
9   22 
16.80311   0.001 
9   22 
16.80309   0.001001 
9   22 
16.80309   0.007304008 
9   22 
16.80311   0.007304008 
9   22 
16.80309   0.007305008 
9   22 
19.96756   6.331898 
9   22 
19.96758   6.331898 
9   22 
19.96756   6.331904 
9   22 
39.00635   35.90864 
9   22 
27.13108   17.46042 
9   22 
27.13111   17.46042 
9   22 
27.13108   17.46044 
9   22 
26.08543   15.95675 
9   22 
26.08545   15.95675 
9   22 
26.08543   15.95677 
9   22 
26.05172   15.99978 
9   22 
26.05175   15.99978 
9   22 
26.05172   15.9998 
9   22 
14.14914   35.87358 
9   22 
24.86146   17.98716 
9   22 
24.86149   17.98716 
9   22 
24.86146   17.98718 
9   22 
19.25132   29.45438 
9   22 
24.07047   19.60396 
9   22 
24.0705   19.60396 
9   22 
24.07047   19.60398 
9   22 
22.26091   24.72047 
9   22 
22.26093   24.72047 
9   22 
22.26091   24.7205 
9   22 
22.95898   24.4262 
9   22 
22.959   24.4262 
9   22 
22.95898   24.42623 
9   22 
23.08007   27.91426 
9   22 
23.08009   27.91426 
9   22 
23.08007   27.91428 
9   22 
22.50428   36.98096 
9   22 
22.5043   36.98096 
9   22 
22.50428   36.981 
9   22 
20.99667   56.96325 
9   22 
20.99669   56.96325 
9   22 
20.99667   56.9633 
9   22 
21.52656   60.06546 
9   22 
21.52659   60.06546 
9   22 
21.52656   60.06552 
9   22 
21.51811   75.7711 
9   22 
21.51814   75.7711 
9   22 
21.51811   75.77118 
9   22 
21.1428   105.5217 
9   22 
21.14282   105.5217 
9   22 
21.1428   105.5218 
9   22 
20.93914   141.3496 
9   22 
20.93916   141.3496 
9   22 
20.93914   141.3497 
9   22 
20.92973   186.671 
9   22 
20.92975   186.671 
9   22 
20.92973   186.6712 
9   22 
20.86056   248.2822 
9   22 
20.86059   248.2822 
9   22 
20.86056   248.2824 
9   22 
20.82526   330.4381 
9   22 
20.82528   330.4381 
9   22 
20.82526   330.4385 
9   22 
20.782   439.5195 
9   22 
20.78202   439.5195 
9   22 
20.782   439.52 
9   22 
20.76725   584.045 
9   22 
20.76727   584.045 
9   22 
20.76725   584.0456 
9   22 
20.73306   776.5914 
9   22 
20.73308   776.5914 
9   22 
20.73306   776.5922 
9   22 
20.73821   1031.521 
9   22 
20.73823   1031.521 
9   22 
20.73821   1031.522 
9   22 
20.6997   1375.193 
9   22 
20.69972   1375.193 
9   22 
20.6997   1375.195 
9   22 
20.72171   1832.86 
9   22 
20.72173   1832.86 
9   22 
20.72171   1832.862 
9   22 
20.68961   2444.441 
9   22 
20.68963   2444.441 
9   22 
20.68961   2444.444 
9   22 
20.69791   3241.997 
9   22 
20.69793   3241.997 
9   22 
20.69791   3242 
9   22 
20.69048   4295.03 
9   22 
20.6905   4295.03 
9   22 
20.69048   4295.035 
9   22 
20.68931   5693.508 
9   22 
20.68933   5693.508 
9   22 
20.68931   5693.513 
9   22 
20.68698   7542.327 
9   22 
20.687   7542.327 
9   22 
20.68698   7542.335 
9   22 
20.68571   9994.071 
9   22 
20.68574   9994.071 
9   22 
20.68571   9994.081 
9   22 
20.68458   13240.2 
9   22 
20.6846   13240.2 
9   22 
20.68458   13240.21 
9   22 
20.68379   17541.01 
9   22 
20.68381   17541.01 
9   22 
20.68379   17541.02 
9   22 
20.68317   23239.26 
9   22 
20.68319   23239.26 
9   22 
20.68317   23239.29 
9   22 
20.68271   30787.56 
9   22 
20.68273   30787.56 
9   22 
20.68271   30787.59 
9   22 
20.68236   40787.47 
9   22 
20.68238   40787.47 
9   22 
20.68236   40787.51 
9   22 
20.6821   54024.44 
9   22 
20.68212   54024.44 
9   22 
20.6821   54024.49 
9   22 
20.6819   70827.53 
9   22 
20.68193   70827.53 
9   22 
20.6819   70827.6 
9   22 
20.68179   87630.62 
9   22 
20.68181   87630.62 
9   22 
20.68179   87630.71 
9   22 
20.68172   104433.7 
9   22 
20.68174   104433.7 
9   22 
20.68172   104433.8 
9   22 
20.68166   121236.8 
9   22 
20.68168   121236.8 
9   22 
20.68166   121236.9 
9   22 
20.68162   138039.9 
9   22 
20.68164   138039.9 
9   22 
20.68162   138040 
Fit Mean:  20.68162  Size:  138039.9  Code:  5 
Try Mean:  22  Size:  10000 
9   22 
22   10000 
9   22 
22   10000 
9   22 
22.00002   10000 
9   22 
22   10000.01 
9   22 
21.99493   10000 
9   22 
21.99496   10000 
9   22 
21.99493   10000.01 
9   22 
20.52768   10000 
9   22 
20.5277   10000 
9   22 
20.52768   10000.01 
9   22 
20.70317   10000 
9   22 
20.70319   10000 
9   22 
20.70317   10000.01 
9   22 
20.68718   10000 
9   22 
20.6872   10000 
9   22 
20.68718   10000.01 
9   22 
20.68701   10000 
9   22 
20.68703   10000 
9   22 
20.68701   10000.01 
9   22 
20.68701   10000 
9   22 
20.68703   10000 
9   22 
20.68701   10000.01 
Fit Mean:  20.68701  Size:  10000  Code:  2 
Try Mean:  22  Size:  1000 
9   22 
22   1000 
9   22 
22   1000 
9   22 
22.00002   1000 
9   22 
22   1000.001 
9   22 
21.99529   1000 
9   22 
21.99532   1000 
9   22 
21.99529   1000.001 
9   22 
20.59219   1000 
9   22 
20.59221   1000 
9   22 
20.59219   1000.001 
9   22 
20.75327   1000 
9   22 
20.7533   1000 
9   22 
20.75327   1000.001 
9   22 
20.73899   1000 
9   22 
20.73901   1000 
9   22 
20.73899   1000.001 
9   22 
20.73885   1000 
9   22 
20.73887   1000 
9   22 
20.73885   1000.001 
9   22 
20.7388   1000.001 
9   22 
20.73882   1000.001 
9   22 
20.7388   1000.002 
9   22 
20.73861   1000.002 
9   22 
20.73863   1000.002 
9   22 
20.73861   1000.003 
9   22 
20.73838   1000.005 
9   22 
20.7384   1000.005 
9   22 
20.73838   1000.006 
9   22 
20.73795   1000.014 
9   22 
20.73797   1000.014 
9   22 
20.73795   1000.015 
9   22 
20.73729   1000.037 
9   22 
20.73731   1000.037 
9   22 
20.73729   1000.038 
9   22 
20.7362   1000.102 
9   22 
20.73622   1000.102 
9   22 
20.7362   1000.103 
9   22 
20.73445   1000.274 
9   22 
20.73447   1000.274 
9   22 
20.73445   1000.275 
9   22 
20.73159   1000.729 
9   22 
20.73161   1000.729 
9   22 
20.73159   1000.73 
9   22 
20.72697   1001.925 
9   22 
20.72699   1001.925 
9   22 
20.72697   1001.926 
9   22 
20.7195   1005.052 
9   22 
20.71952   1005.052 
9   22 
20.7195   1005.053 
9   22 
20.70752   1013.158 
9   22 
20.70754   1013.158 
9   22 
20.70752   1013.159 
9   22 
20.68888   1033.744 
9   22 
20.6889   1033.744 
9   22 
20.68888   1033.745 
9   22 
20.66213   1083.687 
9   22 
20.66215   1083.687 
9   22 
20.66213   1083.688 
9   22 
20.63044   1194.979 
9   22 
20.63046   1194.979 
9   22 
20.63044   1194.98 
9   22 
20.60689   1418.254 
9   22 
20.60691   1418.254 
9   22 
20.60689   1418.255 
9   22 
20.61411   1824.209 
9   22 
20.61413   1824.209 
9   22 
20.61411   1824.21 
9   22 
20.66011   2434.293 
9   22 
20.66013   2434.293 
9   22 
20.66011   2434.295 
9   22 
20.70405   3129.852 
9   22 
20.70407   3129.852 
9   22 
20.70405   3129.855 
9   22 
20.72481   3876.729 
9   22 
20.72484   3876.729 
9   22 
20.72481   3876.733 
9   22 
20.72814   4952.436 
9   22 
20.72816   4952.436 
9   22 
20.72814   4952.441 
9   22 
20.71309   6628.947 
9   22 
20.71311   6628.947 
9   22 
20.71309   6628.954 
9   22 
20.68963   8856.083 
9   22 
20.68965   8856.083 
9   22 
20.68963   8856.092 
9   22 
20.67329   11381.34 
9   22 
20.67331   11381.34 
9   22 
20.67329   11381.35 
9   22 
20.66647   14503.06 
9   22 
20.66649   14503.06 
9   22 
20.66647   14503.08 
9   22 
20.6684   19033.09 
9   22 
20.66842   19033.09 
9   22 
20.6684   19033.11 
9   22 
20.67679   25325.29 
9   22 
20.67681   25325.29 
9   22 
20.67679   25325.31 
9   22 
20.68497   33162.67 
9   22 
20.68499   33162.67 
9   22 
20.68497   33162.7 
9   22 
20.68919   42847.42 
9   22 
20.68921   42847.42 
9   22 
20.68919   42847.46 
9   22 
20.68921   56169.39 
9   22 
20.68923   56169.39 
9   22 
20.68921   56169.44 
9   22 
20.6858   74751.63 
9   22 
20.68582   74751.63 
9   22 
20.6858   74751.7 
9   22 
20.68153   98953.61 
9   22 
20.68155   98953.61 
9   22 
20.68153   98953.71 
9   22 
20.67873   129039.5 
9   22 
20.67875   129039.5 
9   22 
20.67873   129039.7 
9   22 
20.67792   169261.9 
9   22 
20.67794   169261.9 
9   22 
20.67792   169262.1 
9   22 
20.67897   222630.8 
9   22 
20.67899   222630.8 
9   22 
20.67897   222631 
9   22 
20.68092   298614.5 
9   22 
20.68094   298614.5 
9   22 
20.68092   298614.8 
9   22 
20.68235   387454.3 
9   22 
20.68237   387454.3 
9   22 
20.68235   387454.7 
9   22 
20.68305   517716.3 
9   22 
20.68307   517716.3 
9   22 
20.68305   517716.8 
9   22 
20.68273   673159.5 
9   22 
20.68275   673159.5 
9   22 
20.68273   673160.2 
9   22 
20.68183   893363.1 
9   22 
20.68186   893363.1 
9   22 
20.68183   893364 
9   22 
20.68094   1197091 
9   22 
20.68096   1197091 
9   22 
20.68094   1197092 
9   22 
20.68017   1772569 
9   22 
20.68019   1772569 
9   22 
20.68017   1772570 
9   22 
20.68031   2278583 
9   22 
20.68033   2278583 
9   22 
20.68031   2278585 
9   22 
20.68082   2600755 
9   22 
20.68084   2600755 
9   22 
20.68082   2600757 
9   22 
20.68107   2802954 
9   22 
20.68109   2802954 
9   22 
20.68107   2802957 
9   22 
20.68112   2699672 
9   22 
20.68108   2779190 
9   22 
20.68107   2798162 
9   22 
20.68107   2801968 
9   22 
20.68107   2802752 
9   22 
20.68107   2802913 
9   22 
20.68107   2802946 
9   22 
20.68107   2802952 
9   22 
20.68314   2802954 
9   22 
20.679   2802954 
9   22 
20.68107   2803234 
9   22 
20.68107   2802674 
9   22 
20.68127   2926656 
9   22 
20.68334   2926656 
9   22 
20.6792   2926656 
9   22 
20.68127   2926949 
9   22 
20.68127   2926364 
9   22 
20.68136   3039074 
9   22 
20.68343   3039074 
9   22 
20.67929   3039074 
9   22 
20.68136   3039378 
9   22 
20.68136   3038770 
9   22 
20.6814   3142522 
9   22 
20.68347   3142522 
9   22 
20.67933   3142522 
9   22 
20.6814   3142836 
9   22 
20.6814   3142208 
9   22 
20.68142   3237954 
9   22 
20.68349   3237954 
9   22 
20.67935   3237954 
9   22 
20.68142   3238278 
9   22 
20.68142   3237630 
9   22 
20.68146   4238196 
9   22 
20.68353   4238196 
9   22 
20.67939   4238196 
9   22 
20.68146   4238620 
9   22 
20.68146   4237772 
9   22 
20.68143   5238438 
9   22 
20.6835   5238438 
9   22 
20.67936   5238438 
9   22 
20.68143   5238962 
9   22 
20.68143   5237914 
9   22 
20.68137   6238680 
9   22 
20.68344   6238680 
9   22 
20.67931   6238680 
9   22 
20.68137   6239304 
9   22 
20.68137   6238056 
9   22 
20.68133   7238922 
9   22 
20.6834   7238922 
9   22 
20.67926   7238922 
9   22 
20.68133   7239646 
9   22 
20.68133   7238198 
9   22 
20.6813   8121766 
9   22 
20.68337   8121766 
9   22 
20.67923   8121766 
9   22 
20.6813   8122578 
9   22 
20.6813   8120954 
Fit Mean:  20.6813  Size:  8121766  Code:  1 
> 
> cat("Final Fit Mean: ", nb_fit_mu, " Size: ", nb_fit_size, " Code: ", nb_fit$code, " Try Size: ", try_size, "\n")
Final Fit Mean:  20.6813  Size:  8121766  Code:  1  Try Size:  1000 
> 
> ## Fit failed = reset parameters so graphing and output code can recognize this
> if ((nb_fit_mu < 0) || (nb_fit_size < 0) || (nb_fit$code != 1))
+ {
+   nb_fit_mu = 0
+   nb_fit_size = 0
+ }
> 
> 
> ## things can go wrong with fitting and we can still end up with invalid values
> 
> fit_nb = c()
> included_fract = 0
> if (nb_fit_mu > 0)
+ {
+   end_fract = pnbinom(end_i_for_fits, mu = nb_fit_mu, size=nb_fit_size)
+   start_fract = pnbinom(start_i_for_fits, mu = nb_fit_mu, size=nb_fit_size)
+   included_fract = end_fract-start_fract;
+ 
+   if (included_fract >= 0.01) {
+ 
+     ## Adjust so that we are back in full coords before making fit!!
+     if (num_per_bin > 1) 
+     {
+       nb_fit_mu = nb_fit_mu * num_per_bin
+     }
+     fit_nb = dnbinom(0:max(X$coverage), mu = nb_fit_mu, size=nb_fit_size)*inner_total/included_fract;
+   }
+ }
> 
> ## If an insufficient amount of fit was included, then invalidate it
> if (included_fract < 0.01)
+ {
+   nb_fit_mu = 0
+   nb_fit_size = 0
+ }
> 
> f_p <- function(par) {
+ 
+   lambda = par[1];
+ 
+   if (lambda <= 0)
+   {
+     return(0);
+   }
+   
+ 	total <- 0;
+ 	for (i in start_i_for_fits:end_i_for_fits)
+ 	{	
+     #cat(i, " ", lambda, "\n");
+ 		dist[i] <- dpois(i, lambda=lambda);
+ 		total <- total + dist[i] 
+ 	}
+ 	#print (total)
+ 
+  	l <- 0;
+ 	for (i in start_i_for_fits:end_i_for_fits)
+ 	{
+ 		l <- l + ((X.for.fits[i]/inner_total)-(dist[i]/total))^2;
+ 	}
+ 	return(l);
+ }
> 
> 
> ## Fit Poisson 
> ## - allow fit to fail and set all params to zero/empty if that is the case
> 
> p_fit = NULL
> try(suppressWarnings(p_fit<-nlm(f_p, c(m), print.level=this.print.level)))
> 
> fit_p = c()
> if (!is.null(p_fit) && (p_fit$estimate[1] > 0))
+ {
+   #print (nb_fit$estimate[1])
+   p_fit_lambda = p_fit$estimate[1];
+   #print(0:max(X$coverage))
+ 
+   end_fract = ppois(end_i_for_fits, lambda = p_fit_lambda)
+   start_fract = ppois(start_i_for_fits, lambda = p_fit_lambda)
+   included_fract = end_fract-start_fract;
+ 
+   ## Adjust so that we are back in full coords before making fit!!
+   if (num_per_bin > 1) 
+   {
+     p_fit_lambda = p_fit_lambda * num_per_bin
+   }
+   fit_p<-dpois(0:max(X$coverage), lambda = p_fit_lambda)*inner_total/included_fract;
+ }
> 
> 
> ## Graphing
> ##
> ## don't graph very high values with very little coverage
> i<-max_i
> while (i <= length(X$n) && X$n[i]>0.01*max_n)
+ {		
+ 	i <- i+1;
+ }
> graph_end_i <-i
> 
> ## Ths leaves enough room to the right of the peak for the legend
> graph_end_i = max(floor(2.2 * max_i), graph_end_i);
> 
> ## graphics settings
> my_pch = 21
> my_col = "black";
> my_col_censored = "red";
> 
> if (pdf_output == 0) {
+   
+   ## bitmap() requires ghostscript to be installed.
+   ## taa=4, gaa=2 options NOT compatible with earlier R versions!
+   ## units = "px" NOT compatible with even earlier R versions!
+   
+   if(!capabilities(what = "png"))
+   {
+     ## fallback to ghostscript
+     bitmap(plot_file, height=6, width=7, type = "png16m", res = 72, pointsize=18)
+   } else {
+     ## use X11 function, which gives better resolution
+     png(plot_file, height=6, width=7, units ="in", res = 72, pointsize=18)
+     par(family="sans")
+   }
+ } else {
+   pdf(plot_file, height=6, width=7)
+   par(family="sans")
+ }
> 
> par(mar=c(5.5,7.5,3,1.5));
> 
> max_y = 0
> if (plot_poisson) {
+ 	max_y = max(X$n, fit_p, fit_nb)
+ } else {
+ 	max_y = max(X$n, fit_nb)
+ }
> 
> plot(0:10, 0:10, type="n", lty="solid", ylim=c(0, max_y)*1.05, xlim=c(0, graph_end_i), lwd=1, xaxs="i", yaxs="i", axes=F, las=1, main="Coverage Distribution at Unique-Only Positions", xlab="Coverage depth (reads)", ylab="", cex.lab=1.2, cex.axis=1.2)
> 
> mtext(side = 2, text = "Number of reference positions", line = 5.5, cex=1.2)
> 
> sciNotation <- function(x, digits = 1) {
+     if (length(x) > 1) {
+         return(append(sciNotation(x[1]), sciNotation(x[-1])))     
+ 	} 
+     if (!x) return(0) 
+ 
+ 	exponent <- floor(log10(x)) 
+     base <- round(x / 10^exponent, digits)     
+ 	as.expression(substitute(base %*% 10^exponent, list(base = base, exponent = exponent))) 
+ }
> 
> #axis(2, cex.lab=1.2, las=1, cex.axis=1.2, labels=T, at=(0:6)*50000)
> axis(2, cex.lab=1.2, las=1, cex.axis=1.2, at = axTicks(2), labels = sciNotation(axTicks(2), 1))
> axis(1, cex.lab=1.2, cex.axis=1.2, labels=T)
> box()
> 
> #graph the coverage as points
> fit_data <- subset(X, (coverage>=start_i) & (coverage<=end_i) );
> points(fit_data$coverage, fit_data$n, pch=my_pch, col=my_col, bg="white", cex=1.2)
> 
> #graph the censored coverage as red points
> cat(start_i, " ", end_i, "\n", sep="")
9 22
> 
> censored_data <- subset(X, (coverage<start_i) | (coverage>end_i) );
> points(censored_data$coverage, censored_data$n, pch=my_pch, col=my_col_censored, bg="white", cex=1.2)
> 
> #graph the poisson fit IF REQUESTED
> if (plot_poisson) {
+ 	lines(0:max(X$coverage), fit_p, lwd=3, lty="22", col="black");
+ }
> 
> #graph the negative binomial fit
> if (nb_fit_mu > 0) {
+   lines(0:max(X$coverage), fit_nb, lwd=3, col="black");
+ }
> 
> if (plot_poisson) {
+ 	legend("topright", c("Coverage distribution", "Censored data", "Negative binomial", "Poisson"), lty=c("blank","blank","solid","22"), lwd=c(1,1,2,2), pch=c(my_pch, my_pch, -1, -1), col=c("black", "red", "black", "black"), bty="n")
+ } else {
+ 	legend("topright", c("Coverage distribution", "Censored data", "Negative binomial"), lty=c("blank","blank","solid"), lwd=c(1,1,2), pch=c(my_pch, my_pch, -1), col=c("black", "red", "black"), bty="n")
+ }
> 
> dev.off()
null device 
          1 
> 
> ## Fit the marginal value that we use for propagating deletions
> 
> if (nb_fit_mu > 0) {
+   cat(nb_fit_size, " ", nb_fit_mu, "\n")
+   deletion_propagation_coverage = suppressWarnings(qnbinom(deletion_propagation_pr_cutoff, size = nb_fit_size, mu = nb_fit_mu))
+ } else {
+   cat("Fallback to calculating off an estimate of just variance = mu + mu^2/size\n")
+   size_estimate = (1/(v-m))*(m*m)
+   cat("Mu estimate=", m," Size estimate =", size_estimate, "\n")
+   deletion_propagation_coverage = suppressWarnings(qnbinom(deletion_propagation_pr_cutoff, size = size_estimate, mu = m))
+   if (is.na(deletion_propagation_coverage) || is.nan(deletion_propagation_coverage) || (deletion_propagation_coverage < 1)) {
+     cat("Double fallback to calculating as just 10% of the mean\n")
+     deletion_propagation_coverage = m * 0.1
+   }
+ }
8121766   20.6813 
> 
> #Don't allow one read to indicate non-deleted regions
> if (deletion_propagation_coverage < 1) {
+     deletion_propagation_coverage = 1
+ }
> 
> #This works fine with the negative values
> #If we have both low fit coverage and low straight average coverage then we're deleted...
> if ( (nb_fit_mu <= 3) && (m <= 3) ) {
+   deletion_propagation_coverage = -1
+ }
> 
> #print out statistics
> 
> print(nb_fit_size);
[1] 8121766
> print(nb_fit_mu);
[1] 20.6813
> 
> print(m)
[1] 16.80309
> print(v)
[1] 19.22852
> print(D)
[1] 1.144344
> 
> print(deletion_propagation_coverage)
[1] 9
> 
> warnings()
> 
